(function(){"use strict";Bridge.define("WebMrbc.Block",{type:null,contextMenu:!1,constructor:function(type){this.type=type}});Bridge.define("WebMrbc.App",{statics:{module:null,term:null,preferences:null,changedAfterTranslating:!1,translating:!1,classGroups:null,nodeProfileClass:null,config:{init:function(){this.preferences=new System.Collections.Generic.Dictionary$2(String,Object)();Bridge.ready(this.main)}},initModule:function(){var module=new WebMrbc.EmModule(WebMrbc.App.term);return window.onerror=function(){var spinnerElement=document.getElementById("spinner");module.setStatus("Exception thrown, see JavaScript console");spinnerElement.style.display="none";module.setStatus=function(text){System.String.isNullOrEmpty(text)||module.printErr(["[post-exception status] "+text])}},module},preRun:function(){var FS=WebMrbc.App.module.getFileSystem();FS.createFolder("/","src",!0,!1);FS.createPreloadedFile("/src","main.org.rb","src/main.rb",!0,!0);FS.createFolder("/","build",!0,!0);FS.writeFile("/src/main.rb",window.textEditor.getValue())},main:function(){var termElement,textEditor,session,xhr;Number.isFinite=Number.isFinite||function(any){return typeof any=="number"&&isFinite(any)};Number.isNaN=Number.isNaN||function(any){return typeof any=="number"&&isNaN(any)};WebMrbc.Collections.ClassWorkspaces=new WebMrbc.Collection$1(WebMrbc.IClassWorkspace)();WebMrbc.Views.MainMenuView=new WebMrbc.MainMenuView;WebMrbc.Views.ClassSelectorView=new WebMrbc.ClassSelectorView(WebMrbc.Collections.ClassWorkspaces);WebMrbc.Views.EObjectModalView=new WebMrbc.EObjectModalView;Blockly.Blocks.eproperty_new=new WebMrbc.EPropertyBlock("eproperty_new");Blockly.Blocks.switch_case_number=new WebMrbc.SwitchCaseNumberBlock("switch_case_number");Blockly.Blocks.switch_case_number_first_case=new WebMrbc.SwitchCaseNumberFirstCaseBlock("switch_case_number_first_case");Blockly.Blocks.switch_case_number_case=new WebMrbc.SwitchCaseNumberCaseBlock("switch_case_number_case");Blockly.Blocks.switch_case_number_default=new WebMrbc.SwitchCaseNumberDefaultBlock("switch_case_number_default");Blockly.Blocks.switch_case_text=new WebMrbc.SwitchCaseTextBlock("switch_case_text");Blockly.Blocks.switch_case_text_first_case=new WebMrbc.SwitchCaseTextFirstCaseBlock("switch_case_text_first_case");Blockly.Blocks.switch_case_text_case=new WebMrbc.SwitchCaseTextCaseBlock("switch_case_text_case");Blockly.Blocks.switch_case_text_default=new WebMrbc.SwitchCaseTextDefaultBlock("switch_case_text_default");Blockly.Blocks.call=new WebMrbc.CallBlock("call");Blockly.Blocks.pin_mode=new WebMrbc.PinModeBlock("pin_mode");Blockly.Blocks.digital_write=new WebMrbc.DigitalWriteBlock("digital_write");Blockly.Blocks.digital_read=new WebMrbc.DigitalReadBlock("digital_read");Blockly.Blocks.analog_read=new WebMrbc.AnalogReadBlock("analog_read");Blockly.Blocks.pwm=new WebMrbc.PwmBlock("pwm");Blockly.Blocks.analog_reference=new WebMrbc.AnalogReferenceBlock("analog_reference");Blockly.Blocks.init_dac=new WebMrbc.InitDacBlock("init_dac");Blockly.Blocks.analog_dac=new WebMrbc.AnalogDacBlock("analog_dac");Blockly.Blocks.delay=new WebMrbc.DelayBlock("delay");Blockly.Blocks.millis=new WebMrbc.MillisBlock("millis");Blockly.Blocks.micros=new WebMrbc.MicrosBlock("micros");Blockly.Blocks.led=new WebMrbc.LedBlock("led");Blockly.Blocks.tone=new WebMrbc.ToneBlock("tone");Blockly.Blocks.no_tone=new WebMrbc.NoToneBlock("no_tone");Blockly.Blocks.random_seed=new WebMrbc.RandomSeedBlock("random_seed");Blockly.Blocks.random=new WebMrbc.RandomBlock("random");Blockly.Blocks.i2c_new=new WebMrbc.I2cNewBlock("i2c_new");Blockly.Blocks.i2c_write=new WebMrbc.I2cWriteBlock("i2c_write");Blockly.Blocks.i2c_read=new WebMrbc.I2cReadBlock("i2c_read");Blockly.Blocks.i2c_begin=new WebMrbc.I2cBeginBlock("i2c_begin");Blockly.Blocks.i2c_lwrite=new WebMrbc.I2cLwriteBlock("i2c_lwrite");Blockly.Blocks.i2c_end=new WebMrbc.I2cEndBlock("i2c_end");Blockly.Blocks.i2c_request=new WebMrbc.I2cRequestBlock("i2c_request");Blockly.Blocks.i2c_lread=new WebMrbc.I2cLreadBlock("i2c_lread");Blockly.Blocks.i2c_available=new WebMrbc.I2cAvailableBlock("i2c_available");Blockly.Blocks.i2c_frequency=new WebMrbc.I2cFrequencyBlock("i2c_frequency");Blockly.Blocks.memfile_open=new WebMrbc.MemFileOpenBlock("memfile_open");Blockly.Blocks.memfile_close=new WebMrbc.MemFileCloseBlock("memfile_close");Blockly.Blocks.memfile_read=new WebMrbc.MemFileReadBlock("memfile_read");Blockly.Blocks.memfile_write=new WebMrbc.MemFileWriteBlock("memfile_write");Blockly.Blocks.memfile_seek=new WebMrbc.MemFileSeekBlock("memfile_seek");Blockly.Blocks.memfile_cp=new WebMrbc.MemFileCpBlock("memfile_cp");Blockly.Blocks.memfile_rm=new WebMrbc.MemFileRmBlock("memfile_rm");Blockly.Blocks.rtc_gettime=new WebMrbc.RtcGetTimeBlock("rtc_gettime");Blockly.Blocks.rtc_settime=new WebMrbc.RtcSettimeBlock("rtc_settime");Blockly.Blocks.rtc_deinit=new WebMrbc.RtcDeinitBlock("rtc_deinit");Blockly.Blocks.rtc_init=new WebMrbc.RtcInitBlock("rtc_init");Blockly.Blocks.sd_exists=new WebMrbc.SdExistsBlock("sd_exists");Blockly.Blocks.sd_mkdir=new WebMrbc.SdMkdirBlock("sd_mkdir");Blockly.Blocks.sd_remove=new WebMrbc.SdRemoveBlock("sd_remove");Blockly.Blocks.sd_copy=new WebMrbc.SdCopyBlock("sd_copy");Blockly.Blocks.sd_rmdir=new WebMrbc.SdRmdirBlock("sd_rmdir");Blockly.Blocks.sd_open=new WebMrbc.SdOpenBlock("sd_open");Blockly.Blocks.sd_close=new WebMrbc.SdCloseBlock("sd_close");Blockly.Blocks.sd_read=new WebMrbc.SdReadBlock("sd_read");Blockly.Blocks.sd_seek=new WebMrbc.SdSeekBlock("sd_seek");Blockly.Blocks.sd_write=new WebMrbc.SdWriteBlock("sd_write");Blockly.Blocks.sd_flush=new WebMrbc.SdFlushBlock("sd_flush");Blockly.Blocks.sd_size=new WebMrbc.SdSizeBlock("sd_size");Blockly.Blocks.sd_position=new WebMrbc.SdPositionBlock("sd_position");Blockly.Blocks.serial_new=new WebMrbc.SerialNewBlock("serial_new");Blockly.Blocks.serial_bps=new WebMrbc.SerialBpsBlock("serial_bps");Blockly.Blocks.serial_print=new WebMrbc.SerialPrintBlock("serial_print");Blockly.Blocks.serial_println=new WebMrbc.SerialPrintlnBlock("serial_println");Blockly.Blocks.serial_available=new WebMrbc.SerialAvailableBlock("serial_available");Blockly.Blocks.serial_read=new WebMrbc.SerialReadBlock("serial_read");Blockly.Blocks.serial_write=new WebMrbc.SerialWriteBlock("serial_write");Blockly.Blocks.serial_flash=new WebMrbc.SerialFlashBlock("serial_flash");Blockly.Blocks.servo_attach=new WebMrbc.ServoAttachBlock("servo_attach");Blockly.Blocks.servo_write=new WebMrbc.ServoWriteBlock("servo_write");Blockly.Blocks.servo_us=new WebMrbc.ServoUsBlock("servo_us");Blockly.Blocks.servo_read=new WebMrbc.ServoReadBlock("servo_read");Blockly.Blocks.servo_attached=new WebMrbc.ServoAttachedBlock("servo_attached");Blockly.Blocks.servo_detach=new WebMrbc.ServoDetachBlock("servo_detach");Blockly.Blocks.system_exit=new WebMrbc.SystemExitBlock("system_exit");Blockly.Blocks.system_setrun=new WebMrbc.SystemSetRunBlock("system_setrun");Blockly.Blocks.system_version=new WebMrbc.SystemVersionBlock("system_version");Blockly.Blocks.system_push=new WebMrbc.SystemPushBlock("system_push");Blockly.Blocks.system_pop=new WebMrbc.SystemPopBlock("system_pop");Blockly.Blocks.system_fileload=new WebMrbc.SystemFileLoadBlock("system_fileload");Blockly.Blocks.system_reset=new WebMrbc.SystemResetBlock("system_reset");Blockly.Blocks.system_use_sd=new WebMrbc.SystemUseSdBlock("system_use_sd");Blockly.Blocks.system_use_wifi=new WebMrbc.SystemUseWifiBlock("system_use_wifi");Blockly.Blocks.system_get_mrb_path=new WebMrbc.SystemGetMrbPathBlock("system_get_mrb_path");Blockly.Ruby=new WebMrbc.Ruby;termElement=document.getElementById("term");WebMrbc.App.term=new Terminal(new $_.$AnonymousType$1(80,24,!0,!0,!1));WebMrbc.App.term.on("data",$_.WebMrbc.App.f1);WebMrbc.App.term.on("title",$_.WebMrbc.App.f2);WebMrbc.App.term.open(termElement);Blockly.HSV_SATURATION=1;Blockly.HSV_VALUE=.8;Blockly.mainWorkspace=Blockly.inject("blockly-div",new $_.$AnonymousType$2(document.getElementById("toolbox"),!0));WebMrbc.App.hideEmptyCategory();Blockly.mainWorkspace.addChangeListener(WebMrbc.App.workspace_Changed);textEditor=ace.edit("text-editor");window.textEditor=textEditor;textEditor.setTheme("ace/theme/vibrant_ink");textEditor.setShowInvisibles(!0);textEditor.gotoLine(0,0);textEditor.on("change",$_.WebMrbc.App.f3);session=textEditor.getSession();session.setMode("ace/mode/ruby");session.setTabSize(2);session.setUseSoftTabs(!1);WebMrbc.App.applyPreferences();var statusElement=document.getElementById("status"),progressElement=document.getElementById("progress"),spinnerElement=document.getElementById("spinner");statusElement.innerHTML="Downloading...";xhr=new XMLHttpRequest;xhr.onload=function(){window.textEditor.setValue(xhr.responseText);textEditor.moveCursorTo(0,0)};xhr.open("GET","src/main.rb",!0);xhr.send(Bridge.cast(null,String));statusElement.innerHTML="";spinnerElement.style.display="none";WebMrbc.Collections.MainLoopWorkspace=new WebMrbc.MainLoopWorkspace("MainLoop");WebMrbc.Collections.ClassWorkspaces.add(WebMrbc.Collections.MainLoopWorkspace);WebMrbc.Collections.EcnlTaskWorkspace=new WebMrbc.EcnlTaskWorkspace("EchonetTask");WebMrbc.Collections.ClassWorkspaces.add(WebMrbc.Collections.EcnlTaskWorkspace);$($_.WebMrbc.App.f4)},workspace_Changed:function(e){var block,eobject,cre,propertyBlock,del,propertyBlock1,chg,propertyBlock2,mov,propertyBlock3,ui;WebMrbc.App.changedAfterTranslating=!0;window.changed=!0;block=Blockly.mainWorkspace.getBlockById(e.blockId);eobject=Bridge.as(WebMrbc.Views.ClassSelectorView.getCurrent(),WebMrbc.EObjectWorkspace);switch(e.type){case Blockly.Events.CREATE:if(cre=e,Bridge.referenceEquals(block.type,"eproperty_new")){propertyBlock=block;propertyBlock.onCreate(eobject,cre)}break;case Blockly.Events.DELETE:if(del=e,block!=null&&Bridge.referenceEquals(block.type,"eproperty_new")){propertyBlock1=block;propertyBlock1.onDelete(eobject,del)}break;case Blockly.Events.CHANGE:if(chg=e,Bridge.referenceEquals(block.type,"eproperty_new")){propertyBlock2=block;propertyBlock2.onChange(eobject,chg)}break;case Blockly.Events.MOVE:if(mov=e,block!=null&&Bridge.referenceEquals(block.type,"eproperty_new")){propertyBlock3=block;propertyBlock3.onMove(eobject,mov)}break;case Blockly.Events.UI:ui=e;WebMrbc.App.onUi(ui)}},onUi:function(ui){switch(ui.element){case"selected":if(ui.newValue!=null)var block=Blockly.mainWorkspace.getBlockById(ui.newValue.toString())}},initClassGroups:function(){$.ajax({url:"devices/ClassGroupList.json",success:function(data){for(var profileClass=null,_classGroups=Bridge.cast(Bridge.referenceEquals(Bridge.getType(data),String)?$.parseJSON(Bridge.cast(data,String)):data,Array),classGroups=System.Array.init(0,null),_item,item,$t=Bridge.getEnumerator(_classGroups);$t.moveNext();)if(_item=$t.getCurrent(),item=new WebMrbc.JsonClassGroupInfo(_item),classGroups.push(item),item.classGroupCode===14){profileClass=item;continue}else if(item.classGroupCode===15)continue;WebMrbc.App.classGroups=classGroups;WebMrbc.Views.EObjectModalView.initClassGroups();profileClass!=null&&WebMrbc.App.updateClass(profileClass,$_.WebMrbc.App.f6)},error:WebMrbc.App.ajaxError})},updateClass:function(eclass,success){success===void 0&&(success=null);$.ajax({url:"devices/ClassList"+System.Byte.format(eclass.classGroupCode,"X2").toUpperCase()+".json",success:function(data1){for(var _classes=Bridge.cast(Bridge.referenceEquals(Bridge.getType(data1),String)?$.parseJSON(Bridge.cast(data1,String)):data1,Array),classes=System.Array.init(0,null),_item,item,$t=Bridge.getEnumerator(_classes);$t.moveNext();)_item=$t.getCurrent(),item=new WebMrbc.JsonClassInfo(_item),classes.push(item),item.classGroup=eclass,item.classCode===240&&(WebMrbc.App.nodeProfileClass=item);eclass.classes=classes;Bridge.staticEquals(success,null)||success()},error:WebMrbc.App.ajaxError})},updateProperties:function(eclass,success){success===void 0&&(success=null);$.ajax({url:"devices/PropertyList"+System.Byte.format(eclass.classGroup.classGroupCode,"X2").toUpperCase()+System.Byte.format(eclass.classCode,"X2").toUpperCase()+".json",success:function(data){for(var _properties=Bridge.cast(Bridge.referenceEquals(Bridge.getType(data),String)?$.parseJSON(Bridge.cast(data,String)):data,Array),properties=System.Array.init(0,null),_item,item,$t=Bridge.getEnumerator(_properties);$t.moveNext();)_item=$t.getCurrent(),item=new WebMrbc.JsonPropertyInfo("constructor$1",_item),properties.push(item);eclass.properties=properties;Bridge.staticEquals(success,null)||success()},error:WebMrbc.App.ajaxError})},ajaxError:function(){},loadXml:function(data,workspace){var xmlChild,xml,eobjs,i,type,c;for(workspace===void 0&&(workspace=null),workspace==null&&(workspace=Blockly.mainWorkspace),xml=Blockly.Xml.textToDom(data),workspace.clear(),eobjs=System.Array.init(0,null),i=0;(xmlChild=Bridge.cast(xml.childNodes[i],Element))!=null;i=i+1|0)if(Bridge.referenceEquals("eobject",xmlChild.nodeName.toLowerCase())){if(type=WebMrbc.App.getClass(parseInt(xmlChild.getAttribute("classGroupCode")),parseInt(xmlChild.getAttribute("classCode"),10)),type==null)continue;c=Bridge.merge(new WebMrbc.JsonObjectInfo(type,xmlChild.getAttribute("identifer")),{attribute:xmlChild.getAttribute("attribute"),instanceCode:parseInt(xmlChild.getAttribute("instanceCode"))&255,properties:WebMrbc.App.getProperties(type,xmlChild.getAttribute("propertys").split(","))});eobjs.push(new WebMrbc.EObjectWorkspace(c))}WebMrbc.Collections.ClassWorkspaces.reset$1(eobjs);Blockly.Xml.domToWorkspace(xml,workspace)},getClass:function(classGroupCode,classCode){var t=System.Linq.Enumerable.from(WebMrbc.App.classGroups).firstOrDefault(function(cg){return cg.classGroupCode===classGroupCode},null);return t==null?null:System.Linq.Enumerable.from(t.classes).firstOrDefault(function(c){return c.classCode===classCode},null)},getProperties:function(type,properties){var pcs=System.Linq.Enumerable.from(properties).select($_.WebMrbc.App.f7),ps=System.Linq.Enumerable.from(type.properties).where(function(p){return pcs.contains(p.propertyCode)});return ps.toArray()},dumpXml:function(workspace,models){workspace==null&&(workspace=Blockly.mainWorkspace);models==null&&(models=WebMrbc.Collections.ClassWorkspaces);var xmlDom=Blockly.Xml.workspaceToDom(workspace),blocklyDom=xmlDom.firstChild;return models.each(function(c){var e=goog.dom.createDom("eobject"),epropertyIndex,rotationStyle;e.setAttribute("x",c.get("x"));e.setAttribute("y",c.get("y"));e.setAttribute("name",c.get("name"));e.setAttribute("epropertys",c.epropertysWithName().join(","));epropertyIndex=c.get("epropertyIndex");Bridge.referenceEquals(epropertyIndex,0)||e.setAttribute("eproperty_index",epropertyIndex);e.setAttribute("attribute",c.get("attribute"));rotationStyle=c.get("rotationStyle");Bridge.referenceEquals(rotationStyle,"free")||e.setAttribute("rotation_style",rotationStyle);xmlDom.insertBefore(e,blocklyDom)}),Blockly.Xml.domToPrettyText(xmlDom)},ignoreEnterKey:function(el){return el.find("input[type=text]").keypress($_.WebMrbc.App.f8)},removeBackdropOnHidden:function(el){return el.on("hidden",$_.WebMrbc.App.f9)},reset:function(){Blockly.mainWorkspace.clear();WebMrbc.Collections.ClassWorkspaces.reset();$("#filename").val("");window.textEditor.getSession().getDocument().setValue("");window.textEditor.moveCursorTo(0,0);WebMrbc.App.addEObjectFromBeginning();window.changed=!1},bm:function(name){var msg=Blockly.Msg[name];return Bridge.referenceEquals(String,String)?msg:name},addEObjectFromBeginning:function(){var $t,identifer,localNode,item,enode;if(!WebMrbc.App.isEnabled("disabled_add_eobject_from_beginning")){for(identifer=WebMrbc.Collections.ClassWorkspaces.uniqueName("LocalNode"),localNode=new WebMrbc.JsonNodeInfo(WebMrbc.App.nodeProfileClass,identifer,"local"),$t=Bridge.getEnumerator(localNode.type.properties);$t.moveNext();)item=$t.getCurrent(),item.required.length>0&&!Bridge.referenceEquals(item.required[0],"NONE")&&localNode.properties.push(new WebMrbc.JsonPropertyInfo("constructor$1",item));enode=new WebMrbc.ENodeWorkspace(localNode);WebMrbc.Collections.LocalNode=enode;WebMrbc.Collections.ClassWorkspaces.add(enode);WebMrbc.Views.ClassSelectorView.selectItem(enode);window.changed=!1}},applyPreferences:function(){window.textEditor.setReadOnly(WebMrbc.App.isEnabled("enabled_readonly_ruby_mode"));WebMrbc.App.isEnabled("disabled_new_eobject")?$("#add-eobject-item").hide():$("#add-eobject-item").show()},setPreferences:function(preferences){WebMrbc.App.preferences=preferences;WebMrbc.App.applyPreferences();WebMrbc.App.changedAfterTranslating=!0;WebMrbc.App.reloadToolbox()},isEnabled:function(name){var e={},s;return WebMrbc.App.preferences.tryGetValue(name,e)?Bridge.is(e.v,Boolean)?Bridge.cast(e.v,Boolean):(s=e.v.toString(),Bridge.referenceEquals(s,"true")||Bridge.referenceEquals(s,"1")):!1},reloadToolbox:function(){Blockly.hideChaff();var workspace=WebMrbc.Views.ClassSelectorView.getCurrent(),toolbox=document.getElementById("toolbox");workspace.reloadToolbox(toolbox);Blockly.mainWorkspace.updateToolbox(toolbox)},hideEmptyCategory:function(){for(var i=1,node,element,$t=Bridge.getEnumerator(Blockly.getMainWorkspace().options.languageTree.childNodes);$t.moveNext();)(node=$t.getCurrent(),element=Bridge.as(node,Element),element!=null)&&(element.getElementsByTagName("block").length===0&&element.getAttribute("custom")==null&&$("div.blocklyTreeRoot > div:nth-child(2) > div:nth-child("+i+")[aria-level='1']").hide(),i=i+1|0)}},$entryPoint:!0});var $_={};Bridge.define("$AnonymousType$1",$_,{constructor:function(cols,rows,useStyle,screenKeys,cursorBlink){this.cols=cols;this.rows=rows;this.useStyle=useStyle;this.screenKeys=screenKeys;this.cursorBlink=cursorBlink},getcols:function(){return this.cols},getrows:function(){return this.rows},getuseStyle:function(){return this.useStyle},getscreenKeys:function(){return this.screenKeys},getcursorBlink:function(){return this.cursorBlink},equals:function(o){return Bridge.is(o,$_.$AnonymousType$1)?Bridge.equals(this.cols,o.cols)&&Bridge.equals(this.rows,o.rows)&&Bridge.equals(this.useStyle,o.useStyle)&&Bridge.equals(this.screenKeys,o.screenKeys)&&Bridge.equals(this.cursorBlink,o.cursorBlink):!1},getHashCode:function(){var hash=17;return hash=hash*23+1305346792,hash=hash*23+(this.cols==null?0:Bridge.getHashCode(this.cols)),hash=hash*23+(this.rows==null?0:Bridge.getHashCode(this.rows)),hash=hash*23+(this.useStyle==null?0:Bridge.getHashCode(this.useStyle)),hash=hash*23+(this.screenKeys==null?0:Bridge.getHashCode(this.screenKeys)),hash*23+(this.cursorBlink==null?0:Bridge.getHashCode(this.cursorBlink))},toJSON:function(){return{cols:this.cols,rows:this.rows,useStyle:this.useStyle,screenKeys:this.screenKeys,cursorBlink:this.cursorBlink}}});Bridge.define("$AnonymousType$2",$_,{constructor:function(toolbox,trashcan){this.toolbox=toolbox;this.trashcan=trashcan},gettoolbox:function(){return this.toolbox},gettrashcan:function(){return this.trashcan},equals:function(o){return Bridge.is(o,$_.$AnonymousType$2)?Bridge.equals(this.toolbox,o.toolbox)&&Bridge.equals(this.trashcan,o.trashcan):!1},getHashCode:function(){var hash=17;return hash=hash*23+-260737149,hash=hash*23+(this.toolbox==null?0:Bridge.getHashCode(this.toolbox)),hash*23+(this.trashcan==null?0:Bridge.getHashCode(this.trashcan))},toJSON:function(){return{toolbox:this.toolbox,trashcan:this.trashcan}}});Bridge.ns("WebMrbc.App",$_);Bridge.apply($_.WebMrbc.App,{f1:function(data){WebMrbc.App.module!=null&&WebMrbc.App.module.stdin!=null&&WebMrbc.App.module.stdin(data)},f2:function(title){document.title=title},f3:function(){WebMrbc.App.translating||(window.changed=!0,WebMrbc.App.changedAfterTranslating=!0)},f4:function(){WebMrbc.App.initClassGroups($("#eobject-modal").get(0))},f5:function(){WebMrbc.App.addEObjectFromBeginning()},f6:function(){WebMrbc.App.nodeProfileClass!=null&&WebMrbc.App.updateProperties(WebMrbc.App.nodeProfileClass,$_.WebMrbc.App.f5)},f7:function(pc){return parseInt(pc,16)},f8:function(e){return e==null&&(e=Bridge.cast(window.Event,jQuery.Event)),e.keyCode===13?!1:!0},f9:function(){$(".modal-backdrop").remove()}});Bridge.define("WebMrbc.Value");Bridge.define("WebMrbc.ClassSelectorView",{collection:null,el:null,templateText:null,m_ClassWorkspace:null,constructor:function(collection){this.el=$("#class-selector-tab");this.collection=collection;collection.onAdd=Bridge.fn.combine(collection.onAdd,Bridge.fn.bind(this,this.onChange));collection.onRemove=Bridge.fn.combine(collection.onRemove,Bridge.fn.bind(this,this.onChange));collection.onReset=Bridge.fn.combine(collection.onReset,Bridge.fn.bind(this,this.onChange));collection.onChange=Bridge.fn.combine(collection.onChange,Bridge.fn.bind(this,this.onChange));collection.getLength()>0&&(this.m_ClassWorkspace=collection.at(0));this.templateText=$("#class-selector-template").text();$("#add-eobject-button").click(Bridge.fn.bind(this,function(e){var $t,eobject,item;for(e.preventDefault(),this.m_ClassWorkspace.loadDom(Blockly.Xml.workspaceToDom(Blockly.mainWorkspace)),Blockly.mainWorkspace.clear(),eobject=new WebMrbc.JsonObjectInfo(WebMrbc.App.nodeProfileClass,collection.uniqueName("Kaden")),this.m_ClassWorkspace=new WebMrbc.EObjectWorkspace(eobject),$t=Bridge.getEnumerator(eobject.type.properties);$t.moveNext();)item=$t.getCurrent(),item.required.length>0&&!Bridge.referenceEquals(item.required[0],"NONE")&&eobject.properties.push(new WebMrbc.JsonPropertyInfo("constructor$1",item));this.m_ClassWorkspace.openModifyView(Bridge.fn.bind(this,function(ok){ok&&collection.add(this.m_ClassWorkspace)}))}));this.render()},getCurrent:function(){return this.m_ClassWorkspace},render:function(){var charsEl=$("#class-selector-eobject-set");charsEl.children().remove();this.collection.each(Bridge.fn.bind(this,function(eobject){var html=$(eobject.template(this.templateText)),selectedMark,removeButton,img;charsEl.append(html);selectedMark=html.find("a.selected-mark");Bridge.referenceEquals(this.m_ClassWorkspace,eobject)?selectedMark.show():selectedMark.hide();html.find("a.eobject").click(Bridge.fn.bind(this,function(e){e.preventDefault();Bridge.referenceEquals(this.m_ClassWorkspace,eobject)||this.selectItem(eobject)}));html.find("a.modify-button").click(Bridge.fn.bind(this,function(e){e.preventDefault();this.m_ClassWorkspace=eobject;this.m_ClassWorkspace.openModifyView(Bridge.fn.bind(this,$_.WebMrbc.ClassSelectorView.f1))}));removeButton=html.find("a.remove-button");removeButton.click(Bridge.fn.bind(this,function(e){e.preventDefault();this.m_ClassWorkspace=null;this.removeEObject_(eobject)}));(WebMrbc.App.isEnabled("disabled_new_eobject")||eobject.isPreset())&&removeButton.hide();img=html.find("img");img.on("dragstart",$_.WebMrbc.ClassSelectorView.f2)}))},selectItem:function(model){var html,selectedMark,charsEl=$("#class-selector-eobject-set");this.m_ClassWorkspace!=null&&(html=charsEl.find("#"+this.m_ClassWorkspace.getIdentifer()),selectedMark=html.find("a.selected-mark"),selectedMark.hide(),this.m_ClassWorkspace.loadDom(Blockly.Xml.workspaceToDom(Blockly.mainWorkspace)));this.m_ClassWorkspace=model;WebMrbc.App.reloadToolbox();Blockly.mainWorkspace.clear();this.m_ClassWorkspace==null&&this.collection.getLength()>0&&(this.m_ClassWorkspace=this.collection.at(0));this.m_ClassWorkspace!=null&&(Blockly.Xml.domToWorkspace(this.m_ClassWorkspace.toDom(),Blockly.mainWorkspace),html=charsEl.find("#"+this.m_ClassWorkspace.getIdentifer()),selectedMark=html.find("a.selected-mark"),selectedMark.show())},onChange:function(){this.render()},removeEObject_:function(model){WebMrbc.App.isEnabled("disabled_new_eobject")||model.isPreset()||(Bridge.referenceEquals(this.m_ClassWorkspace,model)&&(this.m_ClassWorkspace=null),this.collection.remove(model))}});Bridge.ns("WebMrbc.ClassSelectorView",$_);Bridge.apply($_.WebMrbc.ClassSelectorView,{f1:function(){this.render()},f2:function(e){e.preventDefault()}});Bridge.define("WebMrbc.CodeGenerator",{statics:{getClassIdentifier:function(ci){var cls=ci,result=ci.type.type,ms,m,blocks,pos,len;if(new RegExp("^[A-Za-z_][A-Za-z0-9_]+$").test(result)){if(ms=new RegExp("[A-Z][a-z]+","g"),(m=ms.exec(result))!=null){blocks=System.Array.init(0,null);pos=0;do len=ms.lastIndex-pos|0,blocks.push(result.substr(pos,len).toLowerCase()),pos=pos+len|0;while((m=ms.exec(result))!=null);Bridge.referenceEquals(blocks[blocks.length-1|0],"type")?blocks[blocks.length-1|0]="t":blocks.push("t");result=blocks.join("_")}}else result=System.String.format("ecn_cls{0:X2}{1:X2}_t",cls.type.classGroup.classGroupCode,cls.type.classCode);return result},getPropertyIdentifier:function(pi){var cls=pi.classInfo,fi=pi,result=fi.identifer,ms,m,blocks,pos,len;if(new RegExp("^[A-Za-z_][A-Za-z0-9_]+$").test(result)){if(ms=new RegExp("[A-Z][a-z]+","g"),(m=ms.exec(result))!=null){blocks=System.Array.init(0,null);pos=0;do len=ms.lastIndex-pos|0,blocks.push(result.substr(pos,len).toLowerCase()),pos=pos+len|0;while((m=ms.exec(result))!=null);result=blocks.join("_")}}else result=System.String.format("property{0:X2}",pi.propertyCode);return fi.isArray&&(result+=System.String.format("[{0}]",pi.arrayCount)),result},getFieldIdentifier:function(efi){var fi=efi,result=fi.identifer,ms,m,blocks,pos,len;if(new RegExp("^[A-Za-z_][A-Za-z0-9_]+$").test(result)){if(ms=new RegExp("[A-Z][a-z]+","g"),(m=ms.exec(result))!=null){blocks=System.Array.init(0,null);pos=0;do len=ms.lastIndex-pos|0,blocks.push(result.substr(pos,len).toLowerCase()),pos=pos+len|0;while((m=ms.exec(result))!=null);result=blocks.join("_")}}else result=System.String.format("field{0:X8}",efi.type);return fi.isArray&&(result+=System.String.format("[{0}]",efi.arrayCount)),"@"+result},getObjectIdentifier:function(ci){var name=ci.identifer;return(System.String.endsWith(name,"_EOBJ")&&(name=name.substr(0,name.length-5|0)),System.String.startsWith(name,"0x"))?"eobj_"+name.substr(2,name.length-2|0)+"_data":name.toLowerCase()+"_data"},getEobjAttribute:function(eci){switch(eci.attribute){case"local":return"EOBJ_LOCAL_NODE";case"sync":return"EOBJ_SYNC_REMOTE_NODE";case"async":return"EOBJ_ASYNC_REMOTE_NODE";case"device":return"EOBJ_DEVICE";default:return"EOBJ_NONE"}},getNode:function(eci){var parent=eci.parent;return parent==null?"EOBJ_NULL":parent.identifer},getEpc:function(epi){return System.String.format("0x{0:X2}",epi.propertyCode)},getAccess:function(epi){var result=System.Array.init(0,null),access=System.Linq.Enumerable.from(epi.access).toArray();return(System.Linq.Enumerable.from(access).contains("RULE_ANNO")&&result.push("EPC_RULE_ANNO"),System.Linq.Enumerable.from(access).contains("RULE_SET")&&result.push("EPC_RULE_SET"),System.Linq.Enumerable.from(access).contains("RULE_GET")&&result.push("EPC_RULE_GET"),System.Linq.Enumerable.from(access).contains("ANNOUNCE")&&result.push("EPC_ANNOUNCE"),System.Linq.Enumerable.from(access).contains("VARIABLE")&&result.push("EPC_VARIABLE"),result.length===0)?"EPC_NONE":result.join(" | ")},getSize:function(epi){return((epi.arrayCount===0?1:epi.arrayCount)*epi.size|0).toString()},getExinf:function(epi){switch(epi.propertyCode){case 151:case 152:return"nil";default:return"@"+WebMrbc.CodeGenerator.getPropertyIdentifier(epi)}},hasPropSetter:function(epi,valueRange){return(valueRange.v=null,!epi.primitive||epi.arrayCount!==0)?!1:(valueRange.v=WebMrbc.ValueRange.parse(epi.valueDescription,epi),valueRange.v.getValues().length>0||valueRange.v.getRanges().length>0)?!0:(valueRange.v=null,!1)},getSetter:function(epi){var valueRange,clsName;switch(epi.propertyCode){case 128:return"onoff_prop_set";case 136:return"alarm_prop_set";case 151:return"time_prop_set";case 152:return"date_prop_set";default:return(valueRange={},WebMrbc.CodeGenerator.hasPropSetter(epi,valueRange))?(clsName=WebMrbc.CodeGenerator.getClassIdentifier(epi.classInfo),System.String.endsWith(clsName,"_t")&&(clsName=clsName.substr(0,clsName.length-2|0)),clsName+"_"+WebMrbc.CodeGenerator.getPropertyIdentifier(epi)+"_set"):"ecn_data_prop_set"}},getSetterBody:function(indent_,epi){var $t,$t1,body=new System.Text.StringBuilder,valueRange,Xn,indent,i,first,i1;switch(epi.propertyCode){case 128:body.appendLine(indent_+"# 動作状態ON/OFF設定関数（0x30, 0x31のみ受け付け）");body.appendLine(indent_+"def onoff_prop_set(prop, src)");body.appendLine(indent_+"\t# サイズが1以外は受け付けない");body.appendLine(indent_+"\tif (src.bytesize != 1) then");body.appendLine(indent_+"\t\treturn 0");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\tif (prop.anno) then");body.appendLine(indent_+"\t\tprop.set_anno(prop.exinf != src)");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\tcase (src.getbyte(0))");body.appendLine(indent_+"\t# ONの場合");body.appendLine(indent_+"\twhen 0x30 then");body.appendLine(indent_+"\t\tprop.set_exinf(src)");body.appendLine(indent_+"\t\t# TODO: ONの場合の処理");body.appendLine(indent_+"\t# OFFの場合");body.appendLine(indent_+"\twhen 0x31 then");body.appendLine(indent_+"\t\tprop.set_exinf(src)");body.appendLine(indent_+"\t\t# TODO: OFFの場合の処理");body.appendLine(indent_+"\t# 0x30か0x31以外は受け付けない");body.appendLine(indent_+"\telse");body.appendLine(indent_+"\t\treturn 0");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\treturn 1");body.appendLine(indent_+"end");break;case 136:body.appendLine(indent_+"# 異常発生状態設定関数（0x41, 0x42のみ受け付け）");body.appendLine(indent_+"def alarm_prop_set(prop, src)");body.appendLine(indent_+"\t# サイズが1以外は受け付けない");body.appendLine(indent_+"\tif (src.bytesize != 1) then");body.appendLine(indent_+"\t\treturn 0");body.appendLine();body.appendLine(indent_+"\tif (prop.anno) then");body.appendLine(indent_+"\t\tprop.set_anno(prop.exinf != src)");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\tcase (src.getbyte(0))");body.appendLine(indent_+"\t# 異常発生あり/なしの場合");body.appendLine(indent_+"\twhen 0x41,0x42 then");body.appendLine(indent_+"\t\tprop.set_exinf(src)");body.appendLine(indent_+"\t# 0x41か0x42以外は受け付けない");body.appendLine(indent_+"\telse");body.appendLine(indent_+"\t\treturn 0");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\treturn 1");body.appendLine(indent_+"end");break;case 151:body.appendLine(indent_+"# 現在時刻設定関数");body.appendLine(indent_+"def date_prop_get(prop, size)");body.appendLine(indent_+"\t# サイズが2以外は受け付けない");body.appendLine(indent_+"\tif (src.bytesize != 2) then");body.appendLine(indent_+"\t\treturn 0");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\ttime = Rtc.getTime");body.appendLine(indent_+"\ttime[3] = src.getbyte(0)");body.appendLine(indent_+"\ttime[4] = src.getbyte(1)");body.appendLine(indent_+"\tRtc.setTime time");body.appendLine();body.appendLine(indent_+"\treturn 2");body.appendLine(indent_+"end");break;case 152:body.appendLine(indent_+"# 現在年月日設定関数");body.appendLine(indent_+"def date_prop_get(prop, size)");body.appendLine(indent_+"\t# サイズが4以外は受け付けない");body.appendLine(indent_+"\tif (src.bytesize != 4) then");body.appendLine(indent_+"\t\treturn 0");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\ttime = Rtc.getTime");body.appendLine(indent_+"\ttime[0] = (src.getbyte(0) << 8) | src.getbyte(1)");body.appendLine(indent_+"\ttime[1] = src.getbyte(2)");body.appendLine(indent_+"\ttime[2] = src.getbyte(3)");body.appendLine(indent_+"\tRtc.setTime time");body.appendLine();body.appendLine(indent_+"\treturn 4");body.appendLine(indent_+"end");break;default:if(valueRange={},WebMrbc.CodeGenerator.hasPropSetter(epi,valueRange)){if(Xn="X"+(2*epi.size|0).toString(),indent=indent_+"\t",body.appendLine(indent_+System.String.format("# {0}設定関数",epi.description)),body.appendLine(indent_+System.String.format("def {0}(prop, src)",WebMrbc.CodeGenerator.getSetter(epi))),body.appendLine(indent_+System.String.format("\t# サイズが{0}以外は受け付けない",epi.size)),body.appendLine(indent_+System.String.format("\tif (src.bytesize != {0}) then",epi.size)),body.appendLine(indent_+"\t\treturn 0"),body.appendLine(indent_+"\tend"),body.appendLine(),valueRange.v.getValues().length>0){for(indent+="\t",body.appendLine(indent_+"\tcase (src.getbyte(0))"),$t=Bridge.getEnumerator(valueRange.v.getValues());$t.moveNext();)i=$t.getCurrent(),body.appendLine(indent_+System.String.format("\t# {0}の場合",i.getDisp())),body.appendLine(indent_+System.String.format("\twhen 0x{0} then",i.getVal().toString(16))),body.appendLine(indent_+"\t\tprop.set_exinf(src)"),body.appendLine(indent_+System.String.format("\t\t# TODO: {0}の場合の処理",i.getDisp()));body.appendLine(indent_+"\telse")}for(first=!0,$t1=Bridge.getEnumerator(valueRange.v.getRanges());$t1.moveNext();)i1=$t1.getCurrent(),System.String.isNullOrEmpty(i1.getDisp())||body.appendLine(indent+System.String.format("# {0}の場合",i1.getDisp())),first?(first=!1,body.append(indent)):body.append(indent+"else "),body.appendLine(indent+System.String.format("if((*({0} *)src >= 0x{1}) && (*({0} *)src <= 0x{2})){{",epi.type,i1.getMin().toString(16),i1.getMax().toString(16))),body.appendLine(indent+System.String.format("\t*(({0} *)item->exinf) = *(({0} *)src);",epi.type)),body.appendLine(indent+System.String.format("\t# TODO: {0}の場合の処理",System.String.isNullOrEmpty(i1.getDisp())?"この":i1.getDisp())),body.appendLine(indent+"end");valueRange.v.getValues().length>0?(body.appendLine(indent_+"\t\t# 上記以外は受け付けない"),body.appendLine(indent_+"\t\treturn 0"),body.appendLine(indent_+"\tend")):(body.appendLine(indent_+"\t# 上記以外は受け付けない"),body.appendLine(indent_+"\telse"),body.appendLine(indent_+"\t\treturn 0"),body.appendLine(indent_+"\tend"));body.appendLine();body.appendLine(indent_+System.String.format("\treturn {0}",epi.size));body.appendLine(indent_+"end");break}}return body.appendLine(),body.toString()},getGetter:function(epi){switch(epi.propertyCode){case 151:return"time_prop_get";case 152:return"date_prop_get";default:return"ecn_data_prop_get"}},getGetterBody:function(indent_,epi){var body=new System.Text.StringBuilder;switch(epi.propertyCode){case 151:body.appendLine(indent_+"# 現在時刻設定関数");body.appendLine(indent_+"def date_prop_get(prop, size)");body.appendLine(indent_+"\t# サイズが2以外は受け付けない");body.appendLine(indent_+"\tif (size != 2) then");body.appendLine(indent_+"\t\treturn 0");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\ttime = Rtc.getTime");body.appendLine();body.appendLine(indent_+"\treturn time[3].chr + time[4].chr");body.appendLine(indent_+"end");break;case 152:body.appendLine(indent_+"# 現在年月日設定関数");body.appendLine(indent_+"def date_prop_get(prop, size)");body.appendLine(indent_+"\t# サイズが4以外は受け付けない");body.appendLine(indent_+"\tif (size != 4) then");body.appendLine(indent_+"\t\treturn 0");body.appendLine(indent_+"\tend");body.appendLine();body.appendLine(indent_+"\ttime = Rtc.getTime");body.appendLine();body.appendLine(indent_+"\treturn ((time[0] & 0xFF00) >> 8).chr + (time[0] & 0xFF).chr + time[1].chr + time[2].chr");body.appendLine(indent_+"end")}return body.appendLine(),body.toString()},getInitialValue$1:function(body,emi,description,valRng,indent,recursive){var $t,pluse="",count,i,efi;if(body.appendLine(indent+"# "+description),recursive?(body.append(indent),pluse=" +"):body.append(indent+WebMrbc.CodeGenerator.getFieldIdentifier(emi)+" = "),Bridge.referenceEquals(emi.type,"manufacturer_code_t")){body.appendLine("$MAKER_CODE"+pluse);return}if(Bridge.referenceEquals(emi.type,"version_information_t")){body.appendLine('"\\x01\\x0A\\x01\\x00"'+pluse);return}if(Bridge.referenceEquals(emi.type,"standard_version_information_t")){body.appendLine('"\\x00\\x00C\\x00"'+pluse);return}if(emi.primitive)if(count=emi.arrayCount,count===0)body.appendLine('"'+WebMrbc.CodeGenerator.getInitialValue(valRng,emi)+'"'+pluse);else{for(body.append('"'),i=0;i<count;i=i+1|0)body.append(WebMrbc.CodeGenerator.getInitialValue(valRng,emi));body.appendLine('"'+pluse)}else{for(recursive||body.appendLine(),$t=Bridge.getEnumerator(emi.fields);$t.moveNext();)efi=$t.getCurrent(),WebMrbc.CodeGenerator.getInitialValue$1(body,efi,efi.description,efi.valueDescription,indent+"\t",!0);recursive||body.appendLine(indent+'\t""')}},getInitialValue:function(valRng,pi){for(var valueRange=WebMrbc.ValueRange.parse(valRng,pi),init="0000000000000000"+valueRange.getInitailValue(),temp=System.Array.init(4*pi.size|0,function(){return new System.Char}),i=0,j=init.length-(2*pi.size|0)|0;i<temp.length;i=i+1|0,j=j+1|0)i%4==0&&(temp[Bridge.identity(i,i=i+1|0)]=92,temp[Bridge.identity(i,i=i+1|0)]=120),temp[i]=init.charCodeAt(j);return String.fromCharCode.apply(null,temp)},isExtractProperty:function(prp){switch(prp.propertyCode){case 155:case 156:return!0;case 157:case 158:case 159:case 211:case 212:case 213:case 214:case 215:return!0}return!1}},_ClassInfo:null,_PropertyInfos:null,constructor:function(cls){var $t,prp;for(this._ClassInfo=cls,$t=Bridge.getEnumerator(cls.properties);$t.moveNext();)prp=$t.getCurrent(),prp.classInfo=cls;this._PropertyInfos=cls.properties},defineEchonetObject:function(indent){for(var body=new System.Text.StringBuilder,pi,$t=Bridge.getEnumerator(this._PropertyInfos);$t.moveNext();)(pi=$t.getCurrent(),WebMrbc.CodeGenerator.isExtractProperty(pi))||WebMrbc.CodeGenerator.getInitialValue$1(body,pi,pi.description,pi.valueDescription,indent,!1);return body.toString()},defineEchonetAccesser:function(indent,wa){for(var body=new System.Text.StringBuilder,pi,func,$t=Bridge.getEnumerator(this._PropertyInfos);$t.moveNext();)(pi=$t.getCurrent(),WebMrbc.CodeGenerator.isExtractProperty(pi))||(func=WebMrbc.CodeGenerator.getSetter(pi),System.Linq.Enumerable.from(wa.setterDefs).contains(func)||(wa.setterDefs.push(func),body.append(WebMrbc.CodeGenerator.getSetterBody(indent,pi))),func=WebMrbc.CodeGenerator.getGetter(pi),System.Linq.Enumerable.from(wa.getterDefs).contains(func)||(wa.getterDefs.push(func),body.append(WebMrbc.CodeGenerator.getGetterBody(indent,pi))));return body.toString()},configEchonetObject:function(indent){var $t,body=new System.Text.StringBuilder,epi;for(body.appendLine(indent+"# プロパティ定義"),body.appendLine(indent+"eprpinib_table = ["),$t=Bridge.getEnumerator(this._PropertyInfos);$t.moveNext();)(epi=$t.getCurrent(),WebMrbc.CodeGenerator.isExtractProperty(epi))||body.appendLine(indent+System.String.format("\tECNL::EProperty.new({0}, {1}, {2}, {3}, :{4}, :{5}),",WebMrbc.CodeGenerator.getEpc(epi),WebMrbc.CodeGenerator.getAccess(epi),WebMrbc.CodeGenerator.getSize(epi),WebMrbc.CodeGenerator.getExinf(epi),WebMrbc.CodeGenerator.getSetter(epi),WebMrbc.CodeGenerator.getGetter(epi)));return body.appendLine(indent+"]"),body.toString()}});Bridge.define("WebMrbc.CodeGenWorkArea",{setterDefs:null,getterDefs:null,config:{init:function(){this.setterDefs=System.Array.init(0,null);this.getterDefs=System.Array.init(0,null)}}});Bridge.define("WebMrbc.IModel",{$interface:!0});Bridge.define("WebMrbc.Collections",{statics:{LocalNode:null,ClassWorkspaces:null,EcnlTaskWorkspace:null,MainLoopWorkspace:null}});Bridge.define("WebMrbc.EmModule",{preRun:null,postRun:null,_Term:null,canvas:null,setStatus:null,_last:null,_text:null,totalDependencies:0,config:{init:function(){this.preRun=System.Array.init(0,null);this.postRun=System.Array.init(0,null)}},constructor:function(term){this._Term=term;this.canvas=document.getElementById("canvas");this.canvas.addEventListener("webglcontextlost",$_.WebMrbc.EmModule.f1,!1);this.setStatus=Bridge.fn.bind(this,this._setStatus)},print:function(arg){var $t,text,args,texts,ele;if(Bridge.referenceEquals(Bridge.getType(arg),String))text=Bridge.cast(arg,String);else if(Bridge.is(Bridge.getType(arg),Array)&&(args=Bridge.cast(arg,Array)).length>1){for(texts=System.Array.init(0,null),$t=Bridge.getEnumerator(args);$t.moveNext();)ele=$t.getCurrent(),texts.push(ele.toString());text=texts.join(" ")}else text=arg.toString();System.Console.log(text);this._Term!=null&&this._Term.write(text+"\r\n")},printErr:function(arg){var $t,text,args,texts,ele;if(Bridge.referenceEquals(Bridge.getType(arg),String))text=Bridge.cast(arg,String);else if(Bridge.is(Bridge.getType(arg),Array)&&(args=Bridge.cast(arg,Array)).length>1){for(texts=System.Array.init(0,null),$t=Bridge.getEnumerator(args);$t.moveNext();)ele=$t.getCurrent(),texts.push(ele.toString());text=texts.join(" ")}else text=arg.toString();System.Console.log(text);this._Term!=null&&this._Term.write(text+"\r\n")},_setStatus:function(text){var statusElement;if(this._last==null&&(this._last=new $_.$AnonymousType$3(System.Int64((new Date).getTime()).mul(1e4),"")),!Bridge.referenceEquals(text,this._text)){var progressElement=Bridge.cast(document.getElementById("progress"),HTMLProgressElement),spinnerElement=Bridge.cast(document.getElementById("spinner"),HTMLDivElement),m=text.match(new RegExp("([^(]+)\\((\\d+(\\.\\d+)?)\\/(\\d+)\\)")),now=System.Int64((new Date).getTime()).mul(1e4);m!=null&&now.sub(System.Int64((new Date).getTime()).mul(1e4)).lt(System.Int64(30))||(m!=null?(text=m[1],progressElement.value=parseInt(m[2])*100|0,progressElement.max=parseInt(m[4])*100|0,progressElement.setAttribute("hidden","false"),spinnerElement.setAttribute("hidden","false")):(progressElement.value=0,progressElement.max=0,progressElement.setAttribute("hidden","true"),System.String.isNullOrEmpty(text)||(spinnerElement.style.display="none")),statusElement=Bridge.cast(document.getElementById("status"),HTMLDivElement),statusElement.innerHTML=text)}},monitorRunDependencies:function(left){this.totalDependencies=Math.max(this.totalDependencies,left);this.setStatus(left!==0?"Preparing... ("+(this.totalDependencies-left|0)+"/"+this.totalDependencies+")":"All downloads complete.")},getFileSystem:function(){return this.FS}});Bridge.define("$AnonymousType$3",$_,{constructor:function(time,text){this.time=time;this.text=text},gettime:function(){return this.time},gettext:function(){return this.text},equals:function(o){return Bridge.is(o,$_.$AnonymousType$3)?Bridge.equals(this.time,o.time)&&Bridge.equals(this.text,o.text):!1},getHashCode:function(){var hash=17;return hash=hash*23+-1826821090,hash=hash*23+(this.time==null?0:Bridge.getHashCode(this.time)),hash*23+(this.text==null?0:Bridge.getHashCode(this.text))},toJSON:function(){return{time:this.time,text:this.text}}});Bridge.ns("WebMrbc.EmModule",$_);Bridge.apply($_.WebMrbc.EmModule,{f1:function(e){window.alert("WebGL context lost. You will need to reload the page.");e.preventDefault()}});Bridge.define("WebMrbc.EObjectModalView",{el:null,model:null,target:null,currentClassGroup:null,config:{events:{Closed:null}},constructor:function(){this.el=$("#eobject-modal")},setEObject:function(eobject,imgUrl){this.target=eobject;this.model=WebMrbc.JsonObjectInfoExtention.clone(eobject);var img=$("<img>");img.attr("src",imgUrl);img.attr("alt",this.model.identifer);$("#eobject-modal-eobject img").replaceWith(img);$("#eobject_identifer").val(this.model.identifer);$("#eobject_instanceCode").val(this.model.instanceCode.toString());this.setAttribute(this.model.attribute);this.setClassGroup(this.model.type.classGroup,Bridge.fn.bind(this,$_.WebMrbc.EObjectModalView.f1))},render:function(){this.el.modal({backdrop:"static",show:!0})},setAttribute:function(attribute){var dropdown=$("#eobject_attribute").parent(),menuitem=$("a[role='menuitem']",dropdown),text;switch(attribute){case"local":text=menuitem.get(0).textContent;break;case"sync":text=menuitem.get(1).textContent;break;case"async":text=menuitem.get(2).textContent;break;case"device":text=menuitem.get(3).textContent;break;default:text=attribute}this.setAttribute$1(attribute,text)},setAttribute$1:function(attribute,text){var button,caret;this.model.attribute=attribute;button=$("#eobject_attribute");button.text(text);caret=document.createElement("span");caret.setAttribute("class","caret");button.get(0).appendChild(caret)},setClassGroup:function(cg,success){var button,caret;if(success===void 0&&(success=null),this.currentClassGroup=cg,button=$("#eobject_classGroupCode"),button.text(cg.description),caret=document.createElement("span"),caret.setAttribute("class","caret"),button.get(0).appendChild(caret),cg.classes!=null){this.initClasss(cg);Bridge.staticEquals(success,null)||success();return}WebMrbc.App.updateClass(cg,Bridge.fn.bind(this,function(){this.initClasss(cg);Bridge.staticEquals(success,null)||success()}))},setClass:function(c,success){var button,caret;if(success===void 0&&(success=null),this.model.type=c,button=$("#eobject_classCode"),button.text(c.description),caret=document.createElement("span"),caret.setAttribute("class","caret"),button.get(0).appendChild(caret),c.properties!=null){this.initProperties(c);Bridge.staticEquals(success,null)||success();return}WebMrbc.App.updateProperties(c,Bridge.fn.bind(this,function(){this.initProperties(c);Bridge.staticEquals(success,null)||success()}))},initClassGroups:function(){var $t,ul=$("#eobject_classGroups").get(0),cg,li,a;for(ul.innerHTML="",$t=Bridge.getEnumerator(WebMrbc.App.classGroups);$t.moveNext();)cg=$t.getCurrent(),li=document.createElement("li"),li.setAttribute("role","presentation"),a=document.createElement("a"),a.setAttribute("role","menuitem"),a.appendChild(document.createTextNode(cg.description)),$(a).click(cg,Bridge.fn.bind(this,this.onSelectClassGroupCode)),li.appendChild(a),ul.appendChild(li)},initClasss:function(cg){var $t,ul=$("#eobject_classs").get(0),c,li,a;for(ul.innerHTML="",$t=Bridge.getEnumerator(cg.classes);$t.moveNext();)c=$t.getCurrent(),li=document.createElement("li"),li.setAttribute("role","presentation"),a=document.createElement("a"),a.setAttribute("role","menuitem"),a.appendChild(document.createTextNode(c.description)),$(a).click(c,Bridge.fn.bind(this,this.onSelectClassCode)),li.appendChild(a),ul.appendChild(li)},initProperties:function(c){var $t,div=$("#eobject_properties").get(0),p,label,input;for(div.innerHTML="",$t=Bridge.getEnumerator(c.properties);$t.moveNext();)p=$t.getCurrent(),label=document.createElement("label"),label.setAttribute("class","btn btn-default"),input=document.createElement("input"),input.setAttribute("type","checkbox"),input.setAttribute("autocomplete","off"),label.appendChild(input),label.appendChild(document.createTextNode(p.description)),label.setAttribute("data-ecnl-epc",p.propertyCode.toString()),div.appendChild(label),p.required.length>0&&!Bridge.referenceEquals(p.required[0],"NONE")&&$(label).button("toggle")},updateProperties:function(){for(var $t1,labels=$("#eobject_properties > .btn.btn-default"),l,label,sepc,epc,prop,p,$t=Bridge.getEnumerator(labels.get());$t.moveNext();)if(l=$t.getCurrent(),label=$(l),label.is(".active")&&label.button("toggle"),sepc=label.attr("data-ecnl-epc"),sepc!=null){for(epc=parseInt(sepc),prop=null,$t1=Bridge.getEnumerator(this.model.properties);$t1.moveNext();)if(p=$t1.getCurrent(),p.propertyCode===epc){prop=p;break}prop!=null&&label.button("toggle")}},onSelectAttribute:function(sender,attribute){var text=sender.textContent;this.setAttribute$1(attribute,text)},onSelectClassGroupCode:function(e){this.setClassGroup(Bridge.cast(e.data,WebMrbc.JsonClassGroupInfo))},onSelectClassCode:function(e){this.setClass(Bridge.cast(e.data,WebMrbc.JsonClassInfo))},onChangeInstanceCode:function(sender){this.model.instanceCode=parseInt($(sender).val())&255},onOk:function(){var $t,$t1,labels,l,label,sepc,epc,prop,p;for(this.el.modal("hide"),this.target.type=this.model.type,this.target.identifer=this.model.identifer,this.target.parent=this.model.parent,this.target.instanceCode=this.model.instanceCode,this.target.attribute=this.model.attribute,this.target.properties=System.Array.init(0,null),labels=$("#eobject_properties > .btn.btn-default"),$t=Bridge.getEnumerator(labels.get());$t.moveNext();)if((l=$t.getCurrent(),label=$(l),label.is(".active"))&&(sepc=label.attr("data-ecnl-epc"),sepc!=null)){for(epc=parseInt(sepc),prop=null,$t1=Bridge.getEnumerator(this.model.type.properties);$t1.moveNext();)if(p=$t1.getCurrent(),p.propertyCode===epc){prop=p;break}prop!=null&&this.target.properties.push(prop)}Bridge.staticEquals(this.Closed,null)||this.Closed(this,!0)},onCancel:function(){this.el.modal("hide");Bridge.staticEquals(this.Closed,null)||this.Closed(this,!1)}});Bridge.ns("WebMrbc.EObjectModalView",$_);Bridge.apply($_.WebMrbc.EObjectModalView,{f1:function(){this.setClass(this.model.type,Bridge.fn.bind(this,this.updateProperties))}});Bridge.define("WebMrbc.Generator",{constructor:function(name){var i,g=new Blockly.Generator;for(i in g)this[i]||(this[i]=g[i]);Blockly.Generator.call(this,name)}});Bridge.define("WebMrbc.HexDump",{text:null,constructor:function(bytes,width){for(var sb=new System.Text.StringBuilder,index=0;index<bytes.length;index=index+width|0)sb.appendFormat("{0:X4} : ",index),sb.append(this.binBump(bytes,index,width)),sb.appendLine(this.asciiDump(bytes,index,width));this.text=sb.toString()},binBump:function(bytes,offset,width){for(var sb=new System.Text.StringBuilder,index=0;index<width;index=index+1|0)(index+offset|0)<bytes.length?sb.appendFormat("{0:X2} ",bytes[index+offset|0]):sb.append("   ");return sb.toString()},asciiDump:function(bytes,index,width){var sb=new System.Text.StringBuilder,i,b;if(index<bytes.length)for(width=Math.min(width,bytes.length-index|0),sb.append(": "),i=0;i<width;i=i+1|0)b=bytes[i+index|0],b<32&&(b=32),sb.append(String.fromCharCode(b));else sb.append(":         ");return sb.toString()},toString:function(){return this.text}});Bridge.define("WebMrbc.JsonClassGroupInfo",{classGroupCode:0,description:null,define:null,classes:null,constructor:function(p){this.classGroupCode=p.classGroupCode;this.description=p.description;this.define=p.define}});Bridge.define("WebMrbc.JsonClassInfo",{classCode:0,description:null,name:null,define:null,type:null,classGroup:null,properties:null,constructor:function(p){this.classCode=p.classCode;this.description=p.description;this.name=p.name;this.define=p.define;this.type=p.type;this.classGroup=p.classGroup;this.properties=p.properties}});Bridge.define("WebMrbc.JsonFieldInfo",{description:null,valueDescription:null,unitDescription:null,initialValue:null,type:null,identifer:null,primitive:!1,isArray:!1,arrayCount:0,size:0,fields:null});Bridge.define("WebMrbc.JsonObjectInfo",{type:null,parent:null,identifer:null,instanceCode:0,attribute:null,properties:null,constructor:function(type,identifer){this.type=type;this.identifer=identifer;this.instanceCode=1;this.attribute="device";this.properties=System.Array.init(0,null)},findProperty:function(epc){for(var item,$t=Bridge.getEnumerator(this.properties);$t.moveNext();)if(item=$t.getCurrent(),item.propertyCode===epc)return item;return null}});Bridge.define("WebMrbc.JsonObjectInfoExtention",{statics:{clone:function(obj){return Bridge.merge(new WebMrbc.JsonObjectInfo(obj.type,obj.identifer),{parent:obj.parent,instanceCode:obj.instanceCode,attribute:obj.attribute,properties:Bridge.cast(System.Array.clone(obj.properties),Array)})},copy:function(dst,src){dst.type=src.type;dst.identifer=src.identifer;dst.parent=src.parent;dst.instanceCode=src.instanceCode;dst.attribute=src.attribute;dst.properties=Bridge.cast(System.Array.clone(src.properties),Array)}}});Bridge.define("WebMrbc.JsonSkeltonResult",{macro:null,declare:null,predefine:null,types:null,funcs:null,instance:null,define:null,config:null});Bridge.define("WebMrbc.MainMenuView",{el:"#main-menu",constructor:function(){$("#filename").keypress($_.WebMrbc.MainMenuView.f1);$(".dropdown-toggle").dropdown()},onHelp:function(){WebMrbc.App.module=WebMrbc.App.initModule();var args="--help";WebMrbc.App.term!=null&&WebMrbc.App.term.write("$ mrbc "+args+"\r\n");WebMrbc.App.module.arguments=args.split(" ");mrbc(WebMrbc.App.module);this.onOutputMode()},onVersion:function(){WebMrbc.App.module=WebMrbc.App.initModule();var args="--version";WebMrbc.App.term!=null&&WebMrbc.App.term.write("$ mrbc "+args+"\r\n");WebMrbc.App.module.arguments=args.split(" ");mrbc(WebMrbc.App.module);this.onOutputMode()},onCompileToC:function(){WebMrbc.App.module=WebMrbc.App.initModule();WebMrbc.App.module.preRun.push(WebMrbc.App.preRun);WebMrbc.App.module.postRun.push($_.WebMrbc.MainMenuView.f2);var args="-Bmain_rb_code -o build/main_rb.c src/main.rb";WebMrbc.App.term!=null&&WebMrbc.App.term.write("$ mrbc "+args+"\r\n");WebMrbc.App.module.arguments=args.split(" ");mrbc(WebMrbc.App.module);this.onOutputMode()},onCompileToBin:function(){WebMrbc.App.module=WebMrbc.App.initModule();WebMrbc.App.module.preRun.push(WebMrbc.App.preRun);WebMrbc.App.module.postRun.push($_.WebMrbc.MainMenuView.f3);var args="-o build/main_rb.bin src/main.rb";WebMrbc.App.term!=null&&WebMrbc.App.term.write("$ mrbc "+args+"\r\n");WebMrbc.App.module.arguments=args.split(" ");mrbc(WebMrbc.App.module);this.onOutputMode()},onBlockMode:function(){$("#tabs a[href='#block-tab']").tab("show");$(".blocklyToolboxDiv").show()},onRubyMode:function(){var code,textEditor;WebMrbc.Views.ClassSelectorView.getCurrent().loadDom(Blockly.Xml.workspaceToDom(Blockly.mainWorkspace));code=new System.Text.StringBuilder;WebMrbc.Collections.ClassWorkspaces.each(function(e){Bridge.is(e,WebMrbc.EObjectWorkspace)&&code.append(e.toCode())});code.append(WebMrbc.Collections.EcnlTaskWorkspace.toCode());code.append(WebMrbc.Collections.MainLoopWorkspace.toCode());textEditor=window.textEditor;textEditor.setValue(code.toString());textEditor.moveCursorTo(0,0);$("#tabs a[href='#ruby-tab']").tab("show");$(".blocklyToolboxDiv").hide()},onOutputMode:function(){$("#tabs a[href='#output-tab']").tab("show");$(".blocklyToolboxDiv").hide()},onRun:function(){},onLoadLocal:function(){},onSave:function(){},onCheck:function(){},onReset:function(){},onPreference:function(){},onSignout:function(){},onSignin:function(){},onUsername:function(){},load:function(info){if(info.error!=null)window.errorMessage.call(null,goog.getMsg(WebMrbc.App.bm("VIEWS_MAIN_MENU_VIEW_LOAD_ERROR"),new $_.$AnonymousType$4(info.filename,info.error)));else{clearMessages();var filename=info.filename;filename.match(new RegExp("\\.xml$"))!=null?(Bridge.referenceEquals(window.blockMode,undefined)&&(window.blockMode=!0),$("#tabs a[href='#block-tab']").tab("show"),filename=filename.replace(new RegExp("(\\.rb)?\\.xml$"),".rb"),WebMrbc.App.loadXml(info.data),info.data=Blockly.Ruby.workspaceToCode(Blockly.mainWorkspace)):(WebMrbc.Collections.ClassWorkspaces.reset(),Blockly.mainWorkspace.clear(),window.blockMode&&(window.blockMode=!1,$("#tabs a[href='#ruby-tab']").tab("show"),window.textEditor.focus()));$("#filename").val(filename);window.textEditor.getSession().getDocument().setValue(info.data);window.textEditor.moveCursorTo(0,0);window.changed=!1;WebMrbc.App.changedAfterTranslating=!0;window.successMessage.call(null,WebMrbc.App.bm("VIEWS_MAIN_MENU_VIEW_LOAD_SUCCEEDED"))}}});Bridge.define("$AnonymousType$4",$_,{constructor:function(filename,error){this.filename=filename;this.error=error},getfilename:function(){return this.filename},geterror:function(){return this.error},equals:function(o){return Bridge.is(o,$_.$AnonymousType$4)?Bridge.equals(this.filename,o.filename)&&Bridge.equals(this.error,o.error):!1},getHashCode:function(){var hash=17;return hash=hash*23+545831905,hash=hash*23+(this.filename==null?0:Bridge.getHashCode(this.filename)),hash*23+(this.error==null?0:Bridge.getHashCode(this.error))},toJSON:function(){return{filename:this.filename,error:this.error}}});Bridge.ns("WebMrbc.MainMenuView",$_);Bridge.apply($_.WebMrbc.MainMenuView,{f1:function(e){return e==null&&(e=window.event),e.keyCode===13?($("#save-button").click(),!1):!0},f2:function(){var FS=WebMrbc.App.module.getFileSystem(),stt=FS.stat("build/main_rb.c"),stream=FS.open("build/main_rb.c","r"),buf=new Uint8Array(stt.size),element;FS.read(stream,buf,0,stt.size,0);FS.close(stream);element=Bridge.cast(document.getElementById("output"),HTMLTextAreaElement);element.value=WebMrbc.App.module.UTF8ArrayToString(buf,0)+"\n";element.scrollTop=element.scrollHeight},f3:function(){var FS=WebMrbc.App.module.getFileSystem(),stt=FS.stat("build/main_rb.bin"),stream=FS.open("build/main_rb.bin","r"),buf=new Uint8Array(stt.size),element;FS.read(stream,buf,0,stt.size,0);FS.close(stream);element=Bridge.cast(document.getElementById("output"),HTMLTextAreaElement);element.value=new WebMrbc.HexDump(buf,16).toString();element.scrollTop=element.scrollHeight}});Bridge.define("WebMrbc.State",{statics:{Value:0,EqualOrRange:1,Description:2,UnitOrCommaOrEnd:3,RengeMax:4,StartParenthesis:5,RangeDescription:6,MinDescription:7,RangeSeparetor:8,MaxDescription:9,EndParenthesis:10,CommaOrEnd:11,BitFieldLSB:12,BitRange:13,BitFieldMSB:14,BitFieldDescription:15,BitRangeEnd:16,Colon:17},$enum:!0});Bridge.define("WebMrbc.TokenInfo",{statics:{separetor:"[=,:\\(\\)\\[\\]～]",hexValue:"^0x[0-9A-Fa-f]+",numeric:"^[\\-\\+]?[\\.]?[0-9]+[0-9,\\.]*"},token:null,type:0,constructor:function(token,type){this.token=token;this.type=type},toString:function(){return this.token},toInt32:function(){switch(this.type){case WebMrbc.TokenType.HexValue:return parseInt(this.token.substr(2),16);case WebMrbc.TokenType.Numeric:return parseInt(this.token);default:return 0}},toInt64:function(){var temp;switch(this.type){case WebMrbc.TokenType.HexValue:return temp=this.token.substr(2),System.Int64(parseInt(temp,16));case WebMrbc.TokenType.Numeric:return System.Int64(parseInt(this.token));default:return System.Int64(0)}}});Bridge.define("WebMrbc.TokenType",{statics:{Separetor:0,HexValue:1,Numeric:2,String:3,End:4},$enum:!0});Bridge.define("WebMrbc.ValueRange",{statics:{_ParsedText:null,config:{init:function(){this._ParsedText=new System.Collections.Generic.Dictionary$2(String,WebMrbc.ValueSet)()}},parseValueRange:function(input,type,values,ranges,bitFeild,initialValue){var $t,tokens,pos,ms,m,index,token,option,option1,option2,option3,option4,max,i,range,range1,range2;for(bitFeild.v=null,initialValue.v=null,tokens=System.Array.init(0,null),pos=0;pos<input.length;)if((m=(ms=new RegExp(WebMrbc.TokenInfo.hexValue)).exec(input.substr(pos)))!=null)tokens.push(new WebMrbc.TokenInfo(m[0],WebMrbc.TokenType.HexValue)),pos=pos+m[0].length|0;else if((m=(ms=new RegExp(WebMrbc.TokenInfo.numeric)).exec(input.substr(pos)))!=null)tokens.push(new WebMrbc.TokenInfo(m[0],WebMrbc.TokenType.Numeric)),pos=pos+m[0].length|0;else{if((m=(ms=new RegExp(WebMrbc.TokenInfo.separetor)).exec(input.substr(pos)))==null){tokens.push(new WebMrbc.TokenInfo(input.substr(pos),WebMrbc.TokenType.String));break}index=pos+ms.lastIndex|0;index===pos?(tokens.push(new WebMrbc.TokenInfo(m[0],WebMrbc.TokenType.Separetor)),pos=pos+1|0):(tokens.push(new WebMrbc.TokenInfo(input.substr(pos,index-pos|0),WebMrbc.TokenType.String)),tokens.push(new WebMrbc.TokenInfo(m[0],WebMrbc.TokenType.Separetor)),pos=index+1|0)}tokens.push(new WebMrbc.TokenInfo("",WebMrbc.TokenType.End));var OK=!1,sentence=System.Array.init(0,null),state=WebMrbc.State.Value;for($t=Bridge.getEnumerator(tokens);$t.moveNext();){token=$t.getCurrent();switch(state){case WebMrbc.State.Value:if(token.type===WebMrbc.TokenType.HexValue||token.type===WebMrbc.TokenType.Numeric){sentence.push(token);state=WebMrbc.State.EqualOrRange;continue}else if(token.type===WebMrbc.TokenType.Separetor&&Bridge.referenceEquals(token.token,"[")){if(bitFeild.v!=null)break;state=WebMrbc.State.BitFieldLSB;continue}break;case WebMrbc.State.EqualOrRange:if(token.type===WebMrbc.TokenType.Separetor)switch(token.token){case"=":state=WebMrbc.State.Description;continue;case"～":state=WebMrbc.State.RengeMax;continue}else if(token.type===WebMrbc.TokenType.End){option=new WebMrbc.Option(sentence[0].toInt64(type),"固定");bitFeild.v!=null?bitFeild.v.addValue(option):(initialValue.v==null&&(initialValue.v=option),values.push(option));sentence.splice(0,sentence.length);state=WebMrbc.State.CommaOrEnd;continue}break;case WebMrbc.State.Description:if(token.type===WebMrbc.TokenType.String){option1=new WebMrbc.Option(sentence[0].toInt64(type),token.token);bitFeild.v!=null?bitFeild.v.addValue(option1):(initialValue.v==null&&(initialValue.v=option1),values.push(option1));sentence.splice(0,sentence.length);state=WebMrbc.State.CommaOrEnd;continue}else if(token.type===WebMrbc.TokenType.Numeric){sentence.push(token);state=WebMrbc.State.UnitOrCommaOrEnd;continue}break;case WebMrbc.State.UnitOrCommaOrEnd:if(token.type===WebMrbc.TokenType.String){option2=new WebMrbc.Option(sentence[0].toInt64(type),sentence[1].token+token.token);bitFeild.v!=null?bitFeild.v.addValue(option2):(initialValue.v==null&&(initialValue.v=option2),values.push(option2));sentence.splice(0,sentence.length);state=WebMrbc.State.CommaOrEnd;continue}else if(token.type===WebMrbc.TokenType.Separetor&&Bridge.referenceEquals(token.token,",")){option3=new WebMrbc.Option(sentence[0].toInt64(type),sentence[1].token);bitFeild.v!=null?bitFeild.v.addValue(option3):(initialValue.v==null&&(initialValue.v=option3),values.push(option3));sentence.splice(0,sentence.length);state=WebMrbc.State.Value;continue}else token.type===WebMrbc.TokenType.End&&(option4=new WebMrbc.Option(sentence[0].toInt64(type),sentence[1].token),bitFeild.v!=null?bitFeild.v.addValue(option4):(initialValue.v==null&&(initialValue.v=option4),values.push(option4)),sentence.splice(0,sentence.length),OK=!0);break;case WebMrbc.State.RengeMax:if(token.type===WebMrbc.TokenType.HexValue||token.type===WebMrbc.TokenType.Numeric){sentence.push(token);state=WebMrbc.State.StartParenthesis;continue}else if(token.type===WebMrbc.TokenType.Separetor&&Bridge.referenceEquals(token.token,"=")){for(max="0x",i=sentence[0].token.length-2|0;i>0;i=i-1|0)max+="F";sentence.push(new WebMrbc.TokenInfo(max,WebMrbc.TokenType.HexValue));state=WebMrbc.State.RangeDescription;continue}break;case WebMrbc.State.StartParenthesis:if(token.type===WebMrbc.TokenType.Separetor)switch(token.token){case"=":if(sentence.length===2){state=WebMrbc.State.RangeDescription;continue}break;case"(":sentence.push(new WebMrbc.TokenInfo("",WebMrbc.TokenType.String));state=WebMrbc.State.MinDescription;continue;case",":range=new WebMrbc.Range("constructor",sentence[0].toInt64(type),sentence[1].toInt64(type),sentence.length>2?sentence[2].token:"");bitFeild.v!=null?bitFeild.v.addRange(range):(initialValue.v==null&&(initialValue.v=range),ranges.push(range));sentence.splice(0,sentence.length);state=WebMrbc.State.Value;continue}else token.type===WebMrbc.TokenType.End&&(range1=new WebMrbc.Range("constructor",sentence[0].toInt64(type),sentence[1].toInt64(type),sentence.length>2?sentence[2].token:""),bitFeild.v!=null?bitFeild.v.addRange(range1):(initialValue.v==null&&(initialValue.v=range1),ranges.push(range1)),sentence.splice(0,sentence.length),OK=!0);break;case WebMrbc.State.RangeDescription:if(token.type===WebMrbc.TokenType.String){sentence.push(token);state=WebMrbc.State.StartParenthesis;continue}break;case WebMrbc.State.MinDescription:if(token.type===WebMrbc.TokenType.Numeric||token.type===WebMrbc.TokenType.String){sentence.push(token);state=WebMrbc.State.RangeSeparetor;continue}break;case WebMrbc.State.RangeSeparetor:if(token.type===WebMrbc.TokenType.Separetor&&Bridge.referenceEquals(token.token,"～")){state=WebMrbc.State.MaxDescription;continue}break;case WebMrbc.State.MaxDescription:if(token.type===WebMrbc.TokenType.Numeric||token.type===WebMrbc.TokenType.String){sentence.push(token);state=WebMrbc.State.EndParenthesis;continue}break;case WebMrbc.State.EndParenthesis:if(token.type===WebMrbc.TokenType.Separetor&&Bridge.referenceEquals(token.token,")")){range2=new WebMrbc.Range("constructor$1",sentence[0].toInt64(type),sentence[1].toInt64(type),sentence[2].token,sentence[3].token,sentence[4].token,sentence.length>5?sentence[5].token:"");bitFeild.v!=null?bitFeild.v.addRange(range2):(initialValue.v==null&&(initialValue.v=range2),ranges.push(range2));sentence.splice(0,sentence.length);state=WebMrbc.State.CommaOrEnd;continue}else if(token.type===WebMrbc.TokenType.String){sentence.push(token);state=WebMrbc.State.EndParenthesis;continue}break;case WebMrbc.State.BitFieldLSB:if(token.type===WebMrbc.TokenType.Numeric){sentence.push(token);state=WebMrbc.State.BitRange;continue}break;case WebMrbc.State.BitRange:if(token.type===WebMrbc.TokenType.Separetor)switch(token.token){case"～":state=WebMrbc.State.BitFieldMSB;continue;case"]":sentence.push(sentence[0]);state=WebMrbc.State.BitFieldDescription;continue}break;case WebMrbc.State.BitFieldMSB:if(token.type===WebMrbc.TokenType.Numeric){sentence.push(token);state=WebMrbc.State.BitRangeEnd;continue}break;case WebMrbc.State.BitRangeEnd:if(token.type===WebMrbc.TokenType.Separetor&&Bridge.referenceEquals(token.token,"]")){state=WebMrbc.State.BitFieldDescription;continue}break;case WebMrbc.State.BitFieldDescription:if(token.type===WebMrbc.TokenType.String){sentence.push(token);state=WebMrbc.State.Colon;continue}break;case WebMrbc.State.Colon:if(token.type===WebMrbc.TokenType.Separetor&&Bridge.referenceEquals(token.token,":")){bitFeild.v=new WebMrbc.BitField(sentence[0].toInt32(),sentence[1].toInt32(),sentence[2].token);initialValue.v==null&&(initialValue.v=bitFeild.v);sentence.splice(0,sentence.length);state=WebMrbc.State.Value;continue}else if(token.type===WebMrbc.TokenType.End){bitFeild.v=new WebMrbc.BitField(sentence[0].toInt32(),sentence[1].toInt32(),sentence[2].token);initialValue.v==null&&(initialValue.v=bitFeild.v);sentence.splice(0,sentence.length);OK=!0;break}break;case WebMrbc.State.CommaOrEnd:if(token.type===WebMrbc.TokenType.End)OK=!0;else if(token.type===WebMrbc.TokenType.Separetor&&Bridge.referenceEquals(token.token,",")){state=WebMrbc.State.Value;continue}}break}return OK},parse:function(valrng,emti){var $t,$t1,valueRange=new WebMrbc.ValueRange,lines,line,efi,member;if(emti.primitive){for(lines=valrng.split(new RegExp("\r\n")),$t=Bridge.getEnumerator(lines);$t.moveNext();)if(line=$t.getCurrent(),!new RegExp("^<(.+)>$").test(line)){var values,ranges,bitField={},initialValue={},pair={};WebMrbc.ValueRange._ParsedText.tryGetValue(line,pair)?(values=pair.v.values,ranges=pair.v.ranges,bitField.v=pair.v.bitField,initialValue.v=pair.v.initialValue):(values=System.Array.init(0,null),ranges=System.Array.init(0,null),WebMrbc.ValueRange.parseValueRange(line,emti.type,values,ranges,bitField,initialValue),WebMrbc.ValueRange._ParsedText.add(line,new WebMrbc.ValueSet(values,ranges,bitField.v,initialValue.v)));valueRange._Values.concat.apply(valueRange._Values,values);valueRange._Ranges.concat.apply(valueRange._Ranges,ranges);bitField.v!=null&&valueRange._BitFields.push(bitField.v);valueRange._InitailValue==null&&(valueRange._InitailValue=initialValue.v)}}else for($t1=Bridge.getEnumerator(emti.fields);$t1.moveNext();)efi=$t1.getCurrent(),member=WebMrbc.ValueRange.parse(efi.valueDescription,efi),valueRange._MemberFields.push(member);return valueRange}},_Values:null,_Ranges:null,_BitFields:null,_MemberFields:null,_InitailValue:null,config:{init:function(){this._Values=System.Array.init(0,null);this._Ranges=System.Array.init(0,null);this._BitFields=System.Array.init(0,null);this._MemberFields=System.Array.init(0,null)}},getValues:function(){return this._Values},getRanges:function(){return this._Ranges},getBitFields:function(){return this._BitFields},getMemberFields:function(){return this._MemberFields},getInitailValue:function(){return this._InitailValue==null?"":this._InitailValue.getInitialValue()},setInitailValue:function(value){for(var $t1,$t2,val64=parseInt(value),val,rng,ok,bitFlds,bit,$t=Bridge.getEnumerator(this._Values);$t.moveNext();)if(val=$t.getCurrent(),!val.getVal().ne(System.Int64(val64))){this._InitailValue=val;return}for($t1=Bridge.getEnumerator(this._Ranges);$t1.moveNext();)if(rng=$t1.getCurrent(),!rng.getMin().gt(System.Int64(val64))&&!rng.getMax().lt(System.Int64(val64))){this._InitailValue=new WebMrbc.InRangeValue(rng,System.Int64(val64));return}if(this._BitFields.length>0){for(ok=!0,bitFlds=System.Array.init(0,null),$t2=Bridge.getEnumerator(this._BitFields);$t2.moveNext();){if(bit=$t2.getCurrent(),!bit.isInRange(System.Int64(val64))){ok=!1;break}bitFlds.push(bit.getInRangeValue(System.Int64(val64)))}if(ok){this._InitailValue=new WebMrbc.BitFiledsValue(this._BitFields,bitFlds,System.Int64(val64));return}}}});Bridge.define("WebMrbc.ValueSet",{values:null,ranges:null,bitField:null,initialValue:null,constructor:function(values,ranges,bitField,initialValue){this.values=values;this.ranges=ranges;this.bitField=bitField;this.initialValue=initialValue}});Bridge.define("WebMrbc.Views",{statics:{ClassSelectorView:null,MainMenuView:null,EObjectModalView:null}});Bridge.define("WebMrbc.AnalogDacBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("アナログDAC出力");this.appendValueInput("VALUE").setCheck("Number");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.AnalogReadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("アナログリード").appendField(new Blockly.FieldDropdown([["Pin1","PIN1"],["Pin2","PIN2"],["Pin3","PIN3"]]),"PIN_NO");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.AnalogReferenceBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("アナログ入力基準電圧").appendField(new Blockly.FieldDropdown([["5.0V Arduino互換","AR_DEFAULT"],["1.1V 内蔵電圧","AR_INTERNAL"],["AVREFピン供給電圧","AR_EXTERNAL"],["3.3V 12ビットA/D変換を行う","AR_RAW12BIT"]]),"ANALOG_REFERENCE_MODE");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.BitField",{inherits:[WebMrbc.Value],_Least:0,_Most:0,_Disp:null,_Values:null,_Ranges:null,_InitailValue:null,config:{init:function(){this._Values=System.Array.init(0,null);this._Ranges=System.Array.init(0,null)}},constructor:function(least,most,disp){WebMrbc.Value.prototype.$constructor.call(this);this._Least=least;this._Most=most;this._Disp=disp},getLeast:function(){return this._Least},getMost:function(){return this._Most},getDisp:function(){return this._Disp},getValues:function(){return this._Values},getRanges:function(){return this._Ranges},getInitailValue:function(){return this._InitailValue},getInitialValue:function(){return this._InitailValue==null?"":this._InitailValue.getInitialValue()},addValue:function(option){this._InitailValue==null&&(this._InitailValue=option);this._Values.push(option)},addRange:function(range){this._InitailValue==null&&(this._InitailValue=range);this._Ranges.push(range)},isInRange:function(val64){for(var $t1,val,rng,$t=Bridge.getEnumerator(this._Values);$t.moveNext();)if(val=$t.getCurrent(),!val.getVal().ne(val64))return!0;for($t1=Bridge.getEnumerator(this._Ranges);$t1.moveNext();)if(rng=$t1.getCurrent(),!rng.getMin().gt(val64)&&!rng.getMax().lt(val64))return!0;return!1},getInRangeValue:function(val64){for(var $t1,val,rng,$t=Bridge.getEnumerator(this._Values);$t.moveNext();)if(val=$t.getCurrent(),!val.getVal().ne(val64))return val;for($t1=Bridge.getEnumerator(this._Ranges);$t1.moveNext();)if(rng=$t1.getCurrent(),!rng.getMin().gt(val64)&&!rng.getMax().lt(val64))return new WebMrbc.InRangeValue(rng,val64);return null}});Bridge.define("WebMrbc.BitFiledsValue",{inherits:[WebMrbc.Value],_BitFields:null,_BitFieldValues:null,_Value:System.Int64(0),constructor:function(bitFlds,bitFldVals,value){WebMrbc.Value.prototype.$constructor.call(this);this._BitFields=bitFlds;this._BitFieldValues=bitFldVals;this._Value=value},getDisp:function(){return""},getInitialValue:function(){return this._Value.toString(16).toUpperCase()}});Bridge.define("WebMrbc.CallBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendValueInput("RET").setCheck(null).appendField("呼び出し");this.setInputsInline(!1);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.Collection$1",function(T){return{list:null,onAdd:null,onRemove:null,onReset:null,onChange:null,config:{init:function(){this.list=System.Array.init(0,function(){return Bridge.getDefaultValue(T)})}},getLastModel:function(){var i=this.list.length;return i===0?Bridge.getDefaultValue(T):this.list[i-1|0]},getLength:function(){return this.list.length},add:function(eobject){if(this.list.push(eobject),!Bridge.staticEquals(this.onAdd,null))this.onAdd(this,Object.empty)},remove:function(eobject){var i=Bridge.Linq.Enumerable.from(this.list).indexOf(eobject);if(i>=0&&this.list.splice(i,1),!Bridge.staticEquals(this.onRemove,null))this.onRemove(this,Object.empty)},reset:function(){if(this.list.splice(0,this.list.length),!Bridge.staticEquals(this.onReset,null))this.onReset(this,Object.empty)},reset$1:function(n){if(this.list.splice(0,this.list.length),this.list.concat(n),!Bridge.staticEquals(this.onReset,null))this.onReset(this,Object.empty)},at:function(index){return this.list[index]},uniqueName:function(identifer){for(var prefix=identifer,max=0,n=new RegExp("^"+prefix+"([0-9]+)$"),c,m,$t=Bridge.getEnumerator(this.list);$t.moveNext();){c=$t.getCurrent();m=c.getIdentifer().match(n);m!=null&&(max=Math.max(max,parseInt(m[0])));break}return""+prefix+(max+1|0)},findWhere:function(p){for(var c,$t=Bridge.getEnumerator(this.list);$t.moveNext();)if(c=$t.getCurrent(),function(c){for(var i in p)if(p[i]!==c[i])return!1;return!0}(c))return c;return Bridge.getDefaultValue(T)},each:function(cb){for(var c,$t=Bridge.getEnumerator(this.list);$t.moveNext();)c=$t.getCurrent(),cb(c)}}});Bridge.define("WebMrbc.DelayBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ディレイ");this.appendValueInput("VALUE").setCheck("Number");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.DigitalReadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("デジタルリード").appendField(new Blockly.FieldDropdown([["Pin1","PIN1"],["Pin2","PIN2"],["Pin3","PIN3"]]),"PIN_NO");this.setInputsInline(!0);this.setOutput(!0,"PIN_VALUE");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.DigitalWriteBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("デジタルライト").appendField(new Blockly.FieldDropdown([["Pin1","PIN1"],["Pin2","PIN2"],["Pin3","PIN3"]]),"PIN_NO");this.appendDummyInput().appendField("値").appendField(new Blockly.FieldDropdown([["LOW","PIN_VALUE_LOW"],["HIGH","PIN_VALUE_HIGH"]]),"PIN_VALUE");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.IClassWorkspace",{inherits:[WebMrbc.IModel],$interface:!0});Bridge.define("WebMrbc.EPropertyBlock",{inherits:[WebMrbc.Block],propertyInfo:null,constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput("PROPERTY").appendField(new Blockly.FieldTextInput("onoff_prop"),"IDENTIFER").appendField("動作状態","DESCRIPTION").appendField("EPC:").appendField("80","PROPERTY_CODE").appendField("Size:").appendField("1","PROPERTY_SIZE").appendField("byte");this.appendStatementInput("SET").setCheck("ESetHandler").appendField("設定(prop, src)");this.appendValueInput("SET_RET").setCheck("Number").setAlign(Blockly.ALIGN_RIGHT).appendField("設定に使用したバイト数");this.appendStatementInput("GET").setCheck("EGetHandler").appendField("取得(prop, size)");this.appendValueInput("GET_RET").setCheck("String").setAlign(Blockly.ALIGN_RIGHT).appendField("返すデータ");this.setColour(230);this.setTooltip("");this.setHelpUrl("http://www.example.com/");this.getField("PROPERTY_CODE").EDITABLE=!0},initPropertyInfo:function(workspace){for(var c=workspace.eobject,epc=parseInt(this.getFieldValue("PROPERTY_CODE"),16),item,$t=Bridge.getEnumerator(c.properties);$t.moveNext();)if(item=$t.getCurrent(),item.propertyCode===epc){this.setPropertyInfo(item);break}},setPropertyInfo:function(pi){this.propertyInfo=pi;this.setFieldValue(WebMrbc.CodeGenerator.getPropertyIdentifier(pi),"IDENTIFER");this.setFieldValue(pi.description,"DESCRIPTION");this.setFieldValue(System.Byte.format(pi.propertyCode,"X2"),"PROPERTY_CODE");this.setFieldValue(pi.size.toString(),"PROPERTY_SIZE")},onCreate:function(workspace){this.propertyInfo==null&&this.initPropertyInfo(workspace)},onChange:function(workspace,chg){if(Bridge.referenceEquals(chg.element,"field"))switch(chg.name){case"IDENTIFER":this.propertyInfo.identifer=this.getFieldValue("IDENTIFER");break;case"PROPERTY_CODE":this.initPropertyInfo(workspace)}},onDelete:function(){},onMove:function(){}});Bridge.define("WebMrbc.I2cAvailableBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cの受信バッファ内にあるデータ数を調べる").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cBeginBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cの送信開始準備").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cEndBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cの送信シーケンスを発行する").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.appendDummyInput().appendField("ストップコンディション発生").appendField(new Blockly.FieldCheckbox("TRUE"),"STOP");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cFrequencyBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cの周波数を変更する").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.appendValueInput("FREQUENCY").setCheck("Number").appendField("周波数");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cLreadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cへ受信シーケンスを発行しデータを読み出す").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cLwriteBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cの送信バッファの末尾に数値を追加する").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.appendValueInput("DATA").setCheck("Number").appendField("データ");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cNewBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cの初期化").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cReadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cからの読み込み").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.appendValueInput("ADDRESS_L").setCheck("Number").appendField("下位アドレス");this.appendValueInput("ADDRESS_H").setCheck("Number").appendField("上位アドレス");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cRequestBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cへ受信シーケンスを発行する").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.appendValueInput("ADDRESS").setCheck("Number").appendField("開始アドレス");this.appendValueInput("COUNT").setCheck("Number").appendField("データ数");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.I2cWriteBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("I2Cへの書き込み").appendField(new Blockly.FieldDropdown([["SDA-0/SCL-1","I2C0"],["SDA-5/SCL-6","I2C1"],["SDA-7/SCL-8","I2C2"],["SDA-9(26)/SCL-3","I2C3"]]),"PORT_NO");this.appendValueInput("ADDRESS").setCheck("Number").appendField("アドレス");this.appendValueInput("DATA").setCheck("Number").appendField("データ");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.InitDacBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("アナログDACピン初期化");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.InRangeValue",{inherits:[WebMrbc.Value],_Range:null,_Value:System.Int64(0),constructor:function(range,value){WebMrbc.Value.prototype.$constructor.call(this);this._Range=range;this._Value=value},getRange:function(){return this._Range},getValue:function(){return this._Value},getDisp:function(){return this._Range.getDisp$1(this._Value)},getInitialValue:function(){return this._Value.toString(16).toUpperCase()}});Bridge.define("WebMrbc.JsonNodeInfo",{inherits:[WebMrbc.JsonObjectInfo],objects:null,constructor:function(type,identifer,attribute){WebMrbc.JsonObjectInfo.prototype.$constructor.call(this,type,identifer);this.attribute=attribute;this.objects=System.Array.init(0,null)}});Bridge.define("WebMrbc.JsonPropertyInfo",{inherits:[WebMrbc.JsonFieldInfo],classInfo:null,propertyCode:0,access:null,required:null,constructor:function(){WebMrbc.JsonFieldInfo.prototype.$constructor.call(this)},constructor$1:function(p){WebMrbc.JsonFieldInfo.prototype.$constructor.call(this);this.classInfo=p.classInfo;this.propertyCode=p.propertyCode;this.access=p.access;this.required=p.required;this.description=p.description;this.valueDescription=p.valueDescription;this.unitDescription=p.unitDescription;this.initialValue=p.initialValue;this.type=p.type;this.identifer=p.identifer;this.primitive=p.primitive;this.isArray=p.isArray;this.arrayCount=p.arrayCount;this.size=p.size;this.fields=p.fields}});Bridge.define("WebMrbc.LedBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("LED").appendField(new Blockly.FieldDropdown([["ON","LED_ON"],["OFF","LED_OFF"]]),"SW");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MemFileCloseBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルをクローズします").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MemFileCpBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルをコピーします");this.appendValueInput("SRC_FILENAME").setCheck("String").appendField("コピー元ファイル名");this.appendValueInput("DST_FILENAME").setCheck("String").appendField("コピー先ファイル名");this.appendDummyInput().appendField("モード").appendField(new Blockly.FieldDropdown([["上書きしない","NO_OVERWRITE"],["上書きする","OVERWRITE"]]),"MODE");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MemFileOpenBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルをオープンします").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.appendValueInput("FILENAME").setCheck("String").appendField("ファイル名(8.3形式)");this.appendDummyInput().appendField("モード").appendField(new Blockly.FieldDropdown([["Read","READ"],["Append","APPEND"],["New Create","NEW_CREATE"]]),"MODE");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MemFileReadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルから1バイト読み込みます").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MemFileRmBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルを削除します");this.appendValueInput("FILENAME").setCheck("String").appendField("削除するファイル名");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MemFileSeekBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルの読み出し位置を移動する").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.appendValueInput("POSITION").setCheck("Number").appendField("seekするバイト数");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MemFileWriteBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルにバイナリデータを書き込みます").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.appendValueInput("DATA").setCheck("String").appendField("データ");this.appendValueInput("LENGTH").setCheck("Number").appendField("データサイズ");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MicrosBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("起動してからのマイクロ秒数");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.MillisBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("起動してからのミリ秒数");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.NoToneBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("トーン出力停止").appendField(new Blockly.FieldDropdown([["Pin1","PIN1"],["Pin2","PIN2"],["Pin3","PIN3"]]),"PIN_NO");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.Option",{inherits:[WebMrbc.Value],_Val:System.Int64(0),_Disp:null,constructor:function(val,disp){WebMrbc.Value.prototype.$constructor.call(this);this._Val=val;this._Disp=disp},getVal:function(){return this._Val},getDisp:function(){return this._Disp},getInitialValue:function(){return this._Val.toString(16).toUpperCase()}});Bridge.define("WebMrbc.PinModeBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("PINのモード設定").appendField(new Blockly.FieldDropdown([["Pin1","PIN1"],["Pin2","PIN2"],["Pin3","PIN3"]]),"PIN_NO");this.appendDummyInput().appendField("モード").appendField(new Blockly.FieldDropdown([["INPUT","PIN_MODE_INPUT"],["OUTPUT","PIN_MODE_OUTPUT"]]),"PIN_MODE");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.PwmBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("PWM出力").appendField(new Blockly.FieldDropdown([["Pin1","PIN1"],["Pin2","PIN2"],["Pin3","PIN3"]]),"PIN_NO");this.appendValueInput("PWM_OUT").setCheck("Number").appendField("出力PWM比率");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.RandomBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("乱数を取得");this.appendValueInput("MIN").setCheck("Number").appendField("最小値");this.appendValueInput("MIN").setCheck("Number").appendField("最大値");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.RandomSeedBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("乱数を得るための種を与えます");this.appendValueInput("VALUE").setCheck("Number");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.Range",{inherits:[WebMrbc.Value],_Min:System.Int64(0),_Max:System.Int64(0),_Disp:null,_MinDisp:null,_MaxDisp:null,_Unit:null,_InitialValue:System.Int64(0),constructor:function(min,max,disp){WebMrbc.Value.prototype.$constructor.call(this);this._Min=min;this._Max=max;this._Disp=disp;this._MinDisp="";this._MaxDisp="";this._Unit="";this._InitialValue=min},constructor$1:function(min,max,disp,minDisp,maxDisp,unit){WebMrbc.Value.prototype.$constructor.call(this);this._Min=min;this._Max=max;this._Disp=disp;this._MinDisp=minDisp;this._MaxDisp=maxDisp;this._Unit=unit;this._InitialValue=min},getMin:function(){return this._Min},getMax:function(){return this._Max},getDisp:function(){return this._Disp},getMinDisp:function(){return this._MinDisp},getMaxDisp:function(){return this._MaxDisp},getUnit:function(){return this._Unit},getInitialValue$1:function(){return this._InitialValue},setInitialValue$1:function(value){this._InitialValue=value},getInitialValue:function(){return this._InitialValue.toString(16).toUpperCase()},getDisp$1:function(value){return this._Disp+value.toString()+this._Unit}});Bridge.define("WebMrbc.RtcDeinitBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("RTCを停止します");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.RtcGetTimeBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("RTCの時計を取得します");this.setInputsInline(!0);this.setOutput(!0,"Array");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.RtcInitBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("RTCを起動します");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.RtcSettimeBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("RTCの時計をセットします");this.appendValueInput("DATE").setCheck("Array");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.Ruby",{inherits:[WebMrbc.Generator],ORDER_ATOMIC:0,ORDER_MEMBER:2,ORDER_FUNCTION_CALL:2,ORDER_EXPONENTIATION:3,ORDER_LOGICAL_NOT:4,ORDER_UNARY_SIGN:4,ORDER_BITWISE_NOT:4,ORDER_MULTIPLICATIVE:5,ORDER_ADDITIVE:6,ORDER_BITWISE_SHIFT:7,ORDER_BITWISE_AND:8,ORDER_BITWISE_XOR:9,ORDER_BITWISE_OR:9,ORDER_RELATIONAL:11,ORDER_LOGICAL_AND:13,ORDER_LOGICAL_OR:14,ORDER_CONDITIONAL:15,ORDER_NONE:99,INFINITE_LOOP_TRAP:null,definitions_:null,functionNames_:null,variableDB_:null,escapeChars_:null,config:{init:function(){this.escapeChars_=new System.Collections.Generic.Dictionary$2(String,String)()}},constructor:function(){WebMrbc.Generator.prototype.$constructor.call(this,"Ruby");this.addReservedWords("Class,Object,BEGIN,END,__ENCODING__,__END__,__FILE__,__LINE__alias,and,begin,break,case,class,def,defined?,do,else,elsif,end,ensure,false,for,if,in,module,nextnil,not,or,redo,rescue,retry,return,self,super,then,true,undef,unless,until,when,while,yield");this.escapeChars_.add('"','\\"')},i2c_new:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO");return"$i2c"+dropdown_port_no+" = I2c.new("+dropdown_port_no+")\n"},i2c_write:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_address=Blockly.Ruby.valueToCode(block,"ADDRESS",Blockly.Ruby.ORDER_ATOMIC),value_data=Blockly.Ruby.valueToCode(block,"DATA",Blockly.Ruby.ORDER_ATOMIC);return"$i2c"+dropdown_port_no+".write("+value_address+',"'+value_data+'")\n'},i2c_read:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_address_l=Blockly.Ruby.valueToCode(block,"ADDRESS_L",Blockly.Ruby.ORDER_ATOMIC),value_address_h=Blockly.Ruby.valueToCode(block,"ADDRESS_H",Blockly.Ruby.ORDER_ATOMIC),code;return code=value_address_h==null?"$i2c"+dropdown_port_no+".read("+value_address_l+")":"$i2c"+dropdown_port_no+".read("+value_address_l+","+value_address_h+")",[code,Blockly.Ruby.ORDER_ATOMIC]},i2c_begin:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO");return"$i2c"+dropdown_port_no+".begin()\n"},i2c_lwrite:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_data=Blockly.Ruby.valueToCode(block,"DATA",Blockly.Ruby.ORDER_ATOMIC),code="$i2c"+dropdown_port_no+".lwrite("+value_data+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},i2c_end:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),checkbox_stop=Bridge.referenceEquals(block.getFieldValue("STOP"),"TRUE"),code="$i2c"+dropdown_port_no+".lwrite("+checkbox_stop+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},i2c_request:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_address=Blockly.Ruby.valueToCode(block,"ADDRESS",Blockly.Ruby.ORDER_ATOMIC),value_count=Blockly.Ruby.valueToCode(block,"COUNT",Blockly.Ruby.ORDER_ATOMIC),code="$i2c"+dropdown_port_no+".request("+value_address+","+value_count+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},i2c_lread:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),code="$i2c"+dropdown_port_no+".lread()";return[code,Blockly.Ruby.ORDER_ATOMIC]},i2c_available:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),code="$i2c"+dropdown_port_no+".available()";return[code,Blockly.Ruby.ORDER_ATOMIC]},i2c_frequency:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_frequency=Blockly.Ruby.valueToCode(block,"FREQUENCY",Blockly.Ruby.ORDER_ATOMIC);return"$i2c"+dropdown_port_no+".frequency("+value_frequency+")\n"},call:function(block){var value_name=Blockly.Ruby.valueToCode(block,"RET",Blockly.Ruby.ORDER_ATOMIC);return value_name+"\n"},pin_mode:function(block){var dropdown_pin_no=block.getFieldValue("PIN_NO"),dropdown_pin_mode=block.getFieldValue("PIN_MODE");return"pinMode("+dropdown_pin_no+","+dropdown_pin_mode+")\n"},digital_write:function(block){var dropdown_pin_no=block.getFieldValue("PIN_NO"),dropdown_pin_value=block.getFieldValue("PIN_VALUE");return"digitalWrite("+dropdown_pin_no+","+dropdown_pin_value+")\n"},digital_read:function(block){var dropdown_pin_no=block.getFieldValue("PIN_NO"),code="digitalRead("+dropdown_pin_no+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},analog_read:function(block){var dropdown_pin_no=block.getFieldValue("PIN_NO"),code="analogRead("+dropdown_pin_no+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},pwm:function(block){var dropdown_pin_no=block.getFieldValue("PIN_NO"),value_pwm_out=Blockly.Ruby.valueToCode(block,"PWM_OUT",Blockly.Ruby.ORDER_ATOMIC);return"pwm("+dropdown_pin_no+","+value_pwm_out+")\n"},analog_reference:function(block){var dropdown_analog_reference_mode=block.getFieldValue("ANALOG_REFERENCE_MODE");return"analogReference("+dropdown_analog_reference_mode+")\n"},init_dac:function(){return"initDac()\n"},analog_dac:function(block){var value_value=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_ATOMIC);return"analogDac("+value_value+")\n"},delay:function(block){var value_value=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_ATOMIC);return"delay("+value_value+")\n"},millis:function(){return["millis()",Blockly.Ruby.ORDER_ATOMIC]},micros:function(){return["micros()",Blockly.Ruby.ORDER_ATOMIC]},led:function(block){var dropdown_sw=block.getFieldValue("SW");return"led("+dropdown_sw+")\n"},tone:function(block){var dropdown_pin_no=block.getFieldValue("PIN_NO"),value_frequency=Blockly.Ruby.valueToCode(block,"FREQUENCY",Blockly.Ruby.ORDER_ATOMIC),value_duration=Blockly.Ruby.valueToCode(block,"DURATION",Blockly.Ruby.ORDER_ATOMIC);return"tone("+dropdown_pin_no+","+value_frequency+","+value_duration+")\n"},no_tone:function(block){var dropdown_pin_no=block.getFieldValue("PIN_NO");return"noTone("+dropdown_pin_no+")\n"},random_seed:function(block){var value_name=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_ATOMIC);return"randomSeed("+value_name+")\n"},random:function(block){var value_min=Blockly.Ruby.valueToCode(block,"MIN",Blockly.Ruby.ORDER_ATOMIC),value_max=Blockly.Ruby.valueToCode(block,"MAX",Blockly.Ruby.ORDER_ATOMIC),code="random("+value_min+","+value_max+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},memfile_open:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),value_filename=Blockly.Ruby.valueToCode(block,"FILENAME",Blockly.Ruby.ORDER_ATOMIC),dropdown_mode=block.getFieldValue("MODE");return"MemFile.open("+dropdown_file_no+","+value_filename+","+dropdown_mode+")\n"},memfile_close:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO");return"MemFile.close("+dropdown_file_no+")\n"},memfile_read:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),code="MemFile.read("+dropdown_file_no+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},memfile_write:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),value_data=Blockly.Ruby.valueToCode(block,"DATA",Blockly.Ruby.ORDER_ATOMIC),value_length=Blockly.Ruby.valueToCode(block,"LENGTH",Blockly.Ruby.ORDER_ATOMIC),code="MemFile.write("+dropdown_file_no+","+value_data+","+value_length+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},memfile_seek:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),value_position=Blockly.Ruby.valueToCode(block,"POSITION",Blockly.Ruby.ORDER_ATOMIC),code="MemFile.seek("+dropdown_file_no+","+value_position+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},memfile_cp:function(block){var value_src_filename=Blockly.Ruby.valueToCode(block,"SRC_FILENAME",Blockly.Ruby.ORDER_ATOMIC),value_dst_filename=Blockly.Ruby.valueToCode(block,"DST_FILENAME",Blockly.Ruby.ORDER_ATOMIC),dropdown_mode=block.getFieldValue("MODE"),code="MemFile.cp("+value_dst_filename+","+value_dst_filename+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},memfile_rm:function(block){var value_filename=Blockly.Ruby.valueToCode(block,"FILENAME",Blockly.Ruby.ORDER_ATOMIC),code="MemFile.rm("+value_filename+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},rtc_gettime:function(){return["Rtc.getTime()",Blockly.Ruby.ORDER_ATOMIC]},rtc_settime:function(block){var value_date=Blockly.Ruby.valueToCode(block,"DATE",Blockly.Ruby.ORDER_ATOMIC),code="Rtc.setTime("+value_date+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},rtc_deinit:function(){return["Rtc.deinit()",Blockly.Ruby.ORDER_ATOMIC]},rtc_init:function(){return["Rtc.init()",Blockly.Ruby.ORDER_ATOMIC]},sd_exists:function(block){var value_filename=Blockly.Ruby.valueToCode(block,"FILENAME",Blockly.Ruby.ORDER_ATOMIC),code="SD.exists("+value_filename+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_mkdir:function(block){var value_filename=Blockly.Ruby.valueToCode(block,"FILENAME",Blockly.Ruby.ORDER_ATOMIC),code="SD.mkdir("+value_filename+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_remove:function(block){var value_filename=Blockly.Ruby.valueToCode(block,"FILENAME",Blockly.Ruby.ORDER_ATOMIC),code="SD.remove("+value_filename+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_copy:function(block){var value_src_filename=Blockly.Ruby.valueToCode(block,"SRC_FILENAME",Blockly.Ruby.ORDER_ATOMIC),value_dst_filename=Blockly.Ruby.valueToCode(block,"DST_FILENAME",Blockly.Ruby.ORDER_ATOMIC),code="SD.copy("+value_src_filename+","+value_dst_filename+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_rmdir:function(block){var value_filename=Blockly.Ruby.valueToCode(block,"FILENAME",Blockly.Ruby.ORDER_ATOMIC),code="SD.rmdir("+value_filename+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_open:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),value_filename=Blockly.Ruby.valueToCode(block,"FILENAME",Blockly.Ruby.ORDER_ATOMIC),dropdown_mode=block.getFieldValue("MODE"),code="SD.open("+dropdown_file_no+","+value_filename+","+dropdown_mode+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_close:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),code="SD.close("+dropdown_file_no+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_read:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),code="SD.read("+dropdown_file_no+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_seek:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),value_position=Blockly.Ruby.valueToCode(block,"POSITION",Blockly.Ruby.ORDER_ATOMIC),code="SD.seek("+dropdown_file_no+","+value_position+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_write:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),value_data=Blockly.Ruby.valueToCode(block,"DATA",Blockly.Ruby.ORDER_ATOMIC),value_length=Blockly.Ruby.valueToCode(block,"LENGTH",Blockly.Ruby.ORDER_ATOMIC),code="SD.write("+dropdown_file_no+","+value_data+","+value_length+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_flush:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO");return"SD.flush("+dropdown_file_no+")\n"},sd_size:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),code="SD.size("+dropdown_file_no+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},sd_position:function(block){var dropdown_file_no=block.getFieldValue("FILE_NO"),code="SD.position("+dropdown_file_no+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},serial_new:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_bps=Blockly.Ruby.valueToCode(block,"BPS",Blockly.Ruby.ORDER_ATOMIC),code="$Serial"+dropdown_port_no+" = Serial.new("+dropdown_port_no+","+value_bps+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},serial_bps:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_bps=Blockly.Ruby.valueToCode(block,"BPS",Blockly.Ruby.ORDER_ATOMIC);return"$Serial"+dropdown_port_no+".bps("+value_bps+")\n"},serial_print:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_str=Blockly.Ruby.valueToCode(block,"STR",Blockly.Ruby.ORDER_ATOMIC);return"$Serial"+dropdown_port_no+".print("+value_str+")\n"},serial_println:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_str=Blockly.Ruby.valueToCode(block,"STR",Blockly.Ruby.ORDER_ATOMIC);return"$Serial"+dropdown_port_no+".println("+value_str+")\n"},serial_available:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),code="$Serial"+dropdown_port_no+".available()";return[code,Blockly.Ruby.ORDER_ATOMIC]},serial_read:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),code="$Serial"+dropdown_port_no+".read()";return[code,Blockly.Ruby.ORDER_ATOMIC]},serial_write:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO"),value_data=Blockly.Ruby.valueToCode(block,"DATA",Blockly.Ruby.ORDER_ATOMIC),value_length=Blockly.Ruby.valueToCode(block,"LENGTH",Blockly.Ruby.ORDER_ATOMIC),code="$Serial"+dropdown_port_no+".bps("+value_data+","+value_length+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},serial_flash:function(block){var dropdown_port_no=block.getFieldValue("PORT_NO");return"$Serial"+dropdown_port_no+".flash()\n"},servo_attach:function(block){var number_ch=block.getFieldValue("CH"),dropdown_pin_no=block.getFieldValue("PIN_NO"),text_min=block.getFieldValue("MIN"),text_max=block.getFieldValue("MAX");return"Servo.attach("+number_ch+","+dropdown_pin_no+","+text_min+","+text_max+")\n"},servo_write:function(block){var number_ch=block.getFieldValue("CH"),value_angle=Blockly.Ruby.valueToCode(block,"ANGLE",Blockly.Ruby.ORDER_ATOMIC);return"Servo.write("+number_ch+","+value_angle+")\n"},servo_us:function(block){var number_ch=block.getFieldValue("CH"),value_us=Blockly.Ruby.valueToCode(block,"US",Blockly.Ruby.ORDER_ATOMIC);return"Servo.us("+number_ch+","+value_us+")\n"},servo_read:function(block){var number_ch=block.getFieldValue("CH"),code="Servo.read("+number_ch+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},servo_attached:function(block){var number_ch=block.getFieldValue("CH"),code="Servo.attached("+number_ch+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},servo_detach:function(block){var number_ch=block.getFieldValue("CH");return"Servo.detach("+number_ch+")\n"},system_exit:function(){return"System.exit()\n"},system_setrun:function(block){var value_filename=Blockly.Ruby.valueToCode(block,"FILENAME",Blockly.Ruby.ORDER_ATOMIC);return"System.setrun("+value_filename+")\n"},system_version:function(){return["System.version()",Blockly.Ruby.ORDER_ATOMIC]},system_push:function(block){var value_address=Blockly.Ruby.valueToCode(block,"ADDRESS",Blockly.Ruby.ORDER_ATOMIC),value_data=Blockly.Ruby.valueToCode(block,"DATA",Blockly.Ruby.ORDER_ATOMIC),value_length=Blockly.Ruby.valueToCode(block,"LENGTH",Blockly.Ruby.ORDER_ATOMIC);return"System.push("+value_address+","+value_data+","+value_length+")\n"},system_pop:function(block){var value_address=Blockly.Ruby.valueToCode(block,"ADDRESS",Blockly.Ruby.ORDER_ATOMIC),value_length=Blockly.Ruby.valueToCode(block,"LENGTH",Blockly.Ruby.ORDER_ATOMIC),code="System.pop("+value_address+","+value_length+")";return[code,Blockly.Ruby.ORDER_ATOMIC]},system_fileload:function(){return"System.fileload()\n"},system_reset:function(){return"System.reset()\n"},system_use_sd:function(){return["System.useSD()",Blockly.Ruby.ORDER_ATOMIC]},system_use_wifi:function(){return["System.useWiFi()",Blockly.Ruby.ORDER_ATOMIC]},system_get_mrb_path:function(){return["System.getMrbPath()",Blockly.Ruby.ORDER_ATOMIC]},defineSvcTask:function(workspace,localNode){for(var block,name,wa,sb,o,o1,line,$t,$t1,code=Blockly.Ruby.workspaceToCode(workspace.workspace),identifer=workspace.getIdentifer(),funcs=System.Array.init(0,null),blocks=Blockly.mainWorkspace.getTopBlocks(!0),i=0;i<blocks.length;i=i+1|0){block=blocks[i];switch(block.type){case"procedures_defnoreturn":name=block.getFieldValue("NAME");switch(name){case"setup":case"recv_esv":case"break_wait":case"timeout":case"snd_msg":funcs.push(name)}break;case"procedures_defreturn":name=block.getFieldValue("NAME");switch(name){case"is_local_addr":case"is_multicast_addr":case"is_valid_addrid":case"get_local_addr":case"get_multicast_addr":case"get_remote_addr":case"get_remote_id":case"set_remote_addr":case"add_remote_addr":funcs.push(name)}}}wa=new WebMrbc.CodeGenWorkArea;sb=new System.Text.StringBuilder;sb.appendLine("class "+identifer+" ECNL::SvcTask");sb.appendLine("\tdef initialize()");sb.appendLine("\t\t@profile = "+localNode.identifer+".new("+localNode.instanceCode+")");switch(localNode.objects.length){case 0:sb.appendLine("\t\t@devices = []");break;case 1:o=localNode.objects[0];sb.appendLine("\t\t@devices = [ "+o.identifer+".new("+o.instanceCode+", @profile) ]");break;default:for(sb.appendLine("\t\t@devices = ["),$t=Bridge.getEnumerator(localNode.objects);$t.moveNext();)o1=$t.getCurrent(),sb.appendLine("\t\t\t"+o1.identifer+".new("+o1.instanceCode+", @profile) ]");sb.appendLine("\t\t]")}for(sb.appendLine("\t\t@enodadrb_table = []"),sb.appendLine(),sb.appendLine("\t\tsuper()"),System.Linq.Enumerable.from(funcs).contains("setup")&&(sb.appendLine(),sb.appendLine("\t\tsetup()")),sb.appendLine("\tend"),sb.appendLine(),$t1=Bridge.getEnumerator(code.split("\n"));$t1.moveNext();)line=$t1.getCurrent(),sb.appendLine("\t"+line);return sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("recv_esv")||(sb.appendLine("\tdef recv_esv(esv)"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("break_wait")||(sb.appendLine("\tdef break_wait(data)"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("timeout")||(sb.appendLine("\tdef timeout()"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("snd_msg")||(sb.appendLine("\tdef snd_msg(ep, data)"),sb.appendLine("\t\t# 通信レイヤーへ送信"),sb.appendLine("\t\tTargetBoard::snd_msg(ep, data)"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("is_local_addr")||(sb.appendLine("\tdef is_local_addr(ep)"),sb.appendLine("\t\tTargetBoard::is_local_addr(ep)"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("is_multicast_addr")||(sb.appendLine("\tdef is_multicast_addr(ep)"),sb.appendLine("\t\tTargetBoard::is_multicast_addr(ep)"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("is_valid_addrid")||(sb.appendLine("\tdef is_valid_addrid(id)"),sb.appendLine("\t\t(id >= 0) && ((id - ECNL::ENOD_REMOTE_ID) < @enodadrb_table.length)"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("get_local_addr")||(sb.appendLine("\tdef get_local_addr()"),sb.appendLine("\t\tTargetBoard::get_local_addr()"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("get_multicast_addr")||(sb.appendLine("\tdef get_multicast_addr()"),sb.appendLine("\t\tTargetBoard::get_multicast_addr()"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("get_remote_addr")||(sb.appendLine("\tdef get_remote_addr(id)"),sb.appendLine("\t\tindex = id - ECNL::ENOD_REMOTE_ID"),sb.appendLine("\t\tif (index < 0) || (index >= @enodadrb_table.length)"),sb.appendLine("\t\t\tnil"),sb.appendLine("\t\telse"),sb.appendLine("\t\t\t@enodadrb_table[index]"),sb.appendLine("\t\tend"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("get_remote_id")||(sb.appendLine("\t# 通信レイヤーアドレスの同じものを検索"),sb.appendLine("\tdef get_remote_id(ep)"),sb.appendLine("\t\tid = ECNL::ENOD_REMOTE_ID - 1"),sb.appendLine("\t\tfor ea in @enodadrb_table do"),sb.appendLine("\t\t\tid += 1"),sb.appendLine("\t\t\tif !ea then"),sb.appendLine("\t\t\t\tnext"),sb.appendLine("\t\t\tend"),sb.appendLine("\t\t\tif !TargetBoard::equals_addr(ea, ep) then"),sb.appendLine("\t\t\t\tnext"),sb.appendLine("\t\t\tend"),sb.appendLine(),sb.appendLine("\t\t\treturn id"),sb.appendLine("\t\tend"),sb.appendLine(),sb.appendLine("\t\treturn ECNL::ENOD_NOT_MATCH_ID"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("set_remote_addr")||(sb.appendLine("\t# 対応するリモートノードを検索"),sb.appendLine("\tdef set_remote_addr(edata, ep)"),sb.appendLine("\t\tid = ECNL::ENOD_REMOTE_ID - 1"),sb.appendLine("\t\tfor ea in @enodadrb_table do"),sb.appendLine("\t\t\tid += 1"),sb.appendLine("\t\t\tif !ea then"),sb.appendLine("\t\t\t\tnext"),sb.appendLine("\t\t\tend"),sb.appendLine("\t\t\tif !is_match(svc, edata, ep) then"),sb.appendLine("\t\t\t\tnext"),sb.appendLine("\t\t\tend"),sb.appendLine(),sb.appendLine("\t\t\t# 対応するリモートノードがあれば通信レイヤーアドレスを設定"),sb.appendLine("\t\t\t@enodadrb_table[id - ECNL::ENOD_REMOTE_ID] = ep"),sb.appendLine(),sb.appendLine("\t\t\treturn id"),sb.appendLine("\t\tend"),sb.appendLine(),sb.appendLine("\t\treturn ECNL::ENOD_NOT_MATCH_ID"),sb.appendLine("\tend")),sb.appendLine(),System.Linq.Enumerable.from(funcs).contains("add_remote_addr")||(sb.appendLine("\t# 空き領域を探して自動登録"),sb.appendLine("\tdef add_remote_addr(edata, ep)"),sb.appendLine("\t\tid = ECNL::ENOD_REMOTE_ID - 1"),sb.appendLine("\t\tfor ea in @enodadrb_table do"),sb.appendLine("\t\t\tid += 1"),sb.appendLine("\t\t\tif ea then"),sb.appendLine("\t\t\t\tnext"),sb.appendLine("\t\t\tend"),sb.appendLine(),sb.appendLine("\t\t\t@enodadrb_table[id - ECNL::ENOD_REMOTE_ID] = ep"),sb.appendLine(),sb.appendLine("\t\t\treturn id"),sb.appendLine("\t\tend"),sb.appendLine(),sb.appendLine("\t\tif @enodadrb_table.length >= 100 then"),sb.appendLine("\t\t\treturn ECNL::ENOD_NOT_MATCH_ID"),sb.appendLine("\t\tend"),sb.appendLine(),sb.appendLine("\t\tid = @enodadrb_table.length;"),sb.appendLine("\t\t@enodadrb_table[id] = ep"),sb.appendLine(),sb.appendLine("\t\treturn id + ECNL::ENOD_REMOTE_ID"),sb.appendLine("\tend"),sb.appendLine("end"),code=sb.toString()),code},itr_code:function(){var sb=new System.Text.StringBuilder;return sb.appendLine("itr = esv.itr_ini()"),sb.appendLine("itr.itr_nxt()"),sb.appendLine("until itr.is_eof do"),sb.appendLine("\tif itr.epc == 0xD6 then"),sb.appendLine("\t\t# LEDをON"),sb.appendLine("\t\tdigitalWrite(2, 1)"),sb.appendLine("\tend"),sb.appendLine("\titr.itr_nxt()"),sb.appendLine("end"),sb.toString()},init_smalruby:function(){this.definitions_.set("receiver_stack",["main"]);this.definitions_.set("eobject_stack",System.Array.init(0,null))},defineENode:function(enode,workspace){var code=Blockly.Ruby.workspaceToCode(workspace),identifer=enode.identifer,blockName="enode_"+identifer;if(!Blockly.Ruby.definitions_.containsKey(blockName)){var wa=new WebMrbc.CodeGenWorkArea,cg=new WebMrbc.CodeGenerator(enode),sb=new System.Text.StringBuilder;sb.appendLine("class "+identifer+" < ECNL::ENode");sb.appendLine("\tdef initialize(eojx3)");sb.append(cg.defineEchonetObject("\t\t"));sb.appendLine();sb.append(cg.configEchonetObject("\t\t"));sb.appendLine();sb.appendLine("\t\tsuper(eojx3, eprpinib_table)");sb.appendLine("\tend");sb.appendLine();sb.append(code);sb.appendLine("end");code=sb.toString();Blockly.Ruby.definitions_.set(blockName,code)}return code},defineEObject:function(eobject,workspace){var code=Blockly.Ruby.workspaceToCode(workspace),identifer=eobject.identifer,wa=new WebMrbc.CodeGenWorkArea,cg=new WebMrbc.CodeGenerator(eobject),sb=new System.Text.StringBuilder;return sb.appendLine("class "+identifer+" < ECNL::EObject"),sb.appendLine("\tdef initialize(eojx3, enod)"),sb.append(cg.defineEchonetObject("\t\t")),sb.appendLine(),sb.append(cg.configEchonetObject("\t\t")),sb.appendLine(),sb.appendLine("\t\tsuper("+eobject.type.classGroup.classGroupCode+", "+eobject.type.classCode+", eojx3, enod, eprpinib_table)"),sb.appendLine("\tend"),sb.appendLine(),sb.append(code),sb.appendLine("end"),sb.toString()},eobjectStack:function(){return Bridge.cast(this.definitions_.get("eobject_stack"),Array)},eobject:function(){var t=this.eobjectStack();return t.length===0?null:t[t.length-1|0]},receiverStack:function(){return Bridge.cast(this.definitions_.get("receiver_stack"),Array)},receiver:function(){var t=this.receiverStack();return t.length===0?null:t[t.length-1|0]},receiverName:function(options){var opts,o,r;options===void 0&&(options=null);options==null&&(options=new $_.$AnonymousType$5);opts=new $_.$AnonymousType$6(this.eobject(),!0);for(o in options)opts[o]=options[o];return r=this.receiver(),Bridge.referenceEquals(r,opts.object)?opts.dropSelf?"":"self.":opts.object.identifer+"."},eobjectMethodCall_:function(method,args,options){options===void 0&&(options=null);var res=this.eobjectMethodCallInput_(method,args,options);return res[0]!=null?res[0]+"\n":""},eobjectMethodCallInput_:function(method,args,options){options===void 0&&(options=null);var code;return code=this.eobject()!=null?args!=null&&args.length>0?this.receiverName(options)+method+"("+args+")":this.receiverName(options)+method:null,[code,this.ORDER_FUNCTION_CALL]},eobjectSetVariable_:function(name,val,operator){return operator===void 0&&(operator="="),this.eobject()!=null?this.receiverName(new $_.$AnonymousType$7(!1))+name+operator+" "+val+"\n":""},eobjectEvent_:function(block,bodyName,name,arg){arg===void 0&&(arg=null);var c,body;if((c=this.eobject())!=null){this.receiverStack().push(c);try{body=this.statementToCode(block,bodyName);System.String.isNullOrEmpty(body)&&(body="\n")}finally{this.receiverStack().pop()}return arg=arg!=null?", "+arg:"","\n"+this.receiverName(new $_.$AnonymousType$5)+"on(:"+name+arg+") do\n"+body+"end\n"}return""},eproperty_new:function(block){var $t,$t1,text_identifer=block.getFieldValue("IDENTIFER"),value_description=block.getFieldValue("DESCRIPTION"),value_property_code=block.getFieldValue("PROPERTY_CODE"),value_property_size=block.getFieldValue("PROPERTY_SIZE"),statements_set=Blockly.Ruby.statementToCode(block,"SET"),value_set_ret=Blockly.Ruby.valueToCode(block,"SET_RET",Blockly.Ruby.ORDER_ATOMIC),statements_get=Blockly.Ruby.statementToCode(block,"GET"),value_get_ret=Blockly.Ruby.valueToCode(block,"GET_RET",Blockly.Ruby.ORDER_ATOMIC),code=new System.Text.StringBuilder,indent="\t",line,line1;for(code.appendLine(indent+System.String.format("# {0}設定関数",value_description)),code.appendLine(indent+"def "+text_identifer+"_set(prop, src)"),indent+="\t",$t=Bridge.getEnumerator(statements_set.split(String.fromCharCode(10)));$t.moveNext();)line=$t.getCurrent(),code.appendLine(indent+line);for(code.appendLine(indent+"return "+value_set_ret),indent=indent.substr(0,indent.length-1|0),code.appendLine(indent+"end"),code.appendLine(),code.appendLine(indent+System.String.format("# {0}取得関数",value_description)),code.appendLine(indent+"def "+text_identifer+"_get(prop, size)"),indent+="\t",$t1=Bridge.getEnumerator(statements_get.split(String.fromCharCode(10)));$t1.moveNext();)line1=$t1.getCurrent(),code.appendLine(indent+line1);return code.appendLine(indent+"return "+value_get_ret),indent=indent.substr(0,indent.length-1|0),code.appendLine(indent+"end"),code.appendLine(),code.toString()},defineMainLoop:function(workspace){var code=Blockly.Ruby.workspaceToCode(workspace.workspace),sb=new System.Text.StringBuilder;return sb.append(code),sb.appendLine(),sb.appendLine("ctrl = Controller.new()"),sb.appendLine(),sb.appendLine("# メインループ"),sb.appendLine("while (true) do"),sb.appendLine("\t# メッセージ待ち"),sb.appendLine("\tret = TargetBoard::wait_msg(ctrl.timer)"),sb.appendLine("\tif !ret then"),sb.appendLine("\t\tbreak;"),sb.appendLine("\tend"),sb.appendLine(),sb.appendLine("\t# 経過時間の計算"),sb.appendLine("\tctrl.progress ret[0]"),sb.appendLine(),sb.appendLine("\t# 戻り値が２つなら"),sb.appendLine("\tif ret.length == 2 then"),sb.appendLine("\t\t# 内部イベント"),sb.appendLine("\t\tcase (ret[1])"),sb.appendLine("\t\twhen 1 then"),sb.appendLine("\t\t\tTargetBoard::restart"),sb.appendLine("\t\twhen 2 then"),sb.appendLine("\t\t\tctrl.ntf_inl"),sb.appendLine("\t\tend"),sb.appendLine("\t# 戻り値が３つなら"),sb.appendLine("\telsif ret.length == 3 then"),sb.appendLine("\t\t# 通信レイヤーからのメッセージ（通信端点と電文）"),sb.appendLine("\t\tctrl.recv_msg(ret[1], ret[2])"),sb.appendLine("\tend"),sb.appendLine(),sb.appendLine("\t# タイムアウトの処理があれば行う"),sb.appendLine("\tctrl.call_timeout"),sb.appendLine("end"),sb.toString()},functionNamePlaceholder:function(){return this.FUNCTION_NAME_PLACEHOLDER_},reservedWords:function(){return this.RESERVED_WORDS_},init:function(workspace){var defvars,variables,x,code;if(Blockly.Ruby.definitions_=new System.Collections.Generic.Dictionary$2(String,Object)(),Blockly.Ruby.functionNames_=new System.Collections.Generic.Dictionary$2(String,String)(),Blockly.Variables!=null){for(Blockly.Ruby.variableDB_==null?(Blockly.Ruby.variableDB_=new Blockly.Names(Blockly.Ruby.reservedWords()),Blockly.Ruby.variableDB_.localVars=null,this.variableDB_.localVarsDB=null,Blockly.Ruby.variableDB_.getRubyName=$_.WebMrbc.Ruby.f1,Blockly.Ruby.variableDB_.pushScope=$_.WebMrbc.Ruby.f2,Blockly.Ruby.variableDB_.addLocalVariable=Bridge.fn.bind(this,$_.WebMrbc.Ruby.f3),Blockly.Ruby.variableDB_.popScope=Bridge.fn.bind(this,$_.WebMrbc.Ruby.f4)):Blockly.Ruby.variableDB_.reset(),defvars=System.Array.init(0,null),variables=Blockly.Variables.allVariables(workspace),x=0;x<variables.length;x=x+1|0)defvars.push("@"+Blockly.Ruby.variableDB_.getName(variables[x],Blockly.Variables.NAME_TYPE)+" = nil");code=defvars.join("\n");this.definitions_.set("variables",code)}this.init_smalruby(workspace)},validName:function(name){return this.variableDB_.safeName_(name)},generateDefinitions:function(helpers){for(var requires=System.Array.init(0,null),prepares=System.Array.init(0,null),definitions=System.Array.init(0,null),name,def,allDefs,$t=Bridge.getEnumerator(this.definitions_.getKeys());$t.moveNext();)(name=$t.getCurrent(),def=this.definitions_.get(name),Bridge.referenceEquals(Bridge.getType(def),String))&&(name.match(new RegExp("^require__"))!=null?requires.push(def):name.match(new RegExp("^prepare__"))!=null?prepares.push(def):definitions.push(def));return allDefs="",requires.length>0&&(allDefs+=requires.join("\n")+"\n\n"),helpers.length>0&&(allDefs+=helpers.join("\n")+"\n\n"),prepares.length>0&&(allDefs+=prepares.join("\n")+"\n\n"),definitions.length>0&&(allDefs+=definitions.join("\n").replace(new RegExp("\n\n+","g"),"\n\n").replace(new RegExp("\n*$"),"\n")),allDefs},finish:function(code){var helpers=System.Array.init(0,null),allDefs=this.generateDefinitions(helpers);return allDefs.replace(new RegExp("\n\n+","g"),"\n\n").replace(new RegExp("\n*$"),"\n\n\n")+code},scrubNakedValue:function(line){return line+"\n"},quote_:function(str){for(var ch,rch,s=str.toString(),sb=['"'],i=0;i<s.length;i=i+1|0)ch=s.charAt(i),rch={},Blockly.Ruby.escapeChars_.tryGetValue(ch,rch)||(rch.v=ch),sb[i+1|0]=rch.v;return sb.push('"'),sb.join("")},scrub_:function(block,code){var commentCode,comment,x,childBlock,nextBlock,nextCode;if(code==null)return"";if(commentCode="",block.outputConnection==null||block.outputConnection.targetConnection==null)for(comment=block.getCommentText(),System.String.isNullOrEmpty(comment)||(commentCode+=this.prefixLines(comment,"# ")+"\n"),x=0;x<block.inputList.length;x=x+1|0)block.inputList[x].type===Blockly.INPUT_VALUE&&(childBlock=block.inputList[x].connection.targetBlock(),childBlock!=null&&(comment=this.allNestedComments(childBlock),System.String.isNullOrEmpty(comment)||(commentCode+=this.prefixLines(comment,"# "))));return nextBlock=null,block.nextConnection!=null&&(nextBlock=block.nextConnection.targetBlock()),nextCode=this.blockToCode(nextBlock),commentCode+code+nextCode},colour_picker:function(block){var code="'"+block.getFieldValue("COLOUR")+"'";return[code,this.ORDER_ATOMIC]},colour_random:function(){return["'#%06x' % rand(2**24 - 1)",this.ORDER_FUNCTION_CALL]},colour_rgb:function(block){var functionName=Blockly.Ruby.provideFunction_("colour_rgb",["def "+Blockly.Ruby.functionNamePlaceholder()+"(r, g, b)","  r = (2.55 * [100, [0, r].max].min).round","  g = (2.55 * [100, [0, g].max].min).round","  b = (2.55 * [100, [0, b].max].min).round","  '#%02x%02x%02x' % [r, g, b]","end"]),r=Blockly.Ruby.valueToCode(block,"RED",Blockly.Ruby.ORDER_NONE),g,b,code;return System.String.isNullOrEmpty(r)&&(r="0"),g=Blockly.Ruby.valueToCode(block,"GREEN",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(g)&&(g="0"),b=Blockly.Ruby.valueToCode(block,"BLUE",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(b)&&(b="0"),code=functionName+"("+r+", "+g+", "+b+")",[code,this.ORDER_FUNCTION_CALL]},colour_blend:function(block){var functionName=Blockly.Ruby.provideFunction_("colour_blend",["def "+Blockly.Ruby.functionNamePlaceholder()+"(colour1, colour2, ratio) ","  _, r1, g1, b1 = colour1.unpack('A1A2A2A2').map {|x| x.to_i(16)}","  _, r2, g2, b2 = colour2.unpack('A1A2A2A2').map {|x| x.to_i(16)}","  ratio = [1, [0, ratio].max].min","  r = (r1 * (1 - ratio) + r2 * ratio).round","  g = (g1 * (1 - ratio) + g2 * ratio).round","  b = (b1 * (1 - ratio) + b2 * ratio).round","  '#%02x%02x%02x' % [r, g, b]","end"]),colour1=Blockly.Ruby.valueToCode(block,"COLOUR1",Blockly.Ruby.ORDER_NONE),colour2,ratio,code;return System.String.isNullOrEmpty(colour1)&&(colour1="'#000000'"),colour2=Blockly.Ruby.valueToCode(block,"COLOUR2",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(colour2)&&(colour2="'#000000'"),ratio=Blockly.Ruby.valueToCode(block,"RATIO",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(ratio)&&(ratio="0"),code=functionName+"("+colour1+", "+colour2+", "+ratio+")",[code,this.ORDER_FUNCTION_CALL]},lists_create_empty:function(){return["[]",this.ORDER_ATOMIC]},lists_create_with:function(block){for(var _code,code=System.Array.init(block.itemCount_,null),n=0;n<block.itemCount_;n=n+1|0)code[n]=Blockly.Ruby.valueToCode(block,"ADD"+n,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(code[n])&&(code[n]="None");return _code="["+code.join(", ")+"]",[_code,this.ORDER_ATOMIC]},lists_repeat:function(block){var argument0=Blockly.Ruby.valueToCode(block,"ITEM",Blockly.Ruby.ORDER_NONE),argument1,code;return System.String.isNullOrEmpty(argument0)&&(argument0="None"),argument1=Blockly.Ruby.valueToCode(block,"NUM",Blockly.Ruby.ORDER_MULTIPLICATIVE),System.String.isNullOrEmpty(argument1)&&(argument1="0"),code="["+argument0+"] * "+argument1,[code,this.ORDER_MULTIPLICATIVE]},lists_length:function(block){var argument0=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_NONE);return System.String.isNullOrEmpty(argument0)&&(argument0="[]"),[argument0+".length",this.ORDER_FUNCTION_CALL]},lists_isEmpty:function(block){var argument0=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_NONE),code;return System.String.isNullOrEmpty(argument0)&&(argument0="[]"),code=argument0+".empty?",[code,this.ORDER_LOGICAL_NOT]},lists_indexOf:function(block){var search=Blockly.Ruby.valueToCode(block,"FIND",Blockly.Ruby.ORDER_NONE),list,finder,code;return System.String.isNullOrEmpty(search)&&(search="[]"),list=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_MEMBER),System.String.isNullOrEmpty(list)&&(list="''"),finder=Bridge.referenceEquals(block.getFieldValue("END"),"FIRST")?".find_first":".find_last",code=list+finder+"("+search+")",[code,this.ORDER_FUNCTION_CALL]},lists_getIndex:function(block){var mode=block.getFieldValue("MODE"),where,at,list,code,code1,code2,code3,code4,code5,code6,code7,functionName,code8,functionName1,code9;if(System.String.isNullOrEmpty(mode)&&(mode="GET"),where=block.getFieldValue("WHERE"),System.String.isNullOrEmpty(where)&&(where="FROM_START"),at=Blockly.Ruby.valueToCode(block,"AT",Blockly.Ruby.ORDER_UNARY_SIGN),System.String.isNullOrEmpty(at)&&(at="1"),list=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_MEMBER),System.String.isNullOrEmpty(list)&&(list="[]"),Bridge.referenceEquals(where,"FIRST")){if(Bridge.referenceEquals(mode,"GET"))return code=list+".first",[code,this.ORDER_FUNCTION_CALL];if(code1=list+".shift",Bridge.referenceEquals(mode,"GET_REMOVE"))return[code1,this.ORDER_FUNCTION_CALL];if(Bridge.referenceEquals(mode,"REMOVE"))return code1+"\n"}else if(Bridge.referenceEquals(where,"LAST")){if(Bridge.referenceEquals(mode,"GET"))return code2=list+".last",[code2,this.ORDER_MEMBER];if(code3=list+".pop",Bridge.referenceEquals(mode,"GET_REMOVE"))return[code3,this.ORDER_FUNCTION_CALL];if(Bridge.referenceEquals(mode,"REMOVE"))return code3+"\n"}else if(Bridge.referenceEquals(where,"FROM_START")){if(at=Blockly.isNumber(at)?(parseInt(at,10)-1|0).toString():"("+at+" - 1).to_i",Bridge.referenceEquals(mode,"GET"))return code4=list+"["+at+"]",[code4,this.ORDER_MEMBER];if(code5=list+".delete_at("+at+")",Bridge.referenceEquals(mode,"GET_REMOVE"))return[code5,this.ORDER_FUNCTION_CALL];if(Bridge.referenceEquals(mode,"REMOVE"))return code5+"\n"}else if(Bridge.referenceEquals(where,"FROM_END")){if(Bridge.referenceEquals(mode,"GET"))return code6=list+"[-"+at+"]",[code6,this.ORDER_MEMBER];if(code7=list+".delete_at(-"+at+")",Bridge.referenceEquals(mode,"GET_REMOVE"))return[code7,this.ORDER_FUNCTION_CALL];if(Bridge.referenceEquals(mode,"REMOVE"))return code7+"\n"}else if(Bridge.referenceEquals(where,"RANDOM")){if(Bridge.referenceEquals(mode,"GET"))return functionName=Blockly.Ruby.provideFunction_("lists_random_item",["def "+Blockly.Ruby.functionNamePlaceholder()+"(myList)","  myList[rand(myList.size)]","end"]),code8=functionName+"("+list+")",[code8,this.ORDER_FUNCTION_CALL];if(functionName1=Blockly.Ruby.provideFunction_("lists_remove_random_item",["def "+Blockly.Ruby.functionNamePlaceholder()+"(myList)","  myList.delete_at(rand(myList.size))","end"]),code9=functionName1+"("+list+")",Bridge.referenceEquals(mode,"GET_REMOVE"))return[code9,this.ORDER_FUNCTION_CALL];if(Bridge.referenceEquals(mode,"REMOVE"))return code9+"\n"}throw new System.Exception("Unhandled combination (lists_getIndex).");},lists_setIndex:function(block){var list=Blockly.Ruby.valueToCode(block,"LIST",Blockly.Ruby.ORDER_MEMBER),mode,where,at,value,functionName,code,functionName1,code1;if(System.String.isNullOrEmpty(list)&&(list="[]"),mode=block.getFieldValue("MODE"),System.String.isNullOrEmpty(mode)&&(mode="GET"),where=block.getFieldValue("WHERE"),System.String.isNullOrEmpty(where)&&(where="FROM_START"),at=Blockly.Ruby.valueToCode(block,"AT",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(at)&&(at="1"),value=Blockly.Ruby.valueToCode(block,"TO",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(value)&&(value="None"),Bridge.referenceEquals(where,"FIRST")){if(Bridge.referenceEquals(mode,"SET"))return list+"[0] = "+value+"\n";if(Bridge.referenceEquals(mode,"INSERT"))return list+".unshift("+value+")\n"}else if(Bridge.referenceEquals(where,"LAST")){if(Bridge.referenceEquals(mode,"SET"))return list+"[-1] = "+value+"\n";if(Bridge.referenceEquals(mode,"INSERT"))return list+".push("+value+")\n"}else if(Bridge.referenceEquals(where,"FROM_START")){if(at=Blockly.isNumber(at)?(parseInt(at,10)-1|0).toString():"("+at+" - 1).to_i",Bridge.referenceEquals(mode,"SET"))return list+"["+at+"] = "+value+"\n";if(Bridge.referenceEquals(mode,"INSERT"))return list+".insert("+at+", "+value+")\n"}else if(Bridge.referenceEquals(where,"FROM_END")){if(Bridge.referenceEquals(mode,"SET"))return at=Blockly.isNumber(at)?parseInt(at,10).toString():"("+at+").to_i",list+"[-"+at+"] = "+value+"\n";if(Bridge.referenceEquals(mode,"INSERT"))return at=Blockly.isNumber(at)?(parseInt(at,10)+1|0).toString():"("+at+" + 1).to_i",list+".insert(-"+at+", "+value+")\n"}else if(Bridge.referenceEquals(where,"RANDOM")){if(Bridge.referenceEquals(mode,"SET"))return functionName=Blockly.Ruby.provideFunction_("lists_set_random_item",["def "+Blockly.Ruby.functionNamePlaceholder()+"(myList, value)","  myList[rand(myList.size)] = "+value,"end"]),code=functionName+"("+list+", "+value+")\n",code;if(Bridge.referenceEquals(mode,"INSERT"))return functionName1=Blockly.Ruby.provideFunction_("lists_insert_random_item",["def "+Blockly.Ruby.functionNamePlaceholder()+"(myList, value)","  myList.insert(rand(myList.size), "+value+")","end"]),code1=functionName1+"("+list+", "+value+")\n",code1}throw new System.Exception("Unhandled combination (lists_setIndex).");},lists_getSublist:function(block){var functionName=Blockly.Ruby.provideFunction_("lists_sublist",["def "+Blockly.Ruby.functionNamePlaceholder()+"(myList, range)","  myList[range] || []","end"]),list=Blockly.Ruby.valueToCode(block,"LIST",Blockly.Ruby.ORDER_MEMBER),at2,code;System.String.isNullOrEmpty(list)&&(list="[]");var where1=block.getFieldValue("WHERE1"),where2=block.getFieldValue("WHERE2"),at1=Blockly.Ruby.valueToCode(block,"AT1",Blockly.Ruby.ORDER_ADDITIVE);return System.String.isNullOrEmpty(at1)&&(at1="1"),at2=Blockly.Ruby.valueToCode(block,"AT2",Blockly.Ruby.ORDER_ADDITIVE),System.String.isNullOrEmpty(at2)&&(at2="1"),Bridge.referenceEquals(where1,"FIRST")||Bridge.referenceEquals(where1,"FROM_START")&&Bridge.referenceEquals(at1,"1")?at1="0":Bridge.referenceEquals(where1,"FROM_START")?at1=Blockly.isNumber(at1)?(parseInt(at1,10)-1|0).toString():at1+".to_i - 1)":Bridge.referenceEquals(where1,"FROM_END")&&(at1=Blockly.isNumber(at1)?(-parseInt(at1,10)|0).toString():"-"+at1+".to_i"),Bridge.referenceEquals(where2,"LAST")||Bridge.referenceEquals(where2,"FROM_END")&&Bridge.referenceEquals(at2,"1")?at2="-1":Bridge.referenceEquals(where2,"FROM_START")?at2=Blockly.isNumber(at2)?(parseInt(at2,10)-1|0).toString():at2+".to_i - 1":Bridge.referenceEquals(where2,"FROM_END")&&(at2=Blockly.isNumber(at2)?(-parseInt(at2,10)|0).toString():"-"+at2+".to_i"),code=functionName+"("+list+", "+at1+".."+at2+")",[code,this.ORDER_FUNCTION_CALL]},controls_if:function(block){var n=0,argument=Blockly.Ruby.valueToCode(block,"IF"+n,Blockly.Ruby.ORDER_NONE),branch,code;for(System.String.isNullOrEmpty(argument)&&(argument="false"),branch=Blockly.Ruby.statementToCode(block,"DO"+n),System.String.isNullOrEmpty(branch)&&(branch="\n"),code="if "+argument+"\n"+branch,n=1;n<=block.elseifCount_;n=n+1|0)argument=Blockly.Ruby.valueToCode(block,"IF"+n,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument)&&(argument="false"),branch=Blockly.Ruby.statementToCode(block,"DO"+n),System.String.isNullOrEmpty(branch)&&(branch="\n"),code+="elsif "+argument+"\n"+branch;return block.elseCount_!==0&&(branch=Blockly.Ruby.statementToCode(block,"ELSE"),System.String.isNullOrEmpty(branch)&&(branch="\n"),code+="else\n"+branch),code+"end\n"},logic_compare:function(block){var OPERATORS=new System.Collections.Generic.Dictionary$2(String,String)(),argument1,code;OPERATORS.add("EQ","==");OPERATORS.add("NEQ","!=");OPERATORS.add("LT","<");OPERATORS.add("LTE","<=");OPERATORS.add("GT",">");OPERATORS.add("GTE",">=");var operator=OPERATORS.get(block.getFieldValue("OP")),order=Blockly.Ruby.ORDER_RELATIONAL,argument0=Blockly.Ruby.valueToCode(block,"A",order);return System.String.isNullOrEmpty(argument0)&&(argument0="0"),argument1=Blockly.Ruby.valueToCode(block,"B",order),System.String.isNullOrEmpty(argument1)&&(argument1="0"),code=argument0+String.fromCharCode(32)+operator+String.fromCharCode(32)+argument1,[code,order]},logic_operation:function(block){var operator=Bridge.referenceEquals(block.getFieldValue("OP"),"AND")?"&&":"||",order=Bridge.referenceEquals(operator,"&&")?Blockly.Ruby.ORDER_LOGICAL_AND:Blockly.Ruby.ORDER_LOGICAL_OR,argument0=Blockly.Ruby.valueToCode(block,"A",order),argument1=Blockly.Ruby.valueToCode(block,"B",order),defaultArgument,code;return System.String.isNullOrEmpty(argument0)&&System.String.isNullOrEmpty(argument1)?(argument0="false",argument1="false"):(defaultArgument=Bridge.referenceEquals(operator,"&&")?"true":"false",System.String.isNullOrEmpty(argument0)&&(argument0=defaultArgument),System.String.isNullOrEmpty(argument1)&&(argument1=defaultArgument)),code=argument0+String.fromCharCode(32)+operator+String.fromCharCode(32)+argument1,[code,order]},logic_negate:function(block){var argument0=Blockly.Ruby.valueToCode(block,"BOOL",Blockly.Ruby.ORDER_LOGICAL_NOT),code;return System.String.isNullOrEmpty(argument0)&&(argument0="true"),code="! "+argument0,[code,this.ORDER_LOGICAL_NOT]},logic_boolean:function(block){var code=Bridge.referenceEquals(block.getFieldValue("BOOL"),"TRUE")?"true":"false";return[code,this.ORDER_ATOMIC]},logic_null:function(){return["nil",this.ORDER_ATOMIC]},logic_ternary:function(block){var value_if=Blockly.Ruby.valueToCode(block,"IF",Blockly.Ruby.ORDER_CONDITIONAL),value_then,value_else,code;return System.String.isNullOrEmpty(value_if)&&(value_if="false"),value_then=Blockly.Ruby.valueToCode(block,"THEN",Blockly.Ruby.ORDER_CONDITIONAL),System.String.isNullOrEmpty(value_then)&&(value_then="nil"),value_else=Blockly.Ruby.valueToCode(block,"ELSE",Blockly.Ruby.ORDER_CONDITIONAL),System.String.isNullOrEmpty(value_else)&&(value_else="nil"),code=value_if+" ? "+value_then+" : "+value_else,[code,this.ORDER_CONDITIONAL]},controls_repeat:function(block){var repeats=parseInt(block.getFieldValue("TIMES"),10),branch=Blockly.Ruby.statementToCode(block,"DO");return System.String.isNullOrEmpty(branch)&&(branch="end\n"),Blockly.Ruby.INFINITE_LOOP_TRAP!=null&&(branch=Blockly.Ruby.INFINITE_LOOP_TRAP.replace(new RegExp("%1","g"),"'"+block.id+"'")+branch),repeats+".times do\n"+branch+"end\n"},controls_repeat_ext:function(block){var repeats=Blockly.Ruby.valueToCode(block,"TIMES",Blockly.Ruby.ORDER_NONE),branch;return System.String.isNullOrEmpty(repeats)&&(repeats="0"),repeats=Blockly.isNumber(repeats)?parseInt(repeats,10).toString():repeats+".to_i",branch=Blockly.Ruby.statementToCode(block,"DO"),System.String.isNullOrEmpty(branch)&&(branch="end\n"),Blockly.Ruby.INFINITE_LOOP_TRAP!=null&&(branch=Blockly.Ruby.INFINITE_LOOP_TRAP.replace(new RegExp("%1","g"),"'"+block.id+"'")+branch),repeats+".times do\n"+branch+"end\n"},controls_whileUntil:function(block){var until=Bridge.referenceEquals(block.getFieldValue("MODE"),"UNTIL"),argument0=Blockly.Ruby.valueToCode(block,"BOOL",until?Blockly.Ruby.ORDER_LOGICAL_NOT:Blockly.Ruby.ORDER_NONE),branch,mode;return System.String.isNullOrEmpty(argument0)&&(argument0="false"),branch=Blockly.Ruby.statementToCode(block,"DO"),System.String.isNullOrEmpty(branch)&&(branch="end\n"),Blockly.Ruby.INFINITE_LOOP_TRAP!=null&&(branch=Blockly.Ruby.INFINITE_LOOP_TRAP.replace(new RegExp("%1","g"),'"'+block.id+'"')+branch),mode=until?"until ":"while ",mode+argument0+" do\n"+branch+"end\n"},controls_for:function(block){var loopVar,fromVal,toVal,increment,branch;Blockly.Ruby.variableDB_.pushScope();loopVar=Blockly.Ruby.variableDB_.addLocalVariable(block.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);fromVal=Blockly.Ruby.valueToCode(block,"FROM",Blockly.Ruby.ORDER_NONE);System.String.isNullOrEmpty(fromVal)&&(fromVal="0");toVal=Blockly.Ruby.valueToCode(block,"TO",Blockly.Ruby.ORDER_NONE);System.String.isNullOrEmpty(toVal)&&(toVal="0");increment=Blockly.Ruby.valueToCode(block,"BY",Blockly.Ruby.ORDER_NONE);System.String.isNullOrEmpty(increment)&&(increment=null);branch=Blockly.Ruby.statementToCode(block,"DO");System.String.isNullOrEmpty(branch)&&(branch="");Blockly.Ruby.INFINITE_LOOP_TRAP!=null&&(branch=Blockly.Ruby.INFINITE_LOOP_TRAP.replace(new RegExp("%1","g"),String.fromCharCode(34)+block.id+String.fromCharCode(34))+branch);var forLoop=$_.WebMrbc.Ruby.f5,generateForLoop=function(_fromVal,_toVal,_increment){return forLoop()+" from: ("+_fromVal+"), to: ("+_toVal+"), by: ("+_increment+")"},_forLoop;return Blockly.isNumber(fromVal)&&Blockly.isNumber(toVal)&&(increment==null||Blockly.isNumber(increment))?(increment==null&&(increment="1"),fromVal=System.Double.format(parseFloat(fromVal),"G"),toVal=System.Double.format(parseFloat(toVal),"G"),increment=System.Double.format(parseFloat(increment),"G"),_forLoop=generateForLoop(fromVal,toVal,increment)):(increment=increment==null?"1":"("+increment+").to_f",_forLoop=generateForLoop(fromVal+".to_f",toVal+".to_f",increment)),Blockly.Ruby.variableDB_.popScope(),""+(_forLoop+" do |"+loopVar+"|\n"+branch+"end\n")},controls_forEach:function(block){var loopVar,argument0,branch;return Blockly.Ruby.variableDB_.pushScope(),loopVar=Blockly.Ruby.variableDB_.addLocalVariable(block.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),argument0=Blockly.Ruby.valueToCode(block,"LIST",Blockly.Ruby.ORDER_RELATIONAL),System.String.isNullOrEmpty(argument0)&&(argument0="[]"),branch=Blockly.Ruby.statementToCode(block,"DO"),System.String.isNullOrEmpty(branch)&&(branch="end\n"),Blockly.Ruby.INFINITE_LOOP_TRAP!=null&&(branch=Blockly.Ruby.INFINITE_LOOP_TRAP.replace(new RegExp("%1","g"),'"'+block.id+'"')+branch),Blockly.Ruby.variableDB_.popScope(),argument0+".each do |"+loopVar+"|\n"+branch+"end\n"},controls_flow_statements:function(block){switch(block.getFieldValue("FLOW")){case"BREAK":return"break\n";case"CONTINUE":return"next\n"}throw new System.Exception("Unknown flow statement.");},math_number:function(block){var code=parseFloat(block.getFieldValue("NUM")),order=code<0?Blockly.Ruby.ORDER_UNARY_SIGN:Blockly.Ruby.ORDER_ATOMIC;return[code,order]},math_arithmetic:function(block){var OPERATORS=new System.Collections.Generic.Dictionary$2(String,Array)(),argument1,code;OPERATORS.add("ADD",[" + ",Blockly.Ruby.ORDER_ADDITIVE]);OPERATORS.add("MINUS",[" - ",Blockly.Ruby.ORDER_ADDITIVE]);OPERATORS.add("MULTIPLY",[" * ",Blockly.Ruby.ORDER_MULTIPLICATIVE]);OPERATORS.add("DIVIDE",[" / ",Blockly.Ruby.ORDER_MULTIPLICATIVE]);OPERATORS.add("POWER",[" ** ",Blockly.Ruby.ORDER_EXPONENTIATION]);var tuple=OPERATORS.get(block.getFieldValue("OP")),operator=tuple[0],order=Bridge.cast(tuple[1],System.Int32),argument0=Blockly.Ruby.valueToCode(block,"A",order);return System.String.isNullOrEmpty(argument0)&&(argument0="0"),argument1=Blockly.Ruby.valueToCode(block,"B",order),System.String.isNullOrEmpty(argument1)&&(argument1="0"),code=argument0+operator+argument1,[code,order]},math_single:function(block){var operator=block.getFieldValue("OP"),code=null,arg;if(Bridge.referenceEquals(operator,"NEG"))return code=Blockly.Ruby.valueToCode(block,"NUM",Blockly.Ruby.ORDER_UNARY_SIGN),System.String.isNullOrEmpty(code)&&(code="0"),["-"+code,this.ORDER_UNARY_SIGN];Bridge.referenceEquals(operator,"SIN")||Bridge.referenceEquals(operator,"COS")||Bridge.referenceEquals(operator,"TAN")?(arg="("+Blockly.Ruby.valueToCode(block,"NUM",Blockly.Ruby.ORDER_MULTIPLICATIVE)+")",System.String.isNullOrEmpty(arg)&&(arg="0")):(arg="("+Blockly.Ruby.valueToCode(block,"NUM",Blockly.Ruby.ORDER_NONE)+")",System.String.isNullOrEmpty(arg)&&(arg="0"));switch(operator){case"ABS":code=arg+".abs";break;case"ROOT":code="Math.sqrt("+arg+")";break;case"LN":code="Math.log("+arg+")";break;case"LOG10":code="Math.log10("+arg+")";break;case"EXP":code="Math.exp("+arg+")";break;case"POW10":code="(10 ** "+arg+")";break;case"ROUND":code=arg+".round";break;case"ROUNDUP":code=arg+".ceil";break;case"ROUNDDOWN":code=arg+".floor";break;case"SIN":code="Math.sin("+arg+" / 180.0 * Math::PI)";break;case"COS":code="Math.cos("+arg+" / 180.0 * Math::PI)";break;case"TAN":code="Math.tan("+arg+" / 180.0 * Math::PI)"}if(!System.String.isNullOrEmpty(code))return[code,this.ORDER_FUNCTION_CALL];switch(operator){case"ASIN":code="Math.asin("+arg+") / Math::PI * 180";break;case"ACOS":code="Math.acos("+arg+") / Math::PI * 180";break;case"ATAN":code="Math.atan("+arg+") / Math::PI * 180";break;default:throw new System.Exception("Unknown math operator: "+operator);}return[code,this.ORDER_MULTIPLICATIVE]},math_constant:function(block){var CONSTANTS=new System.Collections.Generic.Dictionary$2(String,Array)(),constant;return CONSTANTS.add("PI",["Math::PI",Blockly.Ruby.ORDER_MEMBER]),CONSTANTS.add("E",["Math::E",Blockly.Ruby.ORDER_MEMBER]),CONSTANTS.add("GOLDEN_RATIO",["(1 + Math.sqrt(5)) / 2",Blockly.Ruby.ORDER_MULTIPLICATIVE]),CONSTANTS.add("SQRT2",["Math.sqrt(2)",Blockly.Ruby.ORDER_MEMBER]),CONSTANTS.add("SQRT1_2",["Math.sqrt(1.0 / 2)",Blockly.Ruby.ORDER_MEMBER]),CONSTANTS.add("INFINITY",["1/0.0",Blockly.Ruby.ORDER_ATOMIC]),constant=block.getFieldValue("CONSTANT"),CONSTANTS.get(constant)},math_number_property:function(block){var number_to_check=Blockly.Ruby.valueToCode(block,"NUMBER_TO_CHECK",Blockly.Ruby.ORDER_MULTIPLICATIVE),dropdown_property,code,functionName,divisor;if(System.String.isNullOrEmpty(number_to_check)&&(number_to_check="0"),dropdown_property=block.getFieldValue("PROPERTY"),code=null,Bridge.referenceEquals(dropdown_property,"PRIME"))return functionName=Blockly.Ruby.provideFunction_("is_prime",["def "+Blockly.Ruby.functionNamePlaceholder()+" n","  return false if n < 0","  (2..Math.sqrt(n)).each { |i| return false if n % i == 0}","  true","end"]),code=functionName+"("+number_to_check+")",[code,this.ORDER_FUNCTION_CALL];switch(dropdown_property){case"EVEN":code=number_to_check+".even?";break;case"ODD":code=number_to_check+".odd?";break;case"WHOLE":code=number_to_check+" % 1 == 0";break;case"POSITIVE":code=number_to_check+" > 0";break;case"NEGATIVE":code=number_to_check+" < 0";break;case"DIVISIBLE_BY":if(divisor=Blockly.Ruby.valueToCode(block,"DIVISOR",Blockly.Ruby.ORDER_MULTIPLICATIVE),System.String.isNullOrEmpty(divisor)||Bridge.referenceEquals(divisor,"0"))return["false",this.ORDER_ATOMIC];code=number_to_check+" % "+divisor+" == 0"}return[code,this.ORDER_RELATIONAL]},math_change:function(block){var argument0=Blockly.Ruby.valueToCode(block,"DELTA",Blockly.Ruby.ORDER_ADDITIVE),varName;return System.String.isNullOrEmpty(argument0)&&(argument0="0"),varName=Blockly.Ruby.variableDB_.getRubyName(block.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),varName+" += "+argument0+"\n"},math_round:function(block){return this.math_single(block)},math_trig:function(block){return this.math_single(block)},math_on_list:function(block){var func=block.getFieldValue("OP"),list=Blockly.Ruby.valueToCode(block,"LIST",Blockly.Ruby.ORDER_NONE),code,functionName;System.String.isNullOrEmpty(list)&&(list="[]");switch(func){case"SUM":code=list+".sum";break;case"MIN":code=list+".numbers.min";break;case"MAX":code=list+".numbers.max";break;case"AVERAGE":code=list+".average";break;case"MEDIAN":code=list+".median";break;case"MODE":functionName=Blockly.Ruby.provideFunction_("math_modes",["def "+Blockly.Ruby.functionNamePlaceholder()+"(some_list)","  groups = some_list.group_by{|v| v}","  ","  groups = groups.sort {|a,b| b[1].size <=> a[1].size}","  ","  max_size = groups[0][1].size","  ","  modes = []","  ","  groups.each do |group|","    ","    break if group[1].size != max_size","    ","    modes << group[0]","    ","  end","  ","  modes","","end"]);code=functionName+"("+list+")";break;case"STD_DEV":code=list+".standard_deviation";break;case"RANDOM":code=list+"[rand("+list+".size)]";break;default:throw new System.Exception("Unknown operator: "+func);}return[code,this.ORDER_FUNCTION_CALL]},math_modulo:function(block){var argument0=Blockly.Ruby.valueToCode(block,"DIVIDEND",Blockly.Ruby.ORDER_MULTIPLICATIVE),argument1,code;return System.String.isNullOrEmpty(argument0)&&(argument0="0"),argument1=Blockly.Ruby.valueToCode(block,"DIVISOR",Blockly.Ruby.ORDER_MULTIPLICATIVE),System.String.isNullOrEmpty(argument1)&&(argument1="0"),code=argument0+" % "+argument1,[code,this.ORDER_MULTIPLICATIVE]},math_constrain:function(block){var argument0=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_NONE),argument1,argument2,code;return System.String.isNullOrEmpty(argument0)&&(argument0="0"),argument1=Blockly.Ruby.valueToCode(block,"LOW",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument1)&&(argument1="0"),argument2=Blockly.Ruby.valueToCode(block,"HIGH",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument2)&&(argument2="float('inf')"),code="[["+argument0+", "+argument1+"].max, "+argument2+"].min",[code,this.ORDER_FUNCTION_CALL]},math_random_int:function(block){var argument0=Blockly.Ruby.valueToCode(block,"FROM",Blockly.Ruby.ORDER_NONE),argument1,code;return System.String.isNullOrEmpty(argument0)&&(argument0="0"),argument1=Blockly.Ruby.valueToCode(block,"TO",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument1)&&(argument1="0"),code="rand("+argument0+".."+argument1+")",[code,this.ORDER_FUNCTION_CALL]},math_random_float:function(){return["rand",this.ORDER_FUNCTION_CALL]},procedures_defreturn:function(block){var globals,i,varName,args,x,funcName,branch,returnValue,code;for(Blockly.Ruby.variableDB_.pushScope(),globals=Blockly.Variables.allVariables(block),i=globals.length-1|0;i>=0;i=i-1|0)varName=globals[i],block.arguments_.indexOf(varName)===-1?globals[i]=Blockly.Ruby.variableDB_.getRubyName(varName,Blockly.Variables.NAME_TYPE):globals.splice(i,1);for(args=System.Array.init(0,null),x=0;x<block.arguments_.length;x=x+1|0)args[x]=Blockly.Ruby.variableDB_.addLocalVariable(block.arguments_[x],Blockly.Variables.NAME_TYPE);return funcName=Blockly.Ruby.variableDB_.getRubyName(block.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),branch=Blockly.Ruby.statementToCode(block,"STACK"),Blockly.Ruby.INFINITE_LOOP_TRAP!=null&&(branch=Blockly.Ruby.INFINITE_LOOP_TRAP.replace(new RegExp("%1","g"),'"'+block.id+'"')+branch),returnValue=Blockly.Ruby.valueToCode(block,"RETURN",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(returnValue)&&(returnValue="\n  return "+returnValue+"\n"),code="def "+funcName+"("+args.join(", ")+")\n"+branch+returnValue+"end",code=Blockly.Ruby.scrub_(block,code),Blockly.Ruby.definitions_.set(funcName,code),Blockly.Ruby.variableDB_.popScope(),null},procedures_defnoreturn:function(block){return Blockly.Ruby.procedures_defreturn(block)},procedures_callreturn:function(block){for(var code,funcName=Blockly.Ruby.variableDB_.getRubyName(block.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),args=System.Array.init(0,null),x=0;x<block.arguments_.length;x=x+1|0)args[x]=Blockly.Ruby.valueToCode(block,"ARG"+x,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(args[x])&&(args[x]="None");return code=funcName+"("+args.join(", ")+")",[code,this.ORDER_FUNCTION_CALL]},procedures_callnoreturn:function(block){for(var funcName=Blockly.Ruby.variableDB_.getRubyName(block.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),args=System.Array.init(0,null),x=0;x<block.arguments_.length;x=x+1|0)args[x]=Blockly.Ruby.valueToCode(block,"ARG"+x,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(args[x])&&(args[x]="None");return funcName+"("+args.join(", ")+")\n"},procedures_ifreturn:function(block){var condition=Blockly.Ruby.valueToCode(block,"CONDITION",Blockly.Ruby.ORDER_NONE),code,value;return System.String.isNullOrEmpty(condition)&&(condition="False"),code="if "+condition+"\n",block.hasReturnValue_?(value=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(value)&&(value="None"),code+="\n  return "+value+"\n"):code+="\n  return\n",code+"end\n"},text:function(block){var code=Blockly.Ruby.quote_(block.getFieldValue("TEXT"));return[code,this.ORDER_ATOMIC]},text_join:function(block){var code,argument0,argument01,argument1,codes,n,temp;if(block.itemCount_===0)return["''",this.ORDER_ATOMIC];if(block.itemCount_===1)return argument0=Blockly.Ruby.valueToCode(block,"ADD0",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument0)&&(argument0="''"),code=argument0+".to_s",[code,this.ORDER_FUNCTION_CALL];if(block.itemCount_===2)return argument01=Blockly.Ruby.valueToCode(block,"ADD0",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument01)&&(argument01="''"),argument1=Blockly.Ruby.valueToCode(block,"ADD1",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument1)&&(argument1="''"),code=argument01+".to_s + "+argument1+".to_s",[code,this.ORDER_UNARY_SIGN];for(codes=System.Array.init(0,null),n=0;n<block.itemCount_;n=n+1|0)temp=Blockly.Ruby.valueToCode(block,"ADD"+n,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(temp)&&(temp="''"),codes[n]=temp+".to_s";return code=codes.join(" + "),[code,this.ORDER_FUNCTION_CALL]},text_append:function(block){var varName=Blockly.Ruby.variableDB_.getRubyName(block.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),argument0=Blockly.Ruby.valueToCode(block,"TEXT",Blockly.Ruby.ORDER_NONE);return System.String.isNullOrEmpty(argument0)&&(argument0="''"),varName+" = "+varName+".to_s + ("+argument0+").to_s\n"},text_length:function(block){var argument0=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_NONE);return System.String.isNullOrEmpty(argument0)&&(argument0="''"),[argument0+".size",this.ORDER_FUNCTION_CALL]},text_isEmpty:function(block){var argument0=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_NONE),code;return System.String.isNullOrEmpty(argument0)&&(argument0="''"),code=argument0+".empty?",[code,this.ORDER_FUNCTION_CALL]},text_indexOf:function(block){var finder=Bridge.referenceEquals(block.getFieldValue("END"),"FIRST")?".find_first":".find_last",search=Blockly.Ruby.valueToCode(block,"FIND",Blockly.Ruby.ORDER_NONE),text,code;return System.String.isNullOrEmpty(search)&&(search="''"),text=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_MEMBER),System.String.isNullOrEmpty(text)&&(text="''"),code=text+finder+"("+search+")",[code,this.ORDER_FUNCTION_CALL]},text_charAt:function(block){var where=block.getFieldValue("WHERE"),at,text,code,functionName;System.String.isNullOrEmpty(where)&&(where="FROM_START");at=Blockly.Ruby.valueToCode(block,"AT",Blockly.Ruby.ORDER_UNARY_SIGN);System.String.isNullOrEmpty(at)&&(at="1");text=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_MEMBER);System.String.isNullOrEmpty(text)&&(text="''");at=Blockly.isNumber(at)?(parseInt(at,10)-1|0).toString():at+".to_i - 1";switch(where){case"FIRST":return code=text+"[0]",[code,this.ORDER_MEMBER];case"LAST":return code=text+"[-1]",[code,this.ORDER_MEMBER];case"FROM_START":return functionName=Blockly.Ruby.provideFunction_("text_get_from_start",["def "+Blockly.Ruby.functionNamePlaceholder()+" (text, index)",'  return "" if index < 0','  text[index] || ""',"end"]),code=functionName+"("+text+", "+at+")",[code,this.ORDER_FUNCTION_CALL];case"FROM_END":return functionName=Blockly.Ruby.provideFunction_("text_get_from_end",["def "+Blockly.Ruby.functionNamePlaceholder()+" (text, index)",'  return "" if index < 0','  text[-index-1] || ""\'',"end"]),code=functionName+"("+text+", "+at+")",[code,this.ORDER_FUNCTION_CALL];case"RANDOM":return functionName=Blockly.Ruby.provideFunction_("text_random_letter",["def "+Blockly.Ruby.functionNamePlaceholder()+" (text)","  text[rand(text.size)]","end"]),code=functionName+"("+text+")",[code,this.ORDER_FUNCTION_CALL]}throw new System.Exception("Unhandled option (text_charAt).");},text_getSubstring:function(block){var text=Blockly.Ruby.valueToCode(block,"STRING",Blockly.Ruby.ORDER_MEMBER),at2,code;System.String.isNullOrEmpty(text)&&(text="''");var where1=block.getFieldValue("WHERE1"),where2=block.getFieldValue("WHERE2"),at1=Blockly.Ruby.valueToCode(block,"AT1",Blockly.Ruby.ORDER_NONE);return System.String.isNullOrEmpty(at1)&&(at1="1"),at2=Blockly.Ruby.valueToCode(block,"AT2",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(at2)&&(at2="1"),Bridge.referenceEquals(where1,"FIRST")||Bridge.referenceEquals(where1,"FROM_START")&&Bridge.referenceEquals(at1,"1")?at1="0":Bridge.referenceEquals(where1,"FROM_START")?at1=Blockly.isNumber(at1)?(parseInt(at1,10)-1|0).toString():at1+".to_i - 1":Bridge.referenceEquals(where1,"FROM_END")&&(at1=Blockly.isNumber(at1)?(-parseInt(at1,10)|0).toString():"-"+at1+".to_i"),Bridge.referenceEquals(where2,"LAST")||Bridge.referenceEquals(where2,"FROM_END")&&Bridge.referenceEquals(at2,"1")?at2="-1":Bridge.referenceEquals(where2,"FROM_START")?at2=Blockly.isNumber(at2)?(parseInt(at2,10)-1|0).toString():at2+".to_i - 1":Bridge.referenceEquals(where2,"FROM_END")&&(at2=Blockly.isNumber(at2)?(-parseInt(at2,10)|0).toString():at2+".to_i"),code=text+"["+at1+".."+at2+"]",[code,this.ORDER_MEMBER]},text_changeCase:function(block){var OPERATORS=new System.Collections.Generic.Dictionary$2(String,String)(),code,operator,argument0,functionName,argument01;return OPERATORS.add("UPPERCASE",".upcase"),OPERATORS.add("LOWERCASE",".downcase"),OPERATORS.add("TITLECASE",null),operator=OPERATORS.get(block.getFieldValue("CASE")),System.String.isNullOrEmpty(operator)?(functionName=Blockly.Ruby.provideFunction_("text_to_title_case",["def "+Blockly.Ruby.functionNamePlaceholder()+"(str)","  str.gsub(/\\S+/) {|txt| txt.capitalize}","end"]),argument01=Blockly.Ruby.valueToCode(block,"TEXT",Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument01)&&(argument01="''"),code=functionName+"("+argument01+")"):(operator=OPERATORS.get(block.getFieldValue("CASE")),argument0=Blockly.Ruby.valueToCode(block,"TEXT",Blockly.Ruby.ORDER_MEMBER),System.String.isNullOrEmpty(argument0)&&(argument0="''"),code=argument0+operator),[code,this.ORDER_MEMBER]},text_trim:function(block){var OPERATORS=new System.Collections.Generic.Dictionary$2(String,String)(),operator,argument0,code;return OPERATORS.add("LEFT",".lstrip"),OPERATORS.add("RIGHT",".rstrip"),OPERATORS.add("BOTH",".strip"),operator=OPERATORS.get(block.getFieldValue("MODE")),argument0=Blockly.Ruby.valueToCode(block,"TEXT",Blockly.Ruby.ORDER_MEMBER),System.String.isNullOrEmpty(argument0)&&(argument0="''"),code=argument0+operator,[code,this.ORDER_MEMBER]},text_print:function(block){var argument0=Blockly.Ruby.valueToCode(block,"TEXT",Blockly.Ruby.ORDER_NONE);return System.String.isNullOrEmpty(argument0)&&(argument0="''"),"blockly_puts("+argument0+")\n"},text_prompt:function(block){var functionName=Blockly.Ruby.provideFunction_("text_prompt",["def "+Blockly.Ruby.functionNamePlaceholder()+"(msg):","    print (msg)","    $stdin.gets"]),msg=Blockly.Ruby.quote_(block.getFieldValue("TEXT")),code=functionName+"("+msg+")",toNumber=Bridge.referenceEquals(block.getFieldValue("TYPE"),"NUMBER");return toNumber&&(code=code+".to_f"),[code,this.ORDER_FUNCTION_CALL]},variables_get:function(block){var code=Blockly.Ruby.variableDB_.getRubyName(block.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);return[code,this.ORDER_ATOMIC]},variables_set:function(block){var argument0=Blockly.Ruby.valueToCode(block,"VALUE",Blockly.Ruby.ORDER_NONE),varName;return System.String.isNullOrEmpty(argument0)&&(argument0="0"),varName=Blockly.Ruby.variableDB_.getRubyName(block.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),varName+" = "+argument0+"\n"},switch_case_number:function(block){var argument=Blockly.Ruby.valueToCode(block,"SWITCH",Blockly.Ruby.ORDER_NONE),code,n,branch;for(System.String.isNullOrEmpty(argument)&&(argument="-1"),code="case "+argument+"\n",n=0,argument=Blockly.Ruby.valueToCode(block,"CASE"+n,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument)&&(argument=n.toString()),branch=Blockly.Ruby.statementToCode(block,"DO"+n),System.String.isNullOrEmpty(branch)&&(branch="\n"),code+="when "+argument+"\n"+branch,n=1;n<=block.caseCount_;n=n+1|0)argument=Blockly.Ruby.valueToCode(block,"CASE"+n,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument)&&(argument=n.toString()),branch=Blockly.Ruby.statementToCode(block,"DO"+n),System.String.isNullOrEmpty(branch)&&(branch="\n"),code+="when "+argument+"\n"+branch;return block.defaultCount_!==0&&(branch=Blockly.Ruby.statementToCode(block,"DEFAULT"),System.String.isNullOrEmpty(branch)&&(branch="\n"),code+="else\n"+branch),code+"end\n"},switch_case_text:function(block){var argument=Blockly.Ruby.valueToCode(block,"SWITCH",Blockly.Ruby.ORDER_NONE),code,n,branch;for(System.String.isNullOrEmpty(argument)&&(argument="-1"),code="case "+argument+"\n",n=0,argument=Blockly.Ruby.valueToCode(block,"CASE"+n,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument)&&(argument=n.toString()),branch=Blockly.Ruby.statementToCode(block,"DO"+n),System.String.isNullOrEmpty(branch)&&(branch="\n"),code+="when "+argument+"\n"+branch,n=1;n<=block.caseCount_;n=n+1|0)argument=Blockly.Ruby.valueToCode(block,"CASE"+n,Blockly.Ruby.ORDER_NONE),System.String.isNullOrEmpty(argument)&&(argument=n.toString()),branch=Blockly.Ruby.statementToCode(block,"DO"+n),System.String.isNullOrEmpty(branch)&&(branch="\n"),code+="when "+argument+"\n"+branch;return block.defaultCount_!==0&&(branch=Blockly.Ruby.statementToCode(block,"DEFAULT"),System.String.isNullOrEmpty(branch)&&(branch="\n"),code+="else\n"+branch),code+"end\n"}});Bridge.define("$AnonymousType$5",$_,{constructor:function(){},equals:function(o){if(!Bridge.is(o,$_.$AnonymousType$5))return!1},getHashCode:function(){return-1020251645},toJSON:function(){return{}}});Bridge.define("$AnonymousType$6",$_,{constructor:function(object,dropSelf){this.object=object;this.dropSelf=dropSelf},getobject:function(){return this.object},getdropSelf:function(){return this.dropSelf},equals:function(o){return Bridge.is(o,$_.$AnonymousType$6)?Bridge.equals(this.object,o.object)&&Bridge.equals(this.dropSelf,o.dropSelf):!1},getHashCode:function(){var hash=17;return hash=hash*23+1708631319,hash=hash*23+(this.object==null?0:Bridge.getHashCode(this.object)),hash*23+(this.dropSelf==null?0:Bridge.getHashCode(this.dropSelf))},toJSON:function(){return{object:this.object,dropSelf:this.dropSelf}}});Bridge.define("$AnonymousType$7",$_,{constructor:function(dropSelf){this.dropSelf=dropSelf},getdropSelf:function(){return this.dropSelf},equals:function(o){return Bridge.is(o,$_.$AnonymousType$7)?Bridge.equals(this.dropSelf,o.dropSelf):!1},getHashCode:function(){var hash=17;return hash=hash*23+142547378,hash*23+(this.dropSelf==null?0:Bridge.getHashCode(this.dropSelf))},toJSON:function(){return{dropSelf:this.dropSelf}}});Bridge.ns("WebMrbc.Ruby",$_);Bridge.apply($_.WebMrbc.Ruby,{f1:function(name,type){if(Bridge.referenceEquals(type,Blockly.Variables.NAME_TYPE)){for(var scope=Blockly.Ruby.variableDB_.localVars;scope!=null;){if(name in scope)return scope.name;scope=scope.chain}return"@"+Blockly.Ruby.variableDB_.getName(name,type)}return Blockly.Ruby.variableDB_.getName(name,type)},f2:function(){var previousLV=Blockly.Ruby.variableDB_.localVars,previousDB=Blockly.Ruby.variableDB_.localVarsDB;Blockly.Ruby.variableDB_.localVars=Object("create",null);Blockly.Ruby.variableDB_.localVarsDB=new Blockly.Names(Blockly.Ruby.reservedWords());Blockly.Ruby.variableDB_.localVars.chain=previousLV;Blockly.Ruby.variableDB_.localVarsDB.chain=previousDB},f3:function(name){return Blockly.Ruby.variableDB_.localVars[name]=this.variableDB_.localVarsDB.getName(name,Blockly.Variables.NAME_TYPE),Blockly.Ruby.variableDB_.localVars[name].toString()},f4:function(){Blockly.Ruby.variableDB_.localVars=this.variableDB_.localVars.chain;Blockly.Ruby.variableDB_.localVarsDB=this.variableDB_.localVarsDB.chain},f5:function(){return Blockly.Ruby.provideFunction_("for_loop",["# loops though all numbers from +params[:from]+ to +params[:to]+ by the step","# value +params[:by]+ and calls the given block passing the numbers","def ' + Blockly.Ruby.FUNCTION_NAME_PLACEHOLDER_() + ' params","","  from = params[:from] #.to_f","  to = params[:to] #.to_f","  by = params[:by].abs #.to_f","","  from.step(to, (from > to) ? -1 * by : by) do |value|","    yield value","  end","","end"])}});Bridge.define("WebMrbc.SdCloseBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルをクローズします").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdCopyBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルをコピーする");this.appendValueInput("SRC_FILENAME").setCheck("String").appendField("コピー元ファイル名");this.appendValueInput("DST_FILENAME").setCheck("String").appendField("コピー先ファイル名");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdExistsBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルが存在するかどうか調べる");this.appendValueInput("FILENAME").setCheck("String");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdFlushBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルの書き込みをフラッシュします").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdMkdirBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ディレクトリを作成する");this.appendValueInput("FILENAME").setCheck("String");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdOpenBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルをオープンします").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.appendValueInput("FILENAME").setCheck("String").appendField("ファイル名");this.appendDummyInput().appendField("モード").appendField(new Blockly.FieldDropdown([["Read","READ"],["Append","APPEND"],["New Create","NEW_CREATE"]]),"MODE");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdPositionBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルのseek位置を取得します").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdReadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルから1バイト読み込みます").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdRemoveBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルを削除する");this.appendValueInput("FILENAME").setCheck("String");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdRmdirBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ディレクトリを削除する");this.appendValueInput("FILENAME").setCheck("String");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdSeekBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルの読み出し位置を移動する").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.appendValueInput("POSITION").setCheck("Number").appendField("バイト数");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdSizeBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルのサイズを取得します").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SdWriteBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルにバイナリデータを書き込む").appendField(new Blockly.FieldDropdown([["File0","FILE0"],["File1","FILE1"]]),"FILE_NO");this.appendValueInput("DATA").setCheck("String").appendField("データ");this.appendValueInput("LENGTH").setCheck("Number").appendField("データサイズ");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SerialAvailableBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("シリアルデータがあるかどうか調べます").appendField(new Blockly.FieldDropdown([["USB","PORT0"],["TX-0/RX-1","PORT1"],["TX-5/RX-6","PORT2"],["TX-7/RX-8","PORT3"],["TX-12/RX-11","PORT4"],["TX-9(26)/RX-3","PORT5"]]),"PORT_NO");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SerialBpsBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ボーレートを設定します").appendField(new Blockly.FieldDropdown([["USB","PORT0"],["TX-0/RX-1","PORT1"],["TX-5/RX-6","PORT2"],["TX-7/RX-8","PORT3"],["TX-12/RX-11","PORT4"],["TX-9(26)/RX-3","PORT5"]]),"PORT_NO");this.appendValueInput("BPS").setCheck("Number").appendField("ボーレート");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SerialFlashBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("シリアルデータをフラッシュします").appendField(new Blockly.FieldDropdown([["USB","PORT0"],["TX-0/RX-1","PORT1"],["TX-5/RX-6","PORT2"],["TX-7/RX-8","PORT3"],["TX-12/RX-11","PORT4"],["TX-9(26)/RX-3","PORT5"]]),"PORT_NO");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SerialNewBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("シリアル通信を初期化します").appendField(new Blockly.FieldDropdown([["USB","PORT0"],["TX-0/RX-1","PORT1"],["TX-5/RX-6","PORT2"],["TX-7/RX-8","PORT3"],["TX-12/RX-11","PORT4"],["TX-9(26)/RX-3","PORT5"]]),"PORT_NO");this.appendValueInput("BPS").setCheck("Number").appendField("ボーレート");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SerialPrintBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("シリアルに出力します").appendField(new Blockly.FieldDropdown([["USB","PORT0"],["TX-0/RX-1","PORT1"],["TX-5/RX-6","PORT2"],["TX-7/RX-8","PORT3"],["TX-12/RX-11","PORT4"],["TX-9(26)/RX-3","PORT5"]]),"PORT_NO");this.appendValueInput("STR").setCheck("String").appendField("文字列");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SerialPrintlnBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("シリアルに\\r\\n付きで出力します").appendField(new Blockly.FieldDropdown([["USB","PORT0"],["TX-0/RX-1","PORT1"],["TX-5/RX-6","PORT2"],["TX-7/RX-8","PORT3"],["TX-12/RX-11","PORT4"],["TX-9(26)/RX-3","PORT5"]]),"PORT_NO");this.appendValueInput("STR").setCheck("String").appendField("文字列");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SerialReadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("シリアルからデータを取得します").appendField(new Blockly.FieldDropdown([["USB","PORT0"],["TX-0/RX-1","PORT1"],["TX-5/RX-6","PORT2"],["TX-7/RX-8","PORT3"],["TX-12/RX-11","PORT4"],["TX-9(26)/RX-3","PORT5"]]),"PORT_NO");this.setInputsInline(!0);this.setOutput(!0,"Array");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SerialWriteBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("シリアルにデータを出力します").appendField(new Blockly.FieldDropdown([["USB","PORT0"],["TX-0/RX-1","PORT1"],["TX-5/RX-6","PORT2"],["TX-7/RX-8","PORT3"],["TX-12/RX-11","PORT4"],["TX-9(26)/RX-3","PORT5"]]),"PORT_NO");this.appendValueInput("DATA").setCheck("String").appendField("データ");this.appendValueInput("LENGTH").setCheck("Number").appendField("データサイズ");this.setInputsInline(!0);this.setOutput(!0,"Array");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.ServoAttachBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("サーボ出力を任意のピンに割り当てます").appendField(new Blockly.FieldNumber("0",0,11,1),"CH");this.appendDummyInput().appendField("割り当てるピン番号").appendField(new Blockly.FieldDropdown([["Pin0","PIN0"],["Pin1","PIN1"],["Pin2","PIN2"]]),"PIN_NO").appendField("Min").appendField(new Blockly.FieldTextInput("default"),"MIN").appendField("Max").appendField(new Blockly.FieldTextInput("default"),"MAX");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.ServoAttachedBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ピンにサーボが割り当てられているかを確認する").appendField(new Blockly.FieldNumber("0",0,11,1),"CH");this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.ServoDetachBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("サーボの動作を止め、割り込みを禁止する").appendField(new Blockly.FieldNumber("0",0,11,1),"CH");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.ServoReadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("最後に設定された角度を読み出す").appendField(new Blockly.FieldNumber("0",0,11,1),"CH");this.setOutput(!0,"Number");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.ServoUsBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("サーボモータにus単位で角度を指定する").appendField(new Blockly.FieldNumber("0",0,11,1),"CH");this.appendValueInput("US").setCheck("Number").appendField("出力したいパルスの幅");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.ServoWriteBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("サーボの角度をセットします").appendField(new Blockly.FieldNumber("0",0,11,1),"CH");this.appendValueInput("ANGLE").setCheck("Number").appendField("角度");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SwitchCaseNumberBlock",{inherits:[WebMrbc.Block],caseCount_:0,defaultCount_:0,constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.setHelpUrl("http://www.example.com/");this.setColour(210);this.appendValueInput("SWITCH").setCheck("Number").appendField("右の数値が");this.appendDummyInput("CASE0").appendField("右の数値と").appendField(new Blockly.FieldNumber("0","-Infinity","Infinity",1),"CASE_VALUE0");this.appendStatementInput("DO0").appendField("同じなら");this.setPreviousStatement(!0);this.setNextStatement(!0);this.setMutator(new Blockly.Mutator(["switch_case_number_case","switch_case_number_default"]));this.setTooltip(Bridge.fn.bind(this,$_.WebMrbc.SwitchCaseNumberBlock.f1));this.caseCount_=0;this.defaultCount_=0},mutationToDom:function(){if(this.caseCount_===0&&this.defaultCount_===0)return null;var container=document.createElement("mutation");return this.caseCount_!==0&&container.setAttribute("case",this.caseCount_.toString()),this.defaultCount_!==0&&container.setAttribute("default","1"),container},domToMutation:function(xmlElement){this.caseCount_=parseInt(xmlElement.getAttribute("case"),10)||0;this.defaultCount_=parseInt(xmlElement.getAttribute("default"),10)||0;this.updateShape_()},decompose:function(workspace){var containerBlock=workspace.newBlock("switch_case_number_first_case"),connection,i,elseifBlock,elseBlock;for(containerBlock.initSvg(),connection=containerBlock.nextConnection,i=1;i<=this.caseCount_;i=i+1|0)elseifBlock=workspace.newBlock("switch_case_number_case"),elseifBlock.initSvg(),connection.connect(elseifBlock.previousConnection),connection=elseifBlock.nextConnection;return this.defaultCount_!==0&&(elseBlock=workspace.newBlock("switch_case_number_default"),elseBlock.initSvg(),connection.connect(elseBlock.previousConnection)),containerBlock},compose:function(containerBlock){var clauseBlock=containerBlock.nextConnection.targetBlock(),statementConnections,elseStatementConnection,i;for(this.caseCount_=0,this.defaultCount_=0,statementConnections=System.Array.init(0,null),elseStatementConnection=null;clauseBlock!=null;){switch(clauseBlock.type){case"switch_case_number_case":this.caseCount_=this.caseCount_+1|0;statementConnections.push(clauseBlock.statementConnection_);break;case"switch_case_number_default":this.defaultCount_=this.defaultCount_+1|0;elseStatementConnection=clauseBlock.statementConnection_;break;default:throw new System.Exception("Unknown block type.");}clauseBlock=clauseBlock.nextConnection!=null?clauseBlock.nextConnection.targetBlock():null}for(this.updateShape_(),i=1;i<=this.caseCount_;i=i+1|0)Blockly.Mutator.reconnect(statementConnections[i],this,"DO"+i);Blockly.Mutator.reconnect(elseStatementConnection,this,"DEFAULT")},saveConnections:function(containerBlock){for(var clauseBlock=containerBlock.nextConnection.targetBlock(),i=1,inputCase,inputDo,inputDo1;clauseBlock!=null;){switch(clauseBlock.type){case"switch_case_number_case":inputCase=this.getInput("CASE"+i);inputDo=this.getInput("DO"+i);clauseBlock.statementConnection_=inputDo!=null?inputDo.connection.targetConnection:null;i=i+1|0;break;case"switch_case_number_default":inputDo1=this.getInput("DEFAULT");clauseBlock.statementConnection_=inputDo1!=null?inputDo1.connection.targetConnection:null;break;default:throw new System.Exception("Unknown block type.");}clauseBlock=clauseBlock.nextConnection!=null?clauseBlock.nextConnection.targetBlock():null}},updateShape_:function(){this.getInput("DEFAULT")!=null&&this.removeInput("DEFAULT");for(var i=1;this.getInput("CASE"+i)!=null;)this.removeInput("CASE"+i),this.removeInput("DO"+i),i=i+1|0;for(i=1;i<=this.caseCount_;i=i+1|0)this.appendDummyInput("CASE"+i).appendField("右の数値と").appendField(new Blockly.FieldNumber(i.toString(),"-Infinity","Infinity",1),"CASE_VALUE"+i),this.appendStatementInput("DO"+i).appendField("同じなら");this.defaultCount_!==0&&this.appendStatementInput("DEFAULT").appendField("なければ")}});Bridge.ns("WebMrbc.SwitchCaseNumberBlock",$_);Bridge.apply($_.WebMrbc.SwitchCaseNumberBlock,{f1:function(){return this.caseCount_===0&&this.defaultCount_===0?"数値の等しいブロックを実行":this.caseCount_===0&&this.defaultCount_!==0?"数値の等しいブロックを実行、等しいものがなければ最後のブロックを実行":this.caseCount_!==0&&this.defaultCount_===0?"数値の等しいブロックを実行":this.caseCount_!==0&&this.defaultCount_!==0?"数値の等しいブロックを実行、等しいものがなければ最後のブロックを実行":""}});Bridge.define("WebMrbc.SwitchCaseTextBlock",{inherits:[WebMrbc.Block],caseCount_:0,defaultCount_:0,constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.setHelpUrl("http://www.example.com/");this.setColour(210);this.appendValueInput("SWITCH").setCheck("String").appendField("右の文字列が");this.appendDummyInput("CASE0").appendField("右の文字列と").appendField(new Blockly.FieldTextInput("0"),"CASE_VALUE0");this.appendStatementInput("DO0").appendField("同じなら");this.setPreviousStatement(!0);this.setNextStatement(!0);this.setMutator(new Blockly.Mutator(["switch_case_text_case","switch_case_text_default"]));this.setTooltip(Bridge.fn.bind(this,$_.WebMrbc.SwitchCaseTextBlock.f1));this.caseCount_=0;this.defaultCount_=0},mutationToDom:function(){if(this.caseCount_===0&&this.defaultCount_===0)return null;var container=document.createElement("mutation");return this.caseCount_!==0&&container.setAttribute("case",this.caseCount_.toString()),this.defaultCount_!==0&&container.setAttribute("default","1"),container},domToMutation:function(xmlElement){this.caseCount_=parseInt(xmlElement.getAttribute("case"),10)||0;this.defaultCount_=parseInt(xmlElement.getAttribute("default"),10)||0;this.updateShape_()},decompose:function(workspace){var containerBlock=workspace.newBlock("switch_case_text_first_case"),connection,i,elseifBlock,elseBlock;for(containerBlock.initSvg(),connection=containerBlock.nextConnection,i=1;i<=this.caseCount_;i=i+1|0)elseifBlock=workspace.newBlock("switch_case_text_case"),elseifBlock.initSvg(),connection.connect(elseifBlock.previousConnection),connection=elseifBlock.nextConnection;return this.defaultCount_!==0&&(elseBlock=workspace.newBlock("switch_case_text_default"),elseBlock.initSvg(),connection.connect(elseBlock.previousConnection)),containerBlock},compose:function(containerBlock){var clauseBlock=containerBlock.nextConnection.targetBlock(),statementConnections,elseStatementConnection,i;for(this.caseCount_=0,this.defaultCount_=0,statementConnections=System.Array.init(0,null),elseStatementConnection=null;clauseBlock!=null;){switch(clauseBlock.type){case"switch_case_text_case":this.caseCount_=this.caseCount_+1|0;statementConnections.push(clauseBlock.statementConnection_);break;case"switch_case_text_default":this.defaultCount_=this.defaultCount_+1|0;elseStatementConnection=clauseBlock.statementConnection_;break;default:throw new System.Exception("Unknown block type.");}clauseBlock=clauseBlock.nextConnection!=null?clauseBlock.nextConnection.targetBlock():null}for(this.updateShape_(),i=1;i<=this.caseCount_;i=i+1|0)Blockly.Mutator.reconnect(statementConnections[i],this,"DO"+i);Blockly.Mutator.reconnect(elseStatementConnection,this,"DEFAULT")},saveConnections:function(containerBlock){for(var clauseBlock=containerBlock.nextConnection.targetBlock(),i=1,inputCase,inputDo,inputDo1;clauseBlock!=null;){switch(clauseBlock.type){case"switch_case_text_case":inputCase=this.getInput("CASE"+i);inputDo=this.getInput("DO"+i);clauseBlock.statementConnection_=inputDo!=null?inputDo.connection.targetConnection:null;i=i+1|0;break;case"switch_case_text_default":inputDo1=this.getInput("DEFAULT");clauseBlock.statementConnection_=inputDo1!=null?inputDo1.connection.targetConnection:null;break;default:throw new System.Exception("Unknown block type.");}clauseBlock=clauseBlock.nextConnection!=null?clauseBlock.nextConnection.targetBlock():null}},updateShape_:function(){this.getInput("DEFAULT")!=null&&this.removeInput("DEFAULT");for(var i=1;this.getInput("CASE"+i)!=null;)this.removeInput("CASE"+i),this.removeInput("DO"+i),i=i+1|0;for(i=1;i<=this.caseCount_;i=i+1|0)this.appendDummyInput("CASE"+i).appendField("右の文字列と").appendField(new Blockly.FieldTextInput(i.toString()),"CASE_VALUE"+i),this.appendStatementInput("DO"+i).appendField("同じなら");this.defaultCount_!==0&&this.appendStatementInput("DEFAULT").appendField("なければ")}});Bridge.ns("WebMrbc.SwitchCaseTextBlock",$_);Bridge.apply($_.WebMrbc.SwitchCaseTextBlock,{f1:function(){return this.caseCount_===0&&this.defaultCount_===0?"文字列の等しいブロックを実行":this.caseCount_===0&&this.defaultCount_!==0?"文字列の等しいブロックを実行、等しいものがなければ最後のブロックを実行":this.caseCount_!==0&&this.defaultCount_===0?"文字列の等しいブロックを実行":this.caseCount_!==0&&this.defaultCount_!==0?"文字列の等しいブロックを実行、等しいものがなければ最後のブロックを実行":""}});Bridge.define("WebMrbc.SystemExitBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("終了させます");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemFileLoadBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("ファイルローダーを呼び出します");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemGetMrbPathBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("実行しているmrbファイルパスを取得します");this.setInputsInline(!0);this.setOutput(!0,"String");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemPopBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("フラッシュメモリから読み出します");this.appendValueInput("ADDRESS").setCheck("Number").appendField("開始アドレス");this.appendValueInput("LENGTH").setCheck("Number").appendField("サイズ");this.setInputsInline(!0);this.setOutput(!0,"String");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemPushBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("フラッシュメモリに書き込みます");this.appendValueInput("ADDRESS").setCheck("Number").appendField("開始アドレス");this.appendValueInput("DATA").setCheck("String").appendField("データ");this.appendValueInput("LENGTH").setCheck("Number").appendField("サイズ");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemResetBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("リセットします");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemSetRunBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("次に実行するスクリプトファイルをセットします");this.appendValueInput("FILENAME").setCheck("String");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemUseSdBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("SDカードを使えるようにします");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemUseWifiBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("WiFiモジュールESP8266ボードを使えるようにします");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.SystemVersionBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("システムのバージョンを取得します");this.setOutput(!0,"String");this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.ToneBlock",{inherits:[WebMrbc.Block],constructor:function(type){WebMrbc.Block.prototype.$constructor.call(this,type)},init:function(){this.appendDummyInput().appendField("トーン出力").appendField(new Blockly.FieldDropdown([["Pin1","PIN1"],["Pin2","PIN2"],["Pin3","PIN3"]]),"PIN_NO");this.appendValueInput("FREQUENCY").setCheck("Number").appendField("周波数");this.appendValueInput("DURATION").setCheck("Number").appendField("出力を維持する時間[ms]");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(160);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}});Bridge.define("WebMrbc.EcnlTaskWorkspace",{inherits:[WebMrbc.IClassWorkspace],identifer:null,workspace:null,constructor:function(identifer){this.identifer=identifer;this.workspace=new Blockly.Workspace},getIdentifer:function(){return this.identifer},getImageUrl:function(){return"img/no_image.png"},isPreset:function(){return!0},toCode:function(){return Blockly.Ruby.defineSvcTask(this,WebMrbc.Collections.LocalNode.getenode())},toDom:function(){return Blockly.Xml.workspaceToDom(this.workspace)},loadDom:function(xml){this.workspace.clear();Blockly.Xml.domToWorkspace(xml,this.workspace)},reloadToolbox:function(toolbox){var $t,$t1,echonet_category=$("#echonet_category",toolbox),name,block,field,name1,block1,field1;for(echonet_category.html(""),$t=Bridge.getEnumerator(["setup","recv_esv","break_wait","timeout","snd_msg"]);$t.moveNext();)name=$t.getCurrent(),block=$("<block>"),block.attr("type","procedures_defnoreturn"),field=$("<field>"),field.attr("name","NAME"),field.text(name),block.append(field),echonet_category.append(block);for($t1=Bridge.getEnumerator(["is_local_addr","is_multicast_addr","is_valid_addrid","get_local_addr","get_multicast_addr","get_remote_addr","get_remote_id","set_remote_addr","add_remote_addr"]);$t1.moveNext();)name1=$t1.getCurrent(),block1=$("<block>"),block1.attr("type","procedures_defreturn"),field1=$("<field>"),field1.attr("name","NAME"),field1.text(name1),block1.append(field1),echonet_category.append(block1)},openModifyView:function(){},template:function(template){return template=System.String.replaceAll(template,"%identifer%",this.identifer),template=System.String.replaceAll(template,"%attribute%","SvcTask"),System.String.replaceAll(template,"%img%",this.getImageUrl())}});Bridge.define("WebMrbc.EObjectWorkspace",{inherits:[WebMrbc.IClassWorkspace],eobject:null,workspace:null,callback:null,constructor:function(eobject){this.eobject=eobject;this.workspace=new Blockly.Workspace},getIdentifer:function(){return this.eobject.identifer},getImageUrl:function(){return"img/no_image.png"},isPreset:function(){return!1},toCode:function(){return Blockly.Ruby.defineEObject(this.eobject,this.workspace)},toDom:function(){return Blockly.Xml.workspaceToDom(this.workspace)},loadDom:function(xml){this.workspace.clear();Blockly.Xml.domToWorkspace(xml,this.workspace)},reloadToolbox:function(toolbox){var $t,echonet_category=$("#echonet_category",toolbox),pi,block,field;for(echonet_category.html(""),$t=Bridge.getEnumerator(this.eobject.properties);$t.moveNext();)(pi=$t.getCurrent(),WebMrbc.CodeGenerator.isExtractProperty(pi))||(block=$("<block>"),block.attr("type","eproperty_new"),field=$("<field>"),field.attr("name","IDENTIFER"),field.text(WebMrbc.CodeGenerator.getPropertyIdentifier(pi)),block.append(field),field=$("<field>"),field.attr("name","DESCRIPTION"),field.text(pi.description),block.append(field),field=$("<field>"),field.attr("name","PROPERTY_CODE"),field.text(System.Byte.format(pi.propertyCode,"X2")),block.append(field),field=$("<field>"),field.attr("name","PROPERTY_SIZE"),field.text(pi.size.toString()),block.append(field),echonet_category.append(block))},openModifyView:function(callback){Bridge.staticEquals(this.callback,null)&&(this.callback=callback,WebMrbc.Views.EObjectModalView.setEObject(this.eobject,this.getImageUrl()),WebMrbc.Views.EObjectModalView.addClosed(Bridge.fn.bind(this,this.eObjectModalView_Closed)),WebMrbc.Views.EObjectModalView.render())},eObjectModalView_Closed:function(view,ok){view.removeClosed(Bridge.fn.bind(this,this.eObjectModalView_Closed));WebMrbc.App.reloadToolbox();Bridge.staticEquals(this.callback,null)||this.callback(ok);this.callback=null},template:function(template){return template=System.String.replaceAll(template,"%identifer%",this.eobject.identifer),template=System.String.replaceAll(template,"%attribute%","EOBJ: "+System.Byte.format(this.eobject.type.classGroup.classGroupCode,"X2")+System.Byte.format(this.eobject.type.classCode,"X2")+System.Byte.format(this.eobject.instanceCode,"X2")+"<br>区分: "+this.eobject.attribute),System.String.replaceAll(template,"%img%",this.getImageUrl())}});Bridge.define("WebMrbc.MainLoopWorkspace",{inherits:[WebMrbc.IClassWorkspace],identifer:null,workspace:null,constructor:function(identifer){this.identifer=identifer;this.workspace=new Blockly.Workspace},getIdentifer:function(){return this.identifer},getImageUrl:function(){return"img/no_image.png"},isPreset:function(){return!0},toCode:function(){return Blockly.Ruby.defineMainLoop(this,WebMrbc.Collections.LocalNode.getenode())},toDom:function(){return Blockly.Xml.workspaceToDom(this.workspace)},loadDom:function(xml){this.workspace.clear();Blockly.Xml.domToWorkspace(xml,this.workspace)},reloadToolbox:function(toolbox){var echonet_category=$("#echonet_category",toolbox);echonet_category.html("")},openModifyView:function(){},template:function(template){return template=System.String.replaceAll(template,"%identifer%",this.identifer),template=System.String.replaceAll(template,"%attribute%","MainLoop"),System.String.replaceAll(template,"%img%",this.getImageUrl())}});Bridge.define("WebMrbc.SwitchCaseNumberCaseBlock",{inherits:[WebMrbc.SwitchCaseNumberBlock],constructor:function(type){WebMrbc.SwitchCaseNumberBlock.prototype.$constructor.call(this,type)},init:function(){this.setColour(210);this.appendDummyInput().appendField("case");this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip("switch");this.contextMenu=!1}});Bridge.define("WebMrbc.SwitchCaseNumberDefaultBlock",{inherits:[WebMrbc.SwitchCaseNumberBlock],constructor:function(type){WebMrbc.SwitchCaseNumberBlock.prototype.$constructor.call(this,type)},init:function(){this.setColour(210);this.appendDummyInput().appendField("default");this.setPreviousStatement(!0);this.setTooltip("");this.contextMenu=!1}});Bridge.define("WebMrbc.SwitchCaseNumberFirstCaseBlock",{inherits:[WebMrbc.SwitchCaseNumberBlock],constructor:function(type){WebMrbc.SwitchCaseNumberBlock.prototype.$constructor.call(this,type)},init:function(){this.setColour(210);this.appendDummyInput().appendField("case");this.setNextStatement(!0);this.setTooltip("case when");this.contextMenu=!1}});Bridge.define("WebMrbc.SwitchCaseTextCaseBlock",{inherits:[WebMrbc.SwitchCaseTextBlock],constructor:function(type){WebMrbc.SwitchCaseTextBlock.prototype.$constructor.call(this,type)},init:function(){this.setColour(210);this.appendDummyInput().appendField("case");this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip("switch");this.contextMenu=!1}});Bridge.define("WebMrbc.SwitchCaseTextDefaultBlock",{inherits:[WebMrbc.SwitchCaseTextBlock],constructor:function(type){WebMrbc.SwitchCaseTextBlock.prototype.$constructor.call(this,type)},init:function(){this.setColour(210);this.appendDummyInput().appendField("default");this.setPreviousStatement(!0);this.setTooltip("");this.contextMenu=!1}});Bridge.define("WebMrbc.SwitchCaseTextFirstCaseBlock",{inherits:[WebMrbc.SwitchCaseTextBlock],constructor:function(type){WebMrbc.SwitchCaseTextBlock.prototype.$constructor.call(this,type)},init:function(){this.setColour(210);this.appendDummyInput().appendField("case");this.setNextStatement(!0);this.setTooltip("case when");this.contextMenu=!1}});Bridge.define("WebMrbc.ENodeWorkspace",{inherits:[WebMrbc.EObjectWorkspace],constructor:function(enode){WebMrbc.EObjectWorkspace.prototype.$constructor.call(this,enode)},getenode:function(){return Bridge.cast(this.eobject,WebMrbc.JsonNodeInfo)},getImageUrl:function(){return"img/no_image.png"},isPreset:function(){return!0},toCode:function(){return Blockly.Ruby.defineENode(Bridge.cast(this.eobject,WebMrbc.JsonNodeInfo),this.workspace)}});Bridge.init()})(this);